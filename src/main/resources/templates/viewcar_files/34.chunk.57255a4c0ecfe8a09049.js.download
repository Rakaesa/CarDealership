(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{"./engagement-handlers/calculator-engagement-handler/calculator-engagement-handler.js":function(e,t,a){"use strict";var s=a("../node_modules/@babel/runtime/helpers/esm/objectSpread.js"),i=a("../node_modules/lodash/get.js"),n=a.n(i),r=a("./utils/event-toolbox.js"),l=a("./tracking/constant.js"),o=a("./site-modules/shared/constants/calculator/calculator.js"),c=a("../node_modules/lodash/isNumber.js"),d=a.n(c),p=a("./site-modules/shared/utils/calculator/calculator-helper.js");function m(e){let t=e.payments,a=e.limitCriteria,s=e.inventory,i=e.type;const r=n()(s,"computedDisplayInfo.transparentPricingCompliance.bestDealPrice"),l=n()(s,"dealerInfo.address.zip"),c=n()(s,"prices",{}),m=c.tmv,u=c.displayPrice,h=c.partnerInvoicePrice,g=t.tradeIn,b=t.downPayment,f=t.fees,E=t.taxes,v=t.expDate,y=t.endDate,C=t.creditScore,S=t.term,T=t.numberOfMonths,I=t.totalTaxesAndFees,N=t.annualMileage,_=t.primaryIncentiveAmount,O=t.conditionalIncentiveAmount,P=t.financeRate,A=t.apr,V=t.monthly,x=t.monthlyWithTaxes,k=t.moneyFactor,w=t.residualPercentage,R=t.residual,M=t.dueAtSigning,j=t.totalLeaseCost,D=t.docFee,L=i===o.h,F=n()(f,"docFee")||D,U=n()(f,"combinedFees"),q=n()(E,"combinedSalesTax"),z=I||U+q||0,B=S||T,$=P||A,Y=w||R,H=v||y,Z=L?void 0:j||x*(S-1)+M,G=function(e){let t=e.limitCriteria,a=e.tradeIn,s=e.downPayment;const i=Object(p.d)({limitCriteria:t},"TRADE_IN"),n=Object(p.d)({limitCriteria:t},"DOWN_PAYMENT");return{appliedDownPayment:d()(n)?n:s,appliedTradeIn:d()(i)?i:a}}({limitCriteria:a,tradeIn:g,downPayment:b}),W=G.appliedTradeIn;return{pmt_msrp:u,pmt_tmv:m,pmt_dealer_price:h,pmt_esp:r,pmt_doc_fee:F,pmt_dealer_zip_code:l,pmt_type:i,pmt_credit_score:C,pmt_term:B,pmt_annual_mileage:L?void 0:N,pmt_down_payment:b,pmt_applied_down_payment:G.appliedDownPayment,pmt_tradein:g,pmt_applied_tradein:W,pmt_conditional_incentives:O,pmt_primary_incentives:_,pmt_finance_rate:$,pmt_apply_limits:!0,pmt_with_concrete_taxes_and_fees:!0,pmt_base_monthly_payment:V,pmt_monthly_payment_with_taxes_and_fees:x,pmt_total_taxes_and_fees:z,pmt_total_taxes:q,pmt_total_fees:U,pmt_money_factor:k,pmt_residual_value:Y&&u?Y*u:void 0,pmt_residual_percentage:Y,pmt_total_due_at_signing:M,pmt_total_cost_to_lessee:Z,pmt_expiration_date:H}}var u=a("./site-modules/shared/constants/calculator/events.js");function h(e){let t=e.detail;const a=t.value,s=t.calculatorType,i=t.field;r.a.fireTrackAction({event_type:"action_completed",event_data:{action_cause:"button_click",action_category:l.b.SYSTEM_ACTION_CATEGORY,action_name:l.b.ACTION_SHOW_CONTENT,creative_id:`edm-entry-${s}-payment-calculator`,subaction_name:l.b[`SHOW_${i}_LIMIT_ERROR`],value:a}})}a.d(t,"a",function(){return g});const g={init:e=>{let t=e.getState;r.a.on(u.a.CALCULATE_PAYMENT,e=>(function(e,t){let a=e.detail;const i=a.vin,c=a.type,d=a.creativeId,p=a.payments,u=a.limitCriteria,h=t(),g=n()(h,`inventory.vin.${i}`);r.a.fireTrackAction({event_type:"action_completed",event_data:Object(s.a)({action_name:l.b.CALCULATE_PAYMENT,subaction_name:c===o.h?l.b.EDIT_LOAN_PAYMENT:l.b.EDIT_LEASE_PAYMENT,action_category:l.b.SYSTEM_ACTION_CATEGORY,creative_id:d},m({payments:p,limitCriteria:u,inventory:g,type:c}))})})(e,t)),r.a.on(u.a.TRIGGER_LIMIT,h)}}},"./engagement-handlers/carousel-engagement-handler/carousel-engagement-handler.js":function(e,t,a){"use strict";a.d(t,"a",function(){return g});var s=a("../node_modules/@babel/runtime/helpers/esm/objectSpread.js"),i=a("../node_modules/lodash/get.js"),n=a.n(i),r=a("../node_modules/lodash/debounce.js"),l=a.n(r),o=a("../node_modules/@edmunds/react-dfp/lib/index.js"),c=a("./utils/event-toolbox.js"),d=a("./site-modules/shared/components/carousel/events.js"),p=a("./engagement-handlers/helper.js"),m=a("./actions/ads-refresh.js"),u=a("./site-modules/shared/components/ad-unit/utils/refresh-rules.js");const h="carousel";const g={init(e){let t=e.getState;c.a.on(d.a.SWIPE,function(e){const t=e.detail,a=t.target,i=t.data,n=void 0===i?{}:i,r=n.currentSlide,l=n.nextSlide,o=n.total,d=n.contentType,m=n.contentDetails,u=n.customEventData,h=void 0===u?{}:u,g=n.photoType,b=n.actionCause,f=a,E=f.querySelector(`.slick-slide[data-index="${l}"]`),v=E.querySelector("[data-carousel-tracking-value]"),y=E&&(v?v.innerText.toLowerCase():E.innerText.toLowerCase()),C=Object(p.c)(f),S=Object(s.a)({carousel_index:l+1,carousel_prev_index:r+1,carousel_total:o,value:y,creative_id:C,action_category:"user",action_name:`view_${d}`,subaction_name:`view_${m}`,action_cause:b||"swipe",photo_type:g},h);c.a.fireTrackAction({event_type:"action_completed",event_data:S})}),c.a.on(d.a.SWIPE,function(e,t){return l()(e=>{if(n()(e,"detail.data.noAdsRefresh")||!u.a.refreshOn.carousel.size||!Object(m.a)(h,t))return;const a=Array.from(u.a.refreshOn.carousel);o.DFPManager.refresh(...a)},e)}(500,t))}}},"./images/inline-svgs/edmunds-logo.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return n}),a.d(t,"b",function(){return r});var s=a("../node_modules/react/index.js"),i=a.n(s);const n=()=>i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 117 78",width:117},i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",fill:"#007EE5",d:"M62.2 59.5c-1.3 0.2-2.5 0.4-3.7 0.4 -1.2 0-2.5-0.2-3.7-0.4 -9-1.7-16-7.9-19-16 4.4 4.9 13 7.4 22.8 7.5 9.8-0.1 18.4-2.6 22.8-7.5C78.2 51.6 71.2 57.8 62.2 59.5L62.2 59.5zM28.2 17.5v5.7c0 0.6 0.2 1.2 0.6 1.8 -3.4 0.3-6.7 0.8-9.8 1.4 1.6-4.2 5.1-10.8 9.2-15 0.7-0.7 3.6-3.2 7.8-3.9C38.1 7.1 45.5 6 57 6h1.6 1.6c11.5 0 18.9 1.1 21 1.4 4.2 0.7 7.1 3.2 7.8 3.9 4.1 4.2 7.6 10.9 9.2 15 -6.5-1.4-14-1.9-22-2.1 -0.9 0-3.3-0.1-5.5-0.1h-2.2c-1.7 0-3.3 0-5 0h-4.9 -4.9c-1.7 0-3.4 0-5 0h-1.4c0.1-0.3 0.2-0.6 0.2-1v-5.7c0-1.9-2-3.5-4.4-3.5H32.6C30.2 14 28.2 15.5 28.2 17.5L28.2 17.5zM93.6 54.2c-3.4-0.3-6.1-3-6.4-6.4 -0.5-4.5 3.4-8.3 7.9-7.8 3.4 0.3 6.1 3 6.4 6.4C102 50.9 98.2 54.6 93.6 54.2L93.6 54.2zM22 54.2c-3.4-0.3-6.1-3-6.4-6.4 -0.5-4.5 3.4-8.3 7.9-7.8 3.4 0.3 6.1 3 6.4 6.4C30.4 50.9 26.6 54.6 22 54.2L22 54.2zM116.9 22.2c0-1.7-1.5-2.9-3.2-2.9l-6.7 0.2c-1.5 0-2.7 1.2-2.9 2.6 0 0.3-0.1 0.7-0.2 1l-0.8-1.5c-2.7-5-6.5-11-10.2-14.8h0c0 0-3.3-4-9.9-5.3 0 0 0 0 0 0C77.2 0.3 67.8-0.1 58.6 0 49.4-0.1 40 0.3 34.2 1.5c0 0 0 0 0 0 -6.6 1.3-9.9 5.3-9.9 5.3h0c-3.8 3.8-7.5 9.8-10.2 14.8l-0.8 1.7c-0.1-0.4-0.2-0.8-0.3-1.2 -0.2-1.4-1.4-2.6-2.9-2.6l-6.7-0.2c-1.7 0-3.1 1.2-3.2 2.9L0 25.5c0 1.7 1.3 3.1 2.9 3.1l7.1 0.8 0.1-0.1c-0.1 0.1-0.1 0.2-0.1 0.3 -2.4 2.7-3.8 5.8-4.2 8.3C5 40.5 4.6 43.8 4.6 48.1c0 6.1 1.7 14.4 2.1 18.4v6c0 3 2.5 5.4 5.5 5.4h7.5c3 0 5.5-2.4 5.5-5.4v-4.5c7.8-0.7 20.6-1 33.4-1 12.8 0 25.6 0.3 33.4 1v4.5c0 3 2.5 5.4 5.5 5.4h7.5c3 0 5.5-2.4 5.5-5.4v-6c0.4-4 2.1-12.4 2.1-18.4 0-9.4-3.5-16.1-5.4-18.5 0-0.1-0.1-0.1-0.1-0.2l7-0.8c1.7 0 3-1.5 2.9-3.1L116.9 22.2zM84.5 10h-11C71 10 69 11.7 69 13.7v6.1c0 0.4 0 0.8 0.2 1.2 2.3-2.8 5.9-4.7 9.8-4.7 2.9 0 7.5 1.8 9.8 4.6 0.1-0.3 0.2-0.7 0.2-1.1v-6.1C89 11.7 87 10 84.5 10"})),r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 63 78",width:63,className:e},i.a.createElement("path",{fill:"#007EE5",d:"M62.8 59.4c-0.2 0-0.4 0.1-0.6 0.1 -1.3 0.2-2.5 0.4-3.7 0.4s-2.5-0.2-3.7-0.4c-9-1.7-16-7.9-19-16 4.4 4.9 13 7.4 22.8 7.5 1.4 0 2.9-0.1 4.2-0.2V24.1h-4.2 -4.9c-1.7 0-3.4 0-5 0h-1.4c0.1-0.3 0.2-0.6 0.2-1v-5.7c0-1.9-2-3.5-4.4-3.5H32.6c-2.4 0.1-4.4 1.6-4.4 3.6v5.7c0 0.6 0.2 1.2 0.6 1.8 -3.4 0.3-6.7 0.8-9.8 1.4 1.6-4.2 5.1-10.8 9.2-15 0.7-0.7 3.6-3.2 7.8-3.9C38.1 7.1 45.5 6 57 6h1.6 1.6c0.9 0 1.8 0 2.6 0V0c-1.4 0-2.8 0-4.2 0C49.4-0.1 40 0.3 34.2 1.5c-6.6 1.3-9.9 5.3-9.9 5.3 -3.8 3.8-7.5 9.8-10.2 14.8l-0.8 1.7c-0.1-0.4-0.2-0.8-0.3-1.2 -0.2-1.4-1.4-2.6-2.9-2.6l-6.7-0.2c-1.7 0-3.1 1.2-3.2 2.9L0 25.5c0 1.7 1.3 3.1 2.9 3.1l7.1 0.8 0.1-0.1C10 29.4 10 29.5 10 29.6c-2.4 2.7-3.8 5.8-4.2 8.3C5 40.5 4.6 43.8 4.6 48.1c0 6.1 1.7 14.4 2.1 18.4v6c0 3 2.5 5.4 5.5 5.4h7.5c3 0 5.5-2.4 5.5-5.4V68c7.8-0.7 20.6-1 33.4-1 1.4 0 2.8 0 4.2 0V59.4zM22 54.2c-3.4-0.3-6.1-3-6.4-6.4 -0.5-4.5 3.4-8.3 7.9-7.8 3.4 0.3 6.1 3 6.4 6.4C30.4 50.9 26.6 54.6 22 54.2z"}))}},"./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser-async.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return i});var s=a("./site-modules/shared/components/lazy-load/lazy-load.jsx");const i=Object(s.a)({loader:()=>Promise.all([a.e(4),a.e(5),a.e(17),a.e(18),a.e(22),a.e(6),a.e(13),a.e(24),a.e(26),a.e("trade-in-appraiser")]).then(a.bind(null,"./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser.jsx")),componentName:"TradeInAppraiser"})},"./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser-drawer.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return u});var s=a("../node_modules/react/index.js"),i=a.n(s),n=a("../node_modules/prop-types/index.js"),r=a.n(n),l=a("../node_modules/reactstrap/lib/Container.js"),o=a.n(l),c=a("./site-modules/shared/components/drawer/drawer.jsx"),d=a("./site-modules/shared/components/drawer/drawer-close-button/drawer-close-button.jsx"),p=a("./data/models/dealer-info.js"),m=a("./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser-async.jsx");class u extends s.Component{constructor(){super(...arguments),this.state={isDrawerComponentLoaded:!1}}static getDerivedStateFromProps(e,t){return e.isOpen&&!t.isDrawerComponentLoaded?{isDrawerComponentLoaded:!0}:null}render(){const e=this.props,t=e.isOpen,a=e.onToggle,s=e.onTradeInUpdate,n=e.onVehicleUpdate,r=e.trackingParent,l=e.sellYourCarConfig,p=e.anonymousSignInCreativeId,u=e.drawerClassNames,h=e.isPurchase,g=e.sellingPrice,b=e.msrp,f=e.residualValue,E=e.isUsed,v=e.dataTest,y=this.state.isDrawerComponentLoaded;return i.a.createElement(c.a,{side:"right","data-tracking-parent":r,classNames:{drawerContent:"px-0_5",drawer:u},toggle:a,isOpen:t,"data-test":v},i.a.createElement(d.a,{onClick:a,className:"mb-0 mb-md-2_5 d-block px-md-2 px-lg-3_5 text-right text-md-left",lgBtnClass:"pl-0",smBtnClass:"d-inline-block",trackingId:"close_report",trackingValue:"x upper right"}),y&&i.a.createElement(o.a,{className:"mx-0 px-0"},i.a.createElement(m.a,{onDone:a,onTradeInUpdate:s,onVehicleUpdate:n,className:"px-1 px-md-2 px-lg-3_5",sellYourCarConfig:l,anonymousSignInCreativeId:p,isPurchase:h,sellingPrice:g,msrp:b,residualValue:f,isUsed:E,drawerCreativeId:r})))}}u.propTypes={isOpen:r.a.bool.isRequired,onToggle:r.a.func.isRequired,onTradeInUpdate:r.a.func,onVehicleUpdate:r.a.func,trackingParent:r.a.string.isRequired,anonymousSignInCreativeId:r.a.string,sellYourCarConfig:p.e,drawerClassNames:r.a.string,isPurchase:r.a.bool,sellingPrice:r.a.number,msrp:r.a.number,residualValue:r.a.number,isUsed:r.a.bool,dataTest:r.a.string},u.defaultProps={onTradeInUpdate:null,onVehicleUpdate:null,sellYourCarConfig:{},anonymousSignInCreativeId:void 0,drawerClassNames:null,isPurchase:!1,sellingPrice:0,msrp:0,residualValue:0,isUsed:!1,dataTest:""}},"./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser.jsx":function(e,t,a){"use strict";a.r(t);var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=(a("../node_modules/core-js/modules/es6.regexp.split.js"),a("../node_modules/core-js/modules/es6.regexp.to-string.js"),a("../node_modules/@babel/runtime/helpers/esm/objectSpread.js")),n=a("../node_modules/lodash/pickBy.js"),r=a.n(n),l=a("../node_modules/lodash/isNil.js"),o=a.n(l),c=a("../node_modules/lodash/uniq.js"),d=a.n(c),p=a("../node_modules/lodash/isEqual.js"),m=a.n(p),u=a("../node_modules/lodash/isNull.js"),h=a.n(u),g=a("../node_modules/lodash/noop.js"),b=a.n(g),f=a("../node_modules/lodash/has.js"),E=a.n(f),v=a("../node_modules/lodash/isEmpty.js"),y=a.n(v),C=a("../node_modules/lodash/get.js"),S=a.n(C),T=a("../node_modules/lodash/debounce.js"),I=a.n(T),N=a("../node_modules/lodash/includes.js"),_=a.n(N),O=a("../node_modules/lodash/findIndex.js"),P=a.n(O),A=a("../node_modules/react/index.js"),V=a.n(A),x=a("../node_modules/prop-types/index.js"),k=a.n(x),w=a("../node_modules/uuid/v4.js"),R=a.n(w),M=a("../node_modules/uuid/v5.js"),j=a.n(M),D=a("../node_modules/reactstrap/lib/Row.js"),L=a.n(D),F=a("../node_modules/reactstrap/lib/Col.js"),U=a.n(F),q=a("../node_modules/react-redux/es/index.js"),z=a("./utils/isomorphic-logger.js"),B=a("./data/luckdragon/redux/react-binding.jsx"),$=a("./data/models/visitor.js"),Y=a("./site-modules/shared/components/profile/insider-methods.jsx"),H=a("./utils/experiment/experiment-util.js"),Z=a("./site-modules/shared/constants/appraisal/appraisal.js"),G=a("./site-modules/shared/constants/car-buying/index.js"),W=a("./site-modules/shared/utils/storage.js"),Q=a("./configuration.js"),K=a("./site-modules/shared/constants/calculator/calculator.js"),X=a("./tracking/constant.js"),J=a("./utils/event-toolbox.js"),ee=a("./data/models/vehicle.js"),te=a("./data/models/vehicle-vin.js"),ae=a("./site-modules/shared/components/profile/profile-screen.js"),se=a("./engagement-handlers/profile-engagement-handler/profile-engagement-handler.js"),ie=a("./actions/profile.js"),ne=a("./data/utils/marketo-service.js"),re=a("./data/models/dealer-info.js"),le=a("./site-modules/shared/utils/appraiser/appraiser-validation-helper.js"),oe=a("../node_modules/lodash/isEqualWith.js"),ce=a.n(oe);const de=(e,t)=>{if(e&&t&&e.id&&t.id)return m()(e.id,t.id)};function pe(e,t){return ce()(e,t,de)}const me={300:{v1Key:"exterior--paint-body-work",v1ValueByV2AnswerId:{1:"0",2:"1",3:"2",4:"3"}},410:{v1Key:"interior--broken-parts",v1ValueByV2AnswerId:{1:"0",2:"1",3:"2",4:"3"}},420:{v1Key:"interior--fabric-issues",v1ValueByV2AnswerId:{1:"0",2:"1",3:"2",4:"3"}},500:{v1Key:"tires",v1ValueByV2AnswerId:{1:"0",2:"2",3:"4"}},600:{v1Key:"keys",v1ValueByV2AnswerId:{1:"2",2:"1"}},1000:{v1Key:"mechanical--odometer-untrusted",v1ValueByV2AnswerId:{1:"false",2:"true"}},110:{v1Key:"accidents--minor",v1ValueByV2AnswerId:{1:"0",2:"1",3:"2"}},120:{v1Key:"accidents--major",v1ValueByV2AnswerId:{1:"0",2:"1",3:"2"}},210:{v1Key:"mechanical--inoperable",v1ValueByV2AnswerId:{1:"false",2:"true"}},220:{v1Key:"mechanical--engine",v1ValueByV2AnswerId:{1:"false",2:"true"}},230:{v1Key:"mechanical--transmission",v1ValueByV2AnswerId:{1:"false",2:"true"}},710:{v1Key:"after-market--suspension",v1ValueByV2AnswerId:{1:"false",2:"true"}},720:{v1Key:"after-market--engine",v1ValueByV2AnswerId:{1:"false",2:"true"}},810:{v1Key:"other--convertible-top",v1ValueByV2AnswerId:{1:"false",2:"true"}},820:{v1Key:"other--air-conditioning",v1ValueByV2AnswerId:{1:"false",2:"true"}},830:{v1Key:"other--odor",v1ValueByV2AnswerId:{1:"false",2:"true"}},840:{v1Key:"other--missing-standard-equipment",v1ValueByV2AnswerId:{1:"false",2:"true"}},910:{v1Key:"frame-damage",v1ValueByV2AnswerId:{1:"false",2:"true"}},920:{v1Key:"flood-damage",v1ValueByV2AnswerId:{1:"false",2:"true"}},240:[{v1Key:"mechanical--check-engine-light",v1ValueByV2AnswerId:{1:"true"}},{v1Key:"mechanical--4x4-service",v1ValueByV2AnswerId:{2:"true"}},{v1Key:"mechanical--check-brakes-light",v1ValueByV2AnswerId:{3:"true"}},{v1Key:"mechanical--other-warning-light",v1ValueByV2AnswerId:{4:"true"}}],251:[{v1Key:"mechanical--brakes",v1ValueByV2AnswerId:{1:"true"}},{v1Key:"mechanical--steering",v1ValueByV2AnswerId:{2:"true"}},{v1Key:"mechanical--suspension",v1ValueByV2AnswerId:{3:"true"}},{v1Key:"mechanical--other",v1ValueByV2AnswerId:{4:"true"}}]};var ue=a("./site-modules/shared/components/profile/attributes/financing.js"),he=a("./tracking/handler.js"),ge=a("./engagement-handlers/helper.js"),be=a("./utils/location.js"),fe=a("./utils/session-recorder/session-recorder.js"),Ee=a("./site-modules/shared/utils/location.js"),ve=a("../node_modules/lodash/set.js"),ye=a.n(ve);const Ce=e=>{const t={};return Object.keys(e).forEach(a=>{t[a.toLowerCase()]=S()(e,`${a}.Current.totalWithOptions.usedTradeIn`)}),t},Se=e=>{const t=e||{},a=t.usedTradeIn,s=t.usedPrivateParty,i=t.usedTmvRetail;return a||s||i?{[Z.kb]:a,[Z.Z]:s,[Z.s]:i}:{}},Te=(e,t,a)=>{const s=e.toUpperCase(),i=S()(t,`${s}.Current.nationalBasePrice`),n=S()(t,`${s}.Current.regionalAdjustment`),r=S()(t,`${s}.Current.totalWithOptions`),l=S()(t,`${s}.Current.mileageAdjustment`),o=S()(t,`${s}.Current.colorAdjustment`),c=S()(t,`${s}.Current.optionTMVPrices`,{}),d=S()(t,`${s}.Current.conditionAdjustment`),p=S()(t,`${s}.Current.certifiedUsedPrice`);return{nationalPrices:Se(i),regionalPrices:Se(n),totalPrices:Se(r),mileagePrices:Se(l),colorPrices:Se(o),optionalPrices:Se((e=>Z.Y.reduce((t,a)=>{const s=e.reduce((e,t)=>e+S()(t,`${a}`,0),0);return ye()(t,a,s)},{}))(Object.values(c))),optionalPricesValues:a&&a.map(e=>{let t=e.id;return{id:t,name:e.name,price:Se(c[t])}}),conditionPrices:Se(d),conditionPricing:Ce(t),certifiedUsedPrice:Se(p)}},Ie=(e,t)=>{const a={};return Object.keys(e).forEach(s=>{a[s.toLowerCase()]=Te(s,e,t)}),a},Ne=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t={};return Object.keys(e).forEach(a=>{t[a]=e[a]&&e[a].totalPrices}),t};var _e=a("./site-modules/shared/components/profile/smart-sign/constants.js"),Oe=a("./site-modules/shared/components/experiment/index.jsx"),Pe=a("./utils/bootstrap.js"),Ae=a("./site-modules/shared/components/rating-stars/rating-stars.jsx"),Ve=a("./site-modules/shared/components/carousel/carousel.jsx"),xe=a("./data/models/cms.js"),ke=a("./data/cms/content.js"),we=a("../node_modules/classnames/index.js"),Re=a.n(we);a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-step-user-testimonials.scss");const Me=[{breakpoint:Pe.a.sm,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:Pe.a.lg,settings:{slidesToShow:3,slidesToScroll:3}}],je={slidesToShow:1},De={slidesToShow:3,slidesToScroll:3};class Le extends A.PureComponent{constructor(){super(...arguments),this.state={inViewPort:!1},this.isInViewport=(e=>{if(!e)return!1;const t=e.getBoundingClientRect();return t.top>=0&&t.top<=e.clientHeight}),this.fireWidgetView=(()=>{const e=this.isInViewport(document.querySelector(".appraisal-report-step-user-testimonials"));e&&!this.state.inViewPort&&J.a.fireTrackAction({event_type:X.b.ACTION_WIDGET_VIEW,event_data:{action_cause:X.b.ACTION_CAUSE_SCROLL,creative_id:"edm-entry-epo-testimonials"}}),this.setState({inViewPort:e})}),this.createUserTestimonialCard=(e=>{let t=e.testimonialTitle,a=e.testimonialText,s=e.starRating,i=e.date,n=e.name,r=e.location,l=e.verifiedSeller;return V.a.createElement("div",{className:"user-testimonial-card rounded d-flex flex-column justify-content-between text-gray-darker size-14 p-1"},V.a.createElement("div",null,V.a.createElement("div",{className:"testimonial-header heading-5 mb-0_5"},t),V.a.createElement(Ae.a,{starClass:"text-primary-darker mr-0_25",rating:parseFloat(s)}),V.a.createElement("span",{className:"heading-6 ml-1_5"},parseFloat(s).toFixed(1)),V.a.createElement("div",{className:"mt-0_5 mb-0_75"},a)),V.a.createElement("div",{className:"user-info size-12"},V.a.createElement("span",null,n),l&&V.a.createElement("span",{className:"font-italic ml-0_5"},"Verified Seller"),V.a.createElement("div",null,r),V.a.createElement("div",{className:"testimonial-date"},i)))})}componentDidMount(){J.a.on("scroll",this.fireWidgetView,!0)}componentWillUnmount(){J.a.off("scroll",this.fireWidgetView,!0)}testimonialSlides(e){return e.map(e=>V.a.createElement("div",{className:"p-1 h-100",key:e.testimonialTitle},this.createUserTestimonialCard(e)))}render(){const e=this.props,t=e.isMobile,a=e.testimonials,i=e.className,n=t?je:De,r=a.children().map(e=>e.getAllMetadata());return r.length?V.a.createElement("div",{"data-tracking-parent":"edm-entry-epo-testimonials",className:Re()("appraisal-report-step-user-testimonials",i)},V.a.createElement("div",{className:"heading-3 mb-0_75"},"What Our Customers Are Saying"),V.a.createElement("div",{className:"size-14 text-gray-darker mb-0_75"},"Join thousands of happy customers who redeemed a CarMax offer last month."),V.a.createElement("div",{className:"d-flex justify-content-center"},V.a.createElement("div",{className:"testimonial-carousel-container"},V.a.createElement(Ve.a,Object(s.a)({swipe:t,arrows:!t,infinite:!1,responsive:Me,dots:!0,dotsClass:"slick-dots gray",speed:500,cssEase:"ease-in-out",className:"testimonial-carousel",customEventData:{subaction_name:"view_testimonial",action_cause:"link_click",value:""}},n),this.testimonialSlides(r))))):null}}Le.propTypes={isMobile:k.a.bool,testimonials:xe.a.Content,className:k.a.string},Le.defaultProps={isMobile:!1,testimonials:ke.a,className:""};const Fe={testimonials:Object(xe.d)("editorial/includes/carmax/testimonials","testimonials")},Ue=Object(B.b)(Le,Fe);var qe=a("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),ze=a("../node_modules/lodash/startCase.js"),Be=a.n(ze),$e=a("../node_modules/dateformat/lib/dateformat.js"),Ye=a.n($e),He=a("./utils/image-helpers.js"),Ze=a("./site-modules/shared/utils/vehicle-link-constructor.js"),Ge=a("./site-modules/shared/utils/price-utils.js"),We=a("./site-modules/shared/utils/string.js"),Qe=a("./utils/environment.js"),Ke=a("./site-modules/shared/components/form-validation/validation-async.js"),Xe=a("./site-modules/shared/components/form-validation/validation.js");function Je(e){const t=new Date;return e&&t.setDate(t.getDate()+e),t.toISOString()}const et=e=>`#/vehicles/appraisalHistory/${e}`;function tt(e,t,a,s){let n=e.vehicle,r=e.condition,l=e.mileage,o=e.options,c=e.color,d=e.zipCode,p=e.payoffAmount,m=e.isPartnerOfferEligible,u=e.isPartnerOfferEligibleVin,h=e.isActiveInventory,g=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const b=n.style,f=b.year,E=b.id,v=b.name,y=b.makeName,C=b.modelName,T=b.makeNiceName,I=b.modelNiceName,N=b.submodels.slug,_=b.trimName,O=m&&!1!==u&&!h&&(null===g||g>0);return{vehicles:{appraisalHistory:{[t]:Object(i.a)({make:y,model:C,savedTs:Je(),styleId:E,condition:r,options:function(e){return e.map(e=>({optionCode:e.id,optionName:e.name}))}(o),colors:{exterior:c.id},styleName:v,isTradeIn:!0,year:Number(f),mileage:Number(l),appraisalMakeNiceName:T,appraisalModelNiceName:I,appraisalSubmodel:N,appraisalTrim:_,postalCode:d,milesPerYear:function(e,t){const a=Ye()(Date.now(),"yyyy")-e;return a>0?parseInt(t/a,10):parseInt(t,10)}(f,l),tradeInValue:a[Z.kb],dealerRetailValue:a[Z.s],privatePartyValue:a[Z.Z],offerEligibility:`${O}`,offerEligibilityExpiryTs:Je(O?30:0),payoffAmount:p},function(e){const t={};return Object.keys(Z.n).filter(e=>"DAMAGED"!==e).forEach(a=>{const s=Z.n[a],i=s.toLowerCase();t[`${Z.kb}Value${s}`]=S()(e,[i,Z.kb]),t[`${Z.Z}Value${s}`]=S()(e,[i,Z.Z]),t[`${Z.s}Value${s}`]=S()(e,[i,Z.s])}),t}(s))},latestAppraisalRef:et(t)}}}function at(e,t){return{[`${e}TradeIn`]:Object(We.c)(S()(t,"tradeIn",0)),[`${e}PrivateParty`]:Object(We.c)(S()(t,"privateParty",0)),[`${e}TmvRetail`]:Object(We.c)(S()(t,"dealerRetail",0))}}function st(e){let t=e.mileage,a=e.color.name,s=e.condition,n=e.zipCode,r=e.vehicle,l=e.appraisalEmailData,o=e.partnerOfferEmailData;const c=r.style,d=c.year,p=c.makeName,m=c.modelName,u=c.name,h=c.trimName,g=c.makeSlug,b=c.modelSlug,f=l.tmvConditions,E=l.colorPrices,v=l.conditionPrices,y=l.mileagePrices,C=l.nationalPrices,T=l.optionalPrices,I=l.regionalPrices,N=l.totalPrices,_=l.certifiedUsedPrice,O=l.vehiclePhoto,P=o||{},A=P.offerVin,V=P.offerCode,x=P.offerExpiredDate,k=P.offerExpiredTs,w=P.offerStoreName,R=P.offerStoreAddressLine1,M=P.offerStoreAddressLine2,j=P.redemptionCertificateUri,D=P.appointmentUri,L=`${Qe.a}${Object(Ze.h)({makeSlug:g,modelSlug:b,year:d})}`;return Object(i.a)({carImagePath:Object(He.k)(O,void 0,He.d.MEDIA)},(F=f,Object.entries(F).reduce((e,t)=>{let a=Object(qe.a)(t,2),s=a[0],i=a[1];const n=S()(i,"Current.totalWithOptions",{}),r=n.usedTradeIn,l=n.usedPrivateParty,o=Be()(s.toLowerCase());return ye()(e,`${Z.Z}${o}`,Object(Ge.c)(l)),ye()(e,`${Z.kb}${o}`,Object(Ge.c)(r)),e},{})),at("colorAdj",E),at("condition",v),at("mileage",y),at("nationalBase",C),at("regional",I),at("totalOptional",T),at("total",N),{color:a,condition:s,selectedCondition:s.toLowerCase(),mileage:t,vehicleFullName:`${d} ${p} ${m} ${u}`,make:p,model:m,year:d,trim:h,certifiedUsedPrice:_,corePagePath:L,zip:n,redemptionCertificateUri:j,appointmentUri:D,offerValuation:Object(We.c)(S()(o,"offerValuation",0),0),offerVin:A,offerCode:V,offerExpiredDate:x,offerExpiredTs:k,offerStoreName:w,offerStoreAddressLine1:R,offerStoreAddressLine2:M});var F}const it={email:{test:Xe.a.validateEmail,asyncTest:(e,t)=>Ke.a.fetchEmailValidation(Object(i.a)({},e,{id:"insider"}),t),errorText:"Please enter a valid email address."}},nt=async e=>{let t=e.isAuthenticated,a=e.doesNotHaveEmail,s=e.isValid,i=e.emailField,n=e.updateIdmData,r=e.validateEmailAsync,l=e.fetchSignInMethodsForEmail,o=e.fireValidExistingEmailCustomEvent;const c=await r();if(!s||!c.isEmailValid)return;const d=(0,i.value)(),p=await l(d);if(t&&a&&p&&0===p.length){const e={identifiers:{email:[d]}};await n(e)}o(d)};function rt(e){let t=e.headerText,a=e.subHeaderText;return e.isExtendedReport?null:V.a.createElement(L.a,{className:"mb-2"},V.a.createElement(U.a,{xs:12,className:"text-gray-darker",name:Z.hb},V.a.createElement("h2",{className:"mb-0"},t),V.a.createElement("div",{className:"font-weight-normal mb-0"},a)))}rt.propTypes={headerText:k.a.string,subHeaderText:k.a.string,isExtendedReport:k.a.bool},rt.defaultProps={headerText:"",subHeaderText:"",isExtendedReport:!1};var lt=a("../node_modules/reactstrap/lib/Button.js"),ot=a.n(lt),ct=a("../node_modules/reactstrap/lib/Collapse.js"),dt=a.n(ct),pt=a("../node_modules/reactstrap/lib/Form.js"),mt=a.n(pt),ut=a("../node_modules/react-scroll/lib/modules/index.js"),ht=a("./site-modules/shared/components/spinner/spinner.jsx");const gt=-48,bt=[Z.ab,Z.A,Z.F];class ft extends A.Component{constructor(){super(...arguments),this.state={isLoaded:!1},this.setLoaded=(()=>this.setState({isLoaded:!0})),this.handleSubmit=(e=>{e.preventDefault(),e.stopPropagation()})}componentDidMount(){J.a.domReady(this.setLoaded)}render(){const e=this.props,t=e.id,a=e.nextId,s=e.stepCounter,i=e.title,n=e.children,r=e.isActive,l=e.isDone,o=e.isFinal,c=e.hasTotalPayment,d=e.onDone,p=e.onSave,m=e.isExtendedReport,u=e.onContinue,h=e.trackingParentId,g=e.appliedTradeIn,b=e.predefinedVin,f=e.isQueryPredefinedVin,E=e.styleIds,v=e.isEscapeHatch,y=e.isLoadingColorsAndOptions,C=e.isMobile,S=this.state.isLoaded,T=o?!c:!l,I=l&&!r,N=!l,_=o&&r,O=Re()({secondary:T,success:!T}),P={"btn-secondary disabled":T,"btn-success":!T},x=V.a.createElement(U.a,{xs:12,md:7},V.a.createElement(ut.Button,{to:K.ib,type:"submit",value:`Apply ${Object(Ge.a)(g)} to my deal`,tabIndex:0,offset:gt,onClick:p,"data-tracking-id":Z.i[t],color:O,className:Re()("with-vertical-top-line form-button pos-r d-block w-100 btn",P),smooth:!0})),k=V.a.createElement(U.a,{xs:12,md:5},V.a.createElement(ot.a,{color:"link",onClick:d,"data-tracking-id":"close_report","data-tracking-value":"close button",block:!0,className:"text-decoration-none text-center text-md-left pl-md-1 text-primary-darker"},"Close")),w=S?"Continue":"Loading...",R=V.a.createElement(U.a,{xs:12,md:4,className:"px-0"},V.a.createElement(ot.a,{type:"submit",onClick:u,"data-index":a,"data-tracking-id":Z.i[t],color:"success",className:Re()("heading-5 text-white py-0_5 form-button text-transform-none pos-r d-block w-100",Z.r),disabled:!S||y},y&&V.a.createElement("span",{className:"pr-0_5"},V.a.createElement(ht.a,{size:14,thickness:1,color:"white"})),w)),M=f&&b&&(e=>!e||1===e.split(",").length)(E),j=t===Z.F&&(!m||M&&!C),D=!o&&!bt.includes(t)||j,F=()=>V.a.createElement(L.a,{className:Re()("mt-2",{"mt-md-2_5":t===Z.F&&m})},R),q=!(t===Z.A||t===Z.x);let z=[Z.F,Z.p,Z.N,Z.A].includes(t)?10:12;return t===Z.x&&(z=11),V.a.createElement(mt.a,{tag:q?"form":"div",action:q?"javascript:void(0);":void 0,onSubmit:this.handleSubmit,className:Re()("pos-r",Z.ib,t,{"pb-1_5":!o,"mb-1_5":o,done:I,active:r,invisible:!r&&!l}),autoComplete:q?"off":void 0},V.a.createElement("div",{className:"form-content pos-r bg-white rounded mt-0_75"},V.a.createElement(ot.a,{"data-index":t,"data-tracking-id":Z.j,onClick:u,disabled:N,className:"step-header d-flex align-items-center bg-white text-decoration-none border-0 p-0 ml-1 ml-md-1_5 pr-1_25 size-16"},V.a.createElement("span",{"data-index":t,className:Re()("step-counter rounded-circle d-inline-flex align-items-center justify-content-center mr-1 size-14 font-weight-bold",{"bg-primary-darker text-white":r,"icon-done text-success":I})},!I&&s),V.a.createElement("span",{"data-index":t,className:"step-label"},i())),V.a.createElement(dt.a,{isOpen:r,"data-tracking-parent":h},V.a.createElement("div",{className:Re()("pos-r mt-1_5 px-1_5 px-md-3",{"pb-3":t!==Z.x})},m?V.a.createElement(A.Fragment,null,V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,xl:z,className:Re()({"mx-xl-auto":t===Z.x,"px-xl-0":t===Z.x&&v})},n)),D&&V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,xl:10},F()))):V.a.createElement(A.Fragment,null,V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12},n)),D&&F())))),!m&&_&&V.a.createElement(L.a,{className:"mt-1_5"},x,k))}}ft.propTypes={title:k.a.func.isRequired,id:k.a.string.isRequired,children:k.a.node.isRequired,nextId:k.a.string,stepCounter:k.a.number.isRequired,onDone:k.a.func,onContinue:k.a.func,onSave:k.a.func,isDone:k.a.bool,isActive:k.a.bool,isFinal:k.a.bool,hasTotalPayment:k.a.bool,isExtendedReport:k.a.bool,trackingParentId:k.a.string,appliedTradeIn:k.a.number,predefinedVin:k.a.string,isQueryPredefinedVin:k.a.bool,styleIds:k.a.string,isEscapeHatch:k.a.bool,isLoadingColorsAndOptions:k.a.bool,isMobile:k.a.bool},ft.defaultProps={nextId:"",isDone:!1,isFinal:!1,isActive:!1,hasTotalPayment:!1,onDone:null,onContinue:null,onSave:null,isExtendedReport:!1,trackingParentId:null,appliedTradeIn:0,predefinedVin:"",isQueryPredefinedVin:!1,styleIds:"",isEscapeHatch:!1,isLoadingColorsAndOptions:!1,isMobile:!1};var Et=a("./site-modules/shared/components/vehicle-dropdowns/vehicle-dropdowns.jsx"),vt=a("./site-modules/shared/components/appraisal/zip-field/zip-field.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/location-and-style-step/location-and-style-step.scss");class yt extends A.Component{constructor(){super(...arguments),this.state={isLoaded:!1},this.onSelect=((e,t,a,s,i)=>{const n=this.props,r=n.onDropdownsSelect,l=n.vin,o=n.vinStyles,c=n.checkVinMismatchError;r(e,t,a,s,i),l&&c(o)}),this.setLoaded=(()=>{this.setState(()=>({isLoaded:!0}))}),this.vehicleDropdownRender=(e=>{const t=this.props,a=t.selectStyle,i=t.estimatedVehicle,n=t.errorMap,r=t.updateStepsState,l=t.isMobile,o=this.state.isLoaded,c=!!i,d=n.get(le.f),p=n.get(le.h),m=n.get(le.l),u=n.get(le.j);return V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,className:"px-0"},V.a.createElement(Et.a,Object(s.a)({tag:"div",showAllSubmodels:c,hasModel:!0,hasYear:!0,hasStyle:!0,vehicle:i,selectStyle:a,hasOptionTruncate:!1,inputClasses:"form-control pr-2 w-100 mmy-select input-content",makeLabel:"Make",modelLabel:"Model",yearLabel:"Year",styleLabel:"Style",labelClassName:"small mb-0_25",buttonGroupClassNames:"d-none",errorMake:d,errorModel:p,errorYear:m,errorStyle:u,pubStatesYears:Z.a,isStyleIdQueryParamEnabled:!0,isMobile:l,updateStepsState:r,disabled:!o,enableSpinner:!0},e))))}),this.renderLayout=(()=>{const e=this.props,t=e.isZipCodeValid,a=e.onZipCodeChange,s=e.onDropdownsSelect,i=e.zipCode,n=e.errorMap,r=this.state.isLoaded;return V.a.createElement(A.Fragment,null,V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,md:6,className:"px-0"},V.a.createElement(vt.a,{isZipCodeValid:t,onZipCodeChange:a,zipCode:i,zipClassName:"pr-md-1",errorMap:n,disabled:!r,zipWrapperClassName:"mb-1"}))),this.vehicleDropdownRender({makeDropdownClassNames:"has-right-padding mb-1 p-0 pr-md-0_75 pr-lg-1",modelDropdownClassNames:"mb-1 p-0 pl-md-0_75 pl-lg-1",submodelDropdownClassNames:"mb-1 p-0 pl-md-0_75 pl-lg-1",yearDropdownClassNames:"has-right-padding mb-1 mb-md-0 p-0 pr-md-0_75 pr-lg-1",styleDropdownClassNames:"mb-0 p-0 pl-lg-1 pl-md-0_75 pos-r",isStyledSelects:!0,onDropdownsSelect:s}))}),this.renderExtendedLayout=(()=>{const e=this.props,t=e.isZipCodeValid,a=e.onZipCodeChange,s=e.zipCode,i=e.errorMap,n=e.isMobile,r=e.changeStep,l=e.isLoadingColorsAndOptions,o=this.state.isLoaded;return n?V.a.createElement(A.Fragment,null,this.vehicleDropdownRender({makeDropdownClassNames:"custom-select-arrow has-right-padding mb-1 p-0 pr-md-0_75 pr-lg-1",modelDropdownClassNames:"custom-select-arrow mb-1 p-0 pl-md-0_75 pl-lg-1",submodelDropdownClassNames:"custom-select-arrow mb-1 p-0 pl-md-0_75 pl-lg-1",yearDropdownClassNames:"custom-select-arrow has-right-padding mb-1 mb-md-0 p-0 pr-md-0_75 pr-lg-1",styleDropdownClassNames:"custom-select-arrow mb-0 p-0 pl-lg-1 pl-md-0_75 pos-r",onDropdownsSelect:this.onSelect,showFindStyleLink:!0}),V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:4,md:6,className:"px-0 mt-2 mt-md-3"},V.a.createElement(vt.a,{isZipCodeValid:t,onZipCodeChange:a,zipCode:s,zipClassName:"pr-md-0_75",errorMap:i,disabled:!o,labelClassName:"icon-location text-primary-darker ml-0_75",inputClassName:"pl-2",isMobile:!0})),V.a.createElement(U.a,{xs:7,md:6,lg:4,className:"px-0 mt-2 mt-md-3 ml-auto pl-md-0_75"},V.a.createElement(ot.a,{type:"submit",onClick:r,"data-index":Z.m,"data-tracking-id":Z.i[Z.F],color:"success",className:Re()("heading-5 text-white py-0_5 form-button text-transform-none pos-r d-block w-100",Z.r),disabled:!o||l},l&&V.a.createElement("span",{className:"pr-0_5"},V.a.createElement(ht.a,{size:14,thickness:1,color:"white"})),"Continue")))):V.a.createElement(A.Fragment,null,this.vehicleDropdownRender({errorMessageClassNames:"mt-0_5",makeDropdownClassNames:"has-right-padding mb-1 p-0 pr-md-0_75 pr-lg-1",modelDropdownClassNames:"mb-1 p-0 pl-md-0_75 pl-lg-1",submodelDropdownClassNames:"mb-1 p-0 pl-md-0_75 pl-lg-1",yearDropdownClassNames:"has-right-padding mb-1 mb-md-0 p-0 pr-md-0_75 pr-lg-1",styleDropdownClassNames:"mb-0 p-0 pl-lg-1 pl-md-0_75 pos-r style-dropdown-error-gutter",isStyledSelects:!0,onDropdownsSelect:this.onSelect,showFindStyleLink:!0}),V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,md:6,className:"px-0 mt-1"},V.a.createElement(vt.a,{isZipCodeValid:t,onZipCodeChange:a,zipCode:s,zipClassName:"pr-md-1 mb-0 mmy-zip-code",errorMap:i,disabled:!o}))))})}componentDidMount(){J.a.domReady(()=>this.setLoaded())}componentDidUpdate(e){const t=this.props,a=t.vinStyles,s=t.checkVinMismatchError,i=t.isProfileOfferVinPrepopulationEnabled;a&&!m()(e.vinStyles,a)&&i&&s(a)}render(){const e=this.props.isExtendedReport;return V.a.createElement("div",{className:"location-and-style-step"},e?this.renderExtendedLayout():this.renderLayout())}}yt.propTypes={isZipCodeValid:k.a.bool.isRequired,onZipCodeChange:k.a.func.isRequired,onDropdownsSelect:k.a.func.isRequired,updateStepsState:k.a.func,selectStyle:k.a.bool,isExtendedReport:k.a.bool,isMobile:k.a.bool,zipCode:k.a.string,estimatedVehicle:ee.b.StyleWithoutSubmodels,errorMap:k.a.objectOf(k.a.string),changeStep:k.a.func,isLoadingColorsAndOptions:k.a.bool,vehicle:k.a.shape({}),vin:k.a.string,checkVinMismatchError:k.a.func,isProfileOfferVinPrepopulationEnabled:k.a.bool,vinStyles:k.a.arrayOf(k.a.shape({}))},yt.defaultProps={updateStepsState:b.a,selectStyle:!1,isExtendedReport:!1,isMobile:!1,zipCode:"",estimatedVehicle:null,errorMap:new Map,changeStep:b.a,isLoadingColorsAndOptions:!1,vehicle:{},vin:"",checkVinMismatchError:b.a,isProfileOfferVinPrepopulationEnabled:!1,vinStyles:null};const Ct={vinStyles:Object(B.a)(e=>Object(te.d)(e),te.b)},St=Object(B.b)(yt,Ct);var Tt=a("../node_modules/reactstrap/lib/ButtonGroup.js"),It=a.n(Tt),Nt=a("./site-modules/shared/components/appraisal/appraisal-tabs/appraise-by-tabs-header-item.jsx"),_t=a("./site-modules/shared/components/appraisal/appraisal-tabs/appraisal-tab-link/appraisal-tab-link.jsx"),Ot=a("../node_modules/reactstrap/lib/TabContent.js"),Pt=a.n(Ot),At=a("../node_modules/reactstrap/lib/TabPane.js"),Vt=a.n(At),xt=a("./site-modules/shared/components/error-boundary/error-boundary.jsx"),kt=a("./data/models/partner-offer-model.js"),wt=a("./data/models/states.js"),Rt=a("./data/models/vehicle-v2.js"),Mt=a("./site-modules/shared/components/appraisal/appraisal-tabs/license-plate-tab-content/license-plate-tab-content.jsx"),jt=(a("../node_modules/core-js/modules/es6.regexp.replace.js"),a("../node_modules/reactstrap/lib/FormGroup.js")),Dt=a.n(jt),Lt=a("../node_modules/reactstrap/lib/Label.js"),Ft=a.n(Lt),Ut=a("../node_modules/reactstrap/lib/Input.js"),qt=a.n(Ut),zt=a("./utils/seed-randomizers.js"),Bt=a("../node_modules/react-input-mask/index.js"),$t=a.n(Bt),Yt=a("./site-modules/shared/components/field-error/field-error.jsx"),Ht=a("./site-modules/shared/components/find-vin-modal/find-vin-modal.jsx"),Zt=a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/license-plate-and-vin-step/epo-tab-content-form-wrapper.jsx"),Gt=a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/license-plate-and-vin-step/let-us-know-wufoo.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/license-plate-and-vin-step/epo-vin-tab-content.scss");const Wt="*****************";class Qt extends A.Component{constructor(){super(...arguments),this.state={vin:"",isSubmitted:!1,isSubmitting:!1,errorMap:new Map},this.onVinChange=(e=>{const t=e.target.value;return this.setState(e=>{let a=e.errorMap;return a.has(le.d)&&a.delete(le.d),{vin:Object(le.q)(t),errorMap:a,isSubmitted:!1}},()=>{this.props.updateStepsState("isAllowedToPredefineVin",!1),this.props.onValueChange()})}),this.getShortSquishVin=(()=>this.props.squishVins.length?this.props.squishVins[0].slice(0,-2):""),this.getVinInputId=(()=>`vin${this.uniqInputId}`),this.setIsSubmitted=(e=>this.setState(t=>({isSubmitted:e,isSubmitting:!e&&t.isSubmitting}))),this.setVinError=((e,t)=>this.setState(a=>{let s=a.errorMap;if(e)s.delete(le.d);else{const e=t?V.a.createElement(A.Fragment,null,le.e.get(le.d)," ",V.a.createElement(Gt.a,null)):V.a.createElement(A.Fragment,null,Z.tb," ",V.a.createElement(Gt.a,null));s.set(le.d,e)}return{errorMap:s}})),this.uniqInputId="",this.handleFocus=(e=>{e.target.value.replace(/[_x]/gi,"").length||this.setState({vin:this.getShortSquishVin()})}),this.handlePaste=(e=>{const t=e.clipboardData.getData("text");17===t.length&&(e.preventDefault(),this.onVinChange({target:{value:t}}))}),this.vinLabel=(()=>V.a.createElement("div",{className:"d-flex align-items-center"},V.a.createElement("div",{className:"mr-0_5"},"Enter VIN"),!this.props.isEscapeHatchDrawer&&V.a.createElement(Ht.a,{className:"text-decoration-none p-0 border-0 text-primary-darker text-transform-none size-16 find-vin-modal-open-btn",creativeId:`${this.props.creativeId}-popup`,isInfoIcon:!0}))),this.handleSubmit=(async e=>{e.preventDefault(),await this.props.clearVin(),this.setState({isSubmitted:!0}),this.toggleSubmit(this.validateAndSubmit)}),this.toggleSubmit=(e=>this.setState(e=>({isSubmitting:!e.isSubmitting}),e)),this.validate=(()=>{const e=this.state.vin,t=Object(le.s)(e),a=Xe.a.validateVinLength(e.replace(/_/gim,""));return this.setVinError(t,a),t}),this.validateAndSubmit=(()=>{const e=this.props,t=e.setVin,a=e.onValidationError,s=e.creativeId,i=this.state.vin;this.validate()?t(i):(J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:X.b.ACTION_APPRAISE_VEHICLE,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_USER_INPUT,subaction_name:X.b.SUBACTION_VIN_VALIDATION,creative_id:s,value:X.b.VIN_FORMAT_INVALID}}),J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:X.b.ACTION_APPRAISE_VEHICLE,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_USER_INPUT,subaction_name:X.b.SUBACTION_VIN_ERROR,creative_id:s,value:`${i}_${X.b.SUBACTION_VIN_VALIDATION}_${X.b.VIN_FORMAT_INVALID}`}}),this.toggleSubmit(a))}),this.errorMessages=(()=>{const e=this.state,t=e.isSubmitted,a=e.isSubmitting,s=e.errorMap,i=this.props,n=i.squishVinError,r=i.forceError,l=s.get(le.d),o=`${le.d}-error-${Object(zt.c)()}`,c=t&&!a&&l,d=(t&&!a||r)&&!s.has(le.d)&&n;return V.a.createElement(A.Fragment,null,V.a.createElement(Yt.a,{classes:"mt-0_5",id:o,error:c}),V.a.createElement(Yt.a,{classes:"mt-0_5",id:o,error:d}))}),this.renderDefaultVinInput=(()=>{const e=this.state.vin;return V.a.createElement(qt.a,{className:"vin-input text-uppercase size-16",id:this.getVinInputId(),value:e,onChange:this.onVinChange,maxLength:17,minLength:17})}),this.renderMaskedVinInput=(e=>V.a.createElement(qt.a,Object(s.a)({},e,{className:"vin-input text-uppercase size-16 masked-input",id:this.getVinInputId()})))}componentDidMount(){const e=this.props,t=e.queryVin,a=e.useUniqId;e.isAllowedToPredefineVin&&t&&this.onVinChange({target:{value:t}}),a&&(this.uniqInputId=Object(zt.c)())}componentDidUpdate(e){const t=this.props,a=t.vinEligibility,s=t.onCompleteCallback,i=t.onValidationError,n=t.isVinFromDrawer,r=t.isAllowedToPredefineVin,l=t.queryVin,o=t.vin,c=this.state,d=c.isSubmitting,p=c.vin;if(o&&!m()(e.vin,o)&&n&&(p&&m()(p,this.props.vin)||this.onVinChange({target:{value:o}})),r&&l&&!m()(e.queryVin,l)&&this.onVinChange({target:{value:l}}),!m()(a,e.vinEligibility)&&!y()(a)){const e=a.isCheckDigitValid,t=a.isEligibleVin;d?e?this.toggleSubmit(s(p,a)):(this.setVinError(e,!0),this.toggleSubmit(i)):r&&l&&e?s(p,a):n&&!t&&(this.setIsSubmitted(!0),s(o,a))}}render(){const e=this.props,t=e.tabContentModal,a=e.squishVinError,s=e.queryVin,i=e.ctaText,n=e.isSecondary,r=e.isEscapeHatch,l=e.isVinFromDrawer,o=e.isEscapeHatchDrawer,c=e.isLocationStyleStep,d=e.hideVinLicensePlateBtn,p=e.isEval3463Chal1Enabled,m=e.isEval3622Chal1Enabled,u=this.state,h=u.vin,g=u.isSubmitted,b=u.isSubmitting,f=p||m,E=u.errorMap.get(le.d)||a,v=t&&!s&&!l,y=this.getShortSquishVin();let C=8,S=10,T=o?7:6;return T=c?8:T,(r||o||c)&&(C=12,S=12),V.a.createElement(Zt.a,{isEscapeHatch:r,isEscapeHatchDrawer:o,isLocationStyleStep:c},V.a.createElement(mt.a,{onSubmit:this.handleSubmit},V.a.createElement(L.a,{className:Re()("epo-vin-tab",{"mt-1":o,"mt-0_25":c})},!y||s||l||!(!o||o&&f)||c?V.a.createElement(U.a,{xs:12,md:S,lg:C},V.a.createElement(Dt.a,{className:Re()({"has-danger":E,"has-success":g&&!E,"pr-md-1":c})},c?V.a.createElement(Ft.a,{className:"small mb-0_25 d-flex justify-content-between",for:this.getVinInputId()},V.a.createElement("span",null,"Enter VIN"),V.a.createElement(Ht.a,{className:"p-0 border-0 text-primary-darker text-transform-none small find-vin-modal-open-btn",creativeId:Z.e})):V.a.createElement(Ft.a,{className:"font-weight-bold",for:this.getVinInputId()},this.vinLabel()),this.renderDefaultVinInput(),this.errorMessages())):V.a.createElement(U.a,{xs:12,md:S,lg:C},V.a.createElement(Dt.a,{className:Re()("mb-1_5",{"has-danger":E,"has-success":g&&!E})},V.a.createElement(Ft.a,{for:this.getVinInputId(),className:"text-gray-darker size-14"},"Enter last 9 digits of your VIN",V.a.createElement(Ht.a,{className:"text-decoration-none ml-0_25 text-gray-darker p-0 border-0 text-transform-none find-vin-modal-open-btn size-16",creativeId:`${this.props.creativeId}-popup`,isInfoIcon:!0})),V.a.createElement($t.a,{mask:Wt,maskChar:"_",alwaysShowMask:!1,formatChars:{"*":"[A-Za-z0-9]"},value:h,onChange:this.onVinChange,onFocus:this.handleFocus,onPaste:this.handlePaste},this.renderMaskedVinInput),this.errorMessages()))),!d&&V.a.createElement(L.a,{className:Re()("align-items-center",{"mt-0_5":c||o})},V.a.createElement(U.a,{xs:12,md:r?12:T},V.a.createElement(ot.a,{color:o&&!f?"primary-b":"success",block:!0,className:Re()("epo-vin-continue-btn text-transform-none",{"py-1":r,"py-0_5":!r}),onClick:this.handleSubmit,disabled:b,"data-tracking-id":"epo_submit_vin","data-tracking-value":n?`${i} 2`:i},b&&V.a.createElement("span",{className:"pr-0_5"},V.a.createElement(ht.a,{size:14,thickness:1,color:"white"})),V.a.createElement("span",{className:"size-16"},i))),v&&V.a.createElement(U.a,{xs:12,md:r?12:6,className:Re()("mt-1 text-center",{"text-md-left mt-md-0":!r})},t))))}}Qt.propTypes={setVin:k.a.func.isRequired,clearVin:k.a.func.isRequired,onCompleteCallback:k.a.func.isRequired,onValidationError:k.a.func.isRequired,vinEligibility:kt.a.VinEligibility,vin:k.a.string,queryVin:k.a.string,creativeId:k.a.string,tabContentModal:k.a.oneOfType([k.a.node,k.a.func]),squishVinError:k.a.oneOfType([k.a.string,k.a.node,k.a.func]),onValueChange:k.a.func,ctaText:k.a.string,isSecondary:k.a.bool,squishVins:k.a.arrayOf(k.a.string),isEscapeHatch:k.a.bool,isVinFromDrawer:k.a.bool,isEscapeHatchDrawer:k.a.bool,isLocationStyleStep:k.a.bool,useUniqId:k.a.bool,forceError:k.a.bool,hideVinLicensePlateBtn:k.a.bool,isEval3463Chal1Enabled:k.a.bool,isEval3622Chal1Enabled:k.a.bool,isMobile:k.a.bool,isAllowedToPredefineVin:k.a.bool,updateStepsState:k.a.func},Qt.defaultProps={vinEligibility:null,vin:"",squishVins:[],queryVin:"",creativeId:Z.B,tabContentModal:null,squishVinError:null,onValueChange:b.a,ctaText:"Continue",isSecondary:!1,isEscapeHatch:!1,isVinFromDrawer:!1,isEscapeHatchDrawer:!1,isLocationStyleStep:!1,useUniqId:!0,forceError:!1,hideVinLicensePlateBtn:!1,isEval3463Chal1Enabled:!1,isEval3622Chal1Enabled:!1,isMobile:!1,isAllowedToPredefineVin:!0,updateStepsState:b.a};var Kt=a("./site-modules/shared/components/form-field/form-field.jsx"),Xt=a("./site-modules/shared/components/styled-select/styled-select.jsx"),Jt=a("./site-modules/shared/components/form-validation/form-validation.jsx"),ea=a("./site-modules/shared/components/zip-input/zip-input.jsx"),ta=a("./site-modules/shared/components/radio-list/radio-list-item.jsx");const aa={OFFER:"Get My Offer",APPRAISE:"No thanks. I just want an appraisal"},sa={licensePlate:"Don't have your license plate?",vin:"Don't have your VIN?"};var ia=a("./site-modules/shared/components/drawer/drawer.jsx");a("./site-modules/shared/components/find-vin-modal/find-vin-modal.scss");const na="CLOSE_VIN_DRAWER",ra={licensePlate:"We can use your VIN instead. Please provide your VIN below to generate your offer:",vin:"We can use your License Plate instead. Please provide your License Plate below to generate your offer:"},la={licensePlate:"If you have your VIN on you, please provide it to generate your offer:",vin:"We can use your License Plate instead. Please provide your License Plate below to generate your offer:"};class oa extends A.Component{constructor(){super(...arguments),this.state={isOpen:!1,showVinLpForm:!1},this.handleDrawerClose=(()=>{this.setState(()=>({isOpen:!1}))}),this.trackDrawerToggle=(()=>{const e=this.props.creativeId,t=this.state.isOpen;J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:X.b.ACTION_SHOW_CONTENT,action_category:X.b.SYSTEM_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_LINK_CLICK,subaction_name:t?X.b.FIND_VIN:X.b.CLOSE_POPUP,creative_id:e,value:t?"open":"close"}})}),this.toggleDrawer=(()=>this.setState(e=>({isOpen:!e.isOpen,showVinLpForm:!1}),this.trackDrawerToggle)),this.toggleDrawerWithoutTracking=(()=>this.setState(e=>({isOpen:!e.isOpen,showVinLpForm:!1}))),this.appraisalOnClick=(e=>{this.props.changeStep(e),this.toggleDrawerWithoutTracking()}),this.toggleVinLpForm=(()=>{this.setState(e=>({showVinLpForm:!e.showVinLpForm}))}),this.renderVinLpForm=(()=>{const e=this.props,t=e.isLicensePlate,a=e.licensePlateAndVinForm,s=e.isEval3463Chal1Enabled,i=e.isEval3622Chal1Enabled,n=this.state.showVinLpForm,r=s||i;let l="vin";t&&(l="licensePlate");const o=sa[l],c=aa.APPRAISE;return r&&!n?null:V.a.createElement(A.Fragment,null,V.a.createElement("div",{className:"mt-1_5 mb-1 pos-r text-gray-darker"},!r&&V.a.createElement("h4",{className:"size-24"},o," No problem!"),V.a.createElement("div",null,r?la[l]:ra[l])),a,V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,md:7},V.a.createElement(ot.a,{color:"link",className:"text-primary-darker text-transform-none mt-0_5 px-0 text-center text-lg-left",block:!0,onClick:this.appraisalOnClick,"data-index":Z.x,"data-tracking-id":"view_appraisal","data-tracking-value":"get_appraisal"},V.a.createElement("span",{className:"font-weight-normal"},c)))))})}componentDidMount(){J.a.on(na,this.handleDrawerClose)}componentWillUnmount(){J.a.off(na,this.handleDrawerClose)}render(){const e=this.props,t=e.className,a=e.creativeId,s=e.isLicensePlate,i=e.updateVinAndContinue,n=e.updateStepsState,r=e.vehicle,l=e.isEval3463Chal1Enabled,o=e.isEval3622Chal1Enabled,c=e.setVinFromDrawerSquishStyles,d=l||o;let p="vin";s&&(p="licensePlate");const m=sa[p];return V.a.createElement(A.Fragment,null,V.a.createElement(ia.a,{isOpen:this.state.isOpen,toggle:this.toggleDrawer,side:"right",size:"xsmall"},V.a.createElement("div",{className:"p-1_5 p-md-2","data-tracking-parent":a},V.a.createElement(ot.a,{color:"link",size:"lg",className:"close-btn p-0 d-flex align-items-center","aria-label":"Close",onClick:this.toggleDrawer},V.a.createElement("i",{className:"icon-arrow-left3 size-16"}),V.a.createElement("span",{className:"size-14 ml-0_5 text-capitalize font-weight-normal"},"Back")),d&&V.a.createElement(wa,{updateStepsState:n,creativeId:a,vehicle:r,handleAppraisalOnClick:this.appraisalOnClick,updateVinAndContinue:i,toggleVinLpForm:this.toggleVinLpForm,resetAddressForm:!this.state.isOpen,setVinFromDrawerSquishStyles:c,isEval3622Chal1Enabled:o,useUniqId:!0}),this.renderVinLpForm())),V.a.createElement(ot.a,{color:"link",className:Re()("p-0 border-0 text-primary-darker text-transform-none size-16 find-vin-modal-open-btn",t),onClick:this.toggleDrawer},V.a.createElement("span",{className:"font-weight-normal"},m)))}}oa.propTypes={creativeId:k.a.string.isRequired,changeStep:k.a.func.isRequired,licensePlateAndVinForm:k.a.node.isRequired,className:k.a.string,isLicensePlate:k.a.bool,isEval3463Chal1Enabled:k.a.bool,isEval3622Chal1Enabled:k.a.bool,updateVinAndContinue:k.a.func,updateStepsState:k.a.func,setVinFromDrawerSquishStyles:k.a.func,vehicle:k.a.shape({make:k.a.shape({name:k.a.string}),model:k.a.shape({name:k.a.string})})},oa.defaultProps={className:"",isLicensePlate:!1,isEval3463Chal1Enabled:!1,isEval3622Chal1Enabled:!1,vehicle:{},updateVinAndContinue:b.a,setVinFromDrawerSquishStyles:b.a,updateStepsState:b.a};var ca=a("./images/no-vin-found.svg"),da=a.n(ca);const pa={SINGLE_VIN:"We found a VIN using the address you provided.",MULTIPLE_VINS:"We found these vehicles based on the address you provided. Please select the correct one."};var ma=a("../node_modules/reactstrap/lib/Modal.js"),ua=a.n(ma),ha=a("../node_modules/reactstrap/lib/ModalBody.js"),ga=a.n(ha),ba=a("../node_modules/reactstrap/lib/ModalHeader.js"),fa=a.n(ba),Ea=a("../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js");const va={stateCodes:Object(B.a)("allStateCodes",wt.b),vinEligibility:Object(B.a)(e=>{let t=e.vehicle,a=t.make,s=t.model,i=t.year,n=e.vin,r=e.isEligibleHardcodeYmmBypass,l=e.creativeId;return a&&s&&i?Object(kt.e)({vin:n,make:a.name,model:s.name,year:i.year,isEligibleHardcodeYmmBypass:r,trackingCreativeId:l}):null},kt.b),vinFromLicensePlate:Object(B.a)(e=>{let t=e.licensePlate,a=e.stateCode;return Object(kt.c)({licensePlate:t,stateCode:a})},kt.b)},ya=Object(q.c)(e=>({licensePlateLookupError:Object(kt.g)(e),isAppExtensionPage:S()(e,"pageContext.isAppExtensionPage")}))(Object(B.b)(Mt.a,va));class Ca extends A.PureComponent{render(){const e=this.props,t=e.vin,a=e.isMobile,i=e.creativeId,n=e.ctaText,r=e.isVdpEmbedded,l=e.vinTabLink,o=e.isStylesFromUniversalVinEnabled,c=e.isVinByAddressOverlay,d=e.onCompleteCallback,p=e.onValidationError,m=e.isAppraisalValuePage,u=e.setVin,h=e.clearVin,g=e.squishVinError,b=e.onValueChange,f=(e.changeStep,e.useUniqId),E=e.setLicensePlateAndStateCode,v=e.licensePlate,y=e.stateCode,C=Object(Ea.a)(e,["vin","isMobile","creativeId","ctaText","isVdpEmbedded","vinTabLink","isStylesFromUniversalVinEnabled","isVinByAddressOverlay","onCompleteCallback","onValidationError","isAppraisalValuePage","setVin","clearVin","squishVinError","onValueChange","changeStep","useUniqId","setLicensePlateAndStateCode","licensePlate","stateCode"]);return V.a.createElement(ya,Object(s.a)({vin:t,licensePlate:v,stateCode:y,setVin:u,clearVin:h,isMobile:a,ctaText:n,creativeId:i,isVdpEmbedded:r,isVinByAddressOverlay:c,onCompleteCallback:d,onValidationError:p,vinTabLink:l,setLicensePlateAndStateCode:E,isStylesFromUniversalVinEnabled:o,isAppraisalValuePage:m,squishVinError:g,onValueChange:b,useUniqId:f},C))}}Ca.propTypes={isMobile:k.a.bool,isVdpEmbedded:k.a.bool,isLookUpStyleView:k.a.bool,isStylesFromUniversalVinEnabled:k.a.bool,ctaText:k.a.string,vin:k.a.string,creativeId:k.a.string,vinTabLink:k.a.oneOfType([k.a.node,k.a.func]),onCompleteCallback:k.a.func,onValidationError:k.a.func,isAppraisalValuePage:k.a.bool,isVinByAddressOverlay:k.a.bool,useUniqId:k.a.bool,isEligibleHardcodeYmmBypass:k.a.bool,setVin:k.a.func,clearVin:k.a.func,onValueChange:k.a.func,changeStep:k.a.func,setLicensePlateAndStateCode:k.a.func,squishVinError:k.a.oneOfType([k.a.string,k.a.node,k.a.func]),vehicle:k.a.shape({make:k.a.shape({name:k.a.string}),model:k.a.shape({name:k.a.string}),year:k.a.shape({})}).isRequired,licensePlate:k.a.string,stateCode:k.a.string},Ca.defaultProps={vin:"",isMobile:!1,isVdpEmbedded:!1,isLookUpStyleView:!1,isStylesFromUniversalVinEnabled:!1,isVinByAddressOverlay:!1,ctaText:void 0,creativeId:void 0,vinTabLink:null,onCompleteCallback:b.a,onValidationError:b.a,onValueChange:b.a,changeStep:b.a,setLicensePlateAndStateCode:b.a,setVin:null,clearVin:null,isAppraisalValuePage:!1,useUniqId:!1,isEligibleHardcodeYmmBypass:!1,squishVinError:null,vehicle:{},licensePlate:"",stateCode:""};a("./site-modules/shared/components/find-vin-by-address/found-vehicle-overlay/found-vehicles-overlay.scss");const Sa="Continue with this vehicle";class Ta extends A.Component{constructor(){super(...arguments),this.state={isOpen:!1},this.setIsOpen=(e=>this.setState({isOpen:e})),this.toggleModal=((e,t)=>{const a=this.props,s=a.onCompleteCallback,i=a.onClosed,n=this.state.isOpen;s(e,t),t&&t.isEligibleVin&&(this.setIsOpen(!n),i())})}componentDidMount(){this.props.shouldOpen&&this.setIsOpen(!0)}render(){const e=this.props,t=e.isMobile,a=e.onValidationError,s=e.setVin,i=e.isAppraisalValuePage,n=e.creativeId,r=e.clearVin,l=e.squishVinError,o=e.stateCode,c=e.licensePlate,d=e.vin,p=e.isEligibleHardcodeYmmBypass,m=e.setLicensePlateAndStateCode,u=e.onValueChange,h=e.useUniqId,g=e.vehicle,b=e.onClosed,f=this.state.isOpen;return V.a.createElement(ua.a,{className:"found-vehicles-overlay mx-auto pt-1 pt-md-3_5",contentClassName:"mt-1_5 mt-md-3_5",isOpen:f},V.a.createElement(fa.a,{tag:"div",className:"justify-content-end p-0",onClick:b},V.a.createElement(ot.a,{color:"link",className:"text-decoration-none heading-3 pt-1 pr-1 pb-0","data-testid":"close-btn"},V.a.createElement("i",{className:"icon-cross2"}))),V.a.createElement(ga.a,{className:"text-center px-2 px-md-2_5 pt-0 pt-lg-1"},V.a.createElement(A.Fragment,null,V.a.createElement("div",{className:"modal-body-content"},V.a.createElement("header",{className:"pos-r text-gray-darker text-center"},V.a.createElement("img",{className:"d-inline-block mx-auto mb-1",src:da.a,alt:"no vin found"}),V.a.createElement("h4",{className:"size-20"},"Unfortunately, we can't find your VIN at this time."),V.a.createElement("div",{className:"size-16 text-left pb-1_5"},"We can use your License Plate instead. Please provide your License Plate below to generate your offer.")),V.a.createElement(Ca,{isMobile:t,ctaText:Sa,isVinByAddressOverlay:!0,onCompleteCallback:this.toggleModal,onValidationError:a,isAppraisalValuePage:i,setVin:s,clearVin:r,creativeId:n,squishVinError:l,onValueChange:u,useUniqId:h,vehicle:g,isEligibleHardcodeYmmBypass:p,setLicensePlateAndStateCode:m,vin:d,licensePlate:c,stateCode:o})))))}}Ta.propTypes={shouldOpen:k.a.bool,isMobile:k.a.bool,onClosed:k.a.func,onCompleteCallback:k.a.func,onValidationError:k.a.func,isAppraisalValuePage:k.a.bool,useUniqId:k.a.bool,isEligibleHardcodeYmmBypass:k.a.bool,setVin:k.a.func,clearVin:k.a.func,onValueChange:k.a.func,setLicensePlateAndStateCode:k.a.func,creativeId:k.a.string,vin:k.a.string,squishVinError:k.a.oneOfType([k.a.string,k.a.node,k.a.func]),vehicle:k.a.shape({make:k.a.shape({name:k.a.string}),model:k.a.shape({name:k.a.string}),year:k.a.shape({})}).isRequired,licensePlate:k.a.string,stateCode:k.a.string},Ta.defaultProps={shouldOpen:!1,isMobile:!1,onClosed:b.a,onCompleteCallback:b.a,onValidationError:b.a,isAppraisalValuePage:!1,useUniqId:!1,isEligibleHardcodeYmmBypass:!1,setVin:b.a,clearVin:b.a,onValueChange:b.a,setLicensePlateAndStateCode:b.a,creativeId:"",squishVinError:null,vin:"",licensePlate:"",stateCode:""};const Ia="Continue with this vehicle";class Na extends A.Component{constructor(){super(...arguments),this.state={isOpen:!1,selectedVin:"",isVinChecking:!1,vinEligibility:null},this.onCompleteVinChecking=(()=>{const e=this.props.vinEligibility;this.setState({isVinChecking:!1,vinEligibility:e})}),this.setIsOpen=(e=>this.setState({isOpen:e})),this.handleSubmit=(async()=>{const e=this.props,t=e.setVinTabActive,a=e.onCompleteCallback,s=e.updateVin,i=e.updateStepsState,n=e.onClosed,r=this.state,l=r.selectedVin,o=r.vinEligibility;o.isEligibleVin?a(l,o):(i("isVinFromDrawer",!0),await s(l),t()),this.setIsOpen(!1),n()}),this.updateStateSelectedVin=(()=>{const e=this.props.selectedVin;this.setState({selectedVin:e,isVinChecking:!0,vinEligibility:null})})}componentDidMount(){this.props.shouldOpen&&this.setIsOpen(!0)}componentDidUpdate(){const e=this.state,t=e.selectedVin,a=e.vinEligibility,s=this.props.vinEligibility;t!==this.props.selectedVin&&this.updateStateSelectedVin(),s&&!m()(s,a)&&this.onCompleteVinChecking()}render(){const e=this.props,t=e.vehicles,a=e.selectedVin,s=e.selectVehicle,i=e.onClosed,n=this.state,r=n.isOpen,l=n.isVinChecking,o=1===t.length,c=1===t.length?pa.SINGLE_VIN:pa.MULTIPLE_VINS;return V.a.createElement(ua.a,{className:"found-vehicles-overlay mx-auto pt-1 pt-md-3_5",contentClassName:"mt-1_5 mt-md-3_5",isOpen:r},V.a.createElement(fa.a,{tag:"div",className:"justify-content-end p-0",onClick:i},V.a.createElement(ot.a,{color:"link",className:"text-decoration-none heading-3 pt-1 pr-1 pb-0"},V.a.createElement("i",{className:"icon-cross2"}))),V.a.createElement(ga.a,{className:"text-left px-2 px-md-2_5 pt-0 pt-lg-1"},V.a.createElement("section",{className:"mx-auto"},V.a.createElement("header",{className:"pos-r text-gray-darker text-left"},V.a.createElement("h4",{className:"size-24"},"Great news!"),V.a.createElement("div",{className:"size-16 pb-1_5"},c))),V.a.createElement("section",{className:"vins-group"},o?V.a.createElement("div",{className:"bg-gray-extra-light p-0_75 rounded find-vin-vehicle d-flex align-items-baseline mx-auto"},V.a.createElement("i",{className:"icon-checkmark text-success mr-0_5"}),V.a.createElement("div",null,V.a.createElement("div",{className:"text-gray-darker font-weight-medium text-capitalize"},t[0].modelYear," ",t[0].make," ",t[0].modelDesc),V.a.createElement("div",{className:"text-gray-darker"},V.a.createElement("span",{className:"font-weight-bold mr-0_25"},"VIN:"),t[0].vin))):t.map(e=>V.a.createElement(ta.a,{key:`${e.vin}-radio`,name:`${e.vin}-radio`,onChange:s,checked:a===e.vin,formGroupClassName:Re()("rounded p-0_75 mb-1 find-vin-vehicle mx-auto",{"active bg-white":a===e.vin,"bg-gray-extra-light":a!==e.vin}),listItem:{title:e.vin,hideValue:!0,text:V.a.createElement("div",null,V.a.createElement("div",{className:"text-gray-darker font-weight-medium text-capitalize"},e.modelYear," ",e.make," ",e.modelDesc),V.a.createElement("div",{className:"text-gray-darker"},V.a.createElement("span",{className:"font-weight-bold mr-0_25"},"VIN:"),e.vin))}}))),V.a.createElement(L.a,{className:"mt-1_5 mb-2 justify-content-center"},V.a.createElement(U.a,{xs:12,md:9},V.a.createElement(ot.a,{className:"w-100 text-transform-none size-16 font-weight-bold",block:!0,color:"success",onClick:this.handleSubmit,disabled:l,"data-tracking-value":Ia},l&&V.a.createElement("span",{className:"pr-0_5"},V.a.createElement(ht.a,{size:14,thickness:1,color:"white"})),Ia)))))}}Na.propTypes={shouldOpen:k.a.bool,onClosed:k.a.func,selectVehicle:k.a.func,onCompleteCallback:k.a.func,setVinTabActive:k.a.func,updateVin:k.a.func,updateStepsState:k.a.func,vehicles:k.a.PropTypes.arrayOf(k.a.shape({vin:k.a.string,modelYear:k.a.string,makeCode:k.a.string,make:k.a.string,modelDesc:k.a.string})).isRequired,selectedVin:k.a.string,vehicle:k.a.shape({make:k.a.shape({name:k.a.string}),model:k.a.shape({name:k.a.string}),year:k.a.shape({})}).isRequired,vinEligibility:kt.a.VinEligibility},Na.defaultProps={shouldOpen:!1,isEligibleHardcodeYmmBypass:!1,onClosed:b.a,selectVehicle:b.a,onCompleteCallback:b.a,setVinTabActive:b.a,updateVin:b.a,updateStepsState:b.a,selectedVin:null,vehicle:{},vehicles:[],vinEligibility:null};const _a={vinEligibility:Object(B.a)(e=>{let t=e.vehicle,a=t.make,s=t.model,i=t.year,n=e.selectedVin;return a&&s&&i?Object(kt.e)({vin:n,make:a.name,model:s.name,year:i.year,isEligibleHardcodeYmmBypass:!1,trackingCreativeId:Z.B}):null},kt.b)},Oa=Object(B.b)(Na,_a);a("./site-modules/shared/components/find-vin-by-address/find-vin-by-address.scss");const Pa={firstName:{test:Xe.a.validateFirstName,errorText:"Please correct your first name. First name cannot be empty."},lastName:{test:Xe.a.validateName,errorText:"Please correct your last name. Last name cannot be empty."},address:{test:Xe.a.validateAddress,errorText:"Please enter a valid street address. Street address cannot be empty."},city:{test:Xe.a.validateCity,errorText:"Please enter a valid city. City cannot be empty."},state:{test:Xe.a.validateValue,errorText:"Please select a state. State cannot be empty."}},Aa={NO_VEHICLE:"no-vehicle",FOUND_VEHICLES:"found-vehicles"};function Va(e){const t=(new Date).toISOString();return{stateCode:e.addressStateCode,isSubmitted:!1,isSubmitting:!1,isSubmittingVin:!1,isZipChangeInProgress:!1,stateCodeError:"",city:e.addressCity,vehicles:null,selectedVin:null,vinStyles:[],quotebackId:j()(`${t}`,Z.v).slice(0,20),overlayType:void 0}}class xa extends A.Component{constructor(){super(...arguments),this.state=Va(this.props),this.onStateCodeChange=(e=>{let t=e.stateCode;this.setState({stateCode:t,stateCodeError:""})}),this.setZipCodeFromPage=(()=>{this.props.setModelValue("location.address",$.c,this.props.location)}),this.setDefaultState=(()=>{this.setState(Va(this.props))}),this.setCity=(e=>this.setState(()=>({city:e}))),this.getVins=(async()=>{const e=this.props,t=e.vehicle,a=e.fields,s=a.firstName,i=a.lastName,n=a.address,r=a.apartment,l=a.city,o=e.addressZipCode,c=this.state,d=c.quotebackId,p=c.stateCode,m={quotebackId:d,firstName:s.value(),surname:i.value(),streetAddress:`${n.value()} ${r.value()}`,city:l.value(),state:p,zipCode:o,make:S()(t,"make.name",""),year:S()(t,"year.year","")};return Object(kt.h)(m)}),this.uniqId=this.props.useUniqId?`-${Object(zt.c)()}`:"",this.noFoundVehicleOverlay=(()=>V.a.createElement(Ta,{shouldOpen:!0,isMobile:this.props.isMobile,onClosed:this.resetState,setVin:this.props.setVin,clearVin:this.props.clearVin,onCompleteCallback:this.props.onCompleteCallback,onValidationError:this.props.onValidationError,isAppraisalValuePage:this.props.isAppraisalValuePage,creativeId:this.props.creativeId,squishVinError:this.props.squishVinError,onValueChange:this.props.onValueChange,useUniqId:this.props.useUniqId,vehicle:this.props.vehicle,isEligibleHardcodeYmmBypass:this.props.isEligibleHardcodeYmmBypass,setLicensePlateAndStateCode:this.props.setLicensePlateAndStateCode,vin:this.props.vin,licensePlate:this.props.licensePlate,stateCode:this.props.lpStateCode})),this.foundVehiclesOverlay=(()=>V.a.createElement(Oa,{shouldOpen:!0,onClosed:this.resetState,vehicles:this.state.vehicles,selectedVin:this.state.selectedVin,selectVehicle:this.selectVehicle,onCompleteCallback:this.props.onCompleteCallback,vehicle:this.props.vehicle,creativeId:this.props.creativeId,setVinTabActive:this.props.setVinTabActive,updateVin:this.props.updateVin,updateStepsState:this.props.updateStepsState})),this.checkVinMismatchError=(()=>{const e=this.props,t=e.vehicle,a=e.updateStepsState,s=e.updateVinAndContinue,i=this.state,n=i.vinStyles,r=i.selectedVin,l=S()(n,"[0]",{}),o=l.makeNiceId,c=l.modelNiceId,p=l.year,m=S()(t,"make.slug",""),u=S()(t,"model.slug",""),h=S()(t,"year.year",""),g=3!==d()([o,m,c,u,`${p}`,h]).length;a("hasVinMismatchError",g),s(r,g),a("isVinFromDrawer",!0),J.a.fireCustomEvent(na,{})}),this.trackFindVinByAddressEvent=((e,t,a)=>J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:X.b.ACTION_RECEIVE_EPO,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:e,creative_id:a,value:t}})),this.handleSubmit=(e=>{e.preventDefault(),e.stopPropagation(),this.setState({isSubmitting:!0},async()=>{const e=this.props,t=e.validate,a=e.vehicle,s=e.creativeId,i=e.toggleVinLpForm,n=e.isLicencePlateAndVinStep,r=e.clearVin,l=this.state.stateCode;n&&r();const o=S()(a,"make.name",""),c=S()(a,"model.name",""),d=S()(a,"year.year","");let p=t();if(Pa.state.test(l)||(this.setState({stateCodeError:Pa.state.errorText}),p=!1),p){this.trackFindVinByAddressEvent(X.b.SUBMIT_ADDRESS_LOOKUP,"Look up my VIN",s),this.trackFindVinByAddressEvent(X.b.CUSTOMER_CONSENT_FOR_ADDRESS_LOOKUP,`quotebackId_${this.state.quotebackId}`,s),this.trackFindVinByAddressEvent(X.b.SUBMIT_ADDRESS_STATE,l,s);const e=(await this.getVins()).vehicles;let t=e.filter(e=>`${e.modelYear} ${e.make} ${e.modelDesc}`.toUpperCase()===`${d} ${o} ${c}`.toUpperCase());if(t.length||(t=e.filter(e=>`${e.modelYear} ${e.make}`.toUpperCase()===`${d} ${o}`.toUpperCase())),e.length?this.trackFindVinByAddressEvent(X.b.ADDRESS_LOOKUP,X.b.VIN_FOUND,s):this.trackFindVinByAddressEvent(X.b.ADDRESS_LOOKUP,X.b.VIN_NOT_FOUND,s),t.length?this.trackFindVinByAddressEvent(X.b.ADDRESS_LOOKUP_DISPLAY_RESULT,X.b.VIN_SHOWN,s):(this.trackFindVinByAddressEvent(X.b.ADDRESS_LOOKUP_DISPLAY_RESULT,X.b.VIN_NOT_SHOWN,s),i()),this.setState(()=>({isSubmitted:!0,isSubmitting:!1,vehicles:t,selectedVin:(t[0]||{}).vin})),n){let e;e=t.length>0?Aa.FOUND_VEHICLES:Aa.NO_VEHICLE,this.setState(()=>({overlayType:e}))}}else this.setState({isSubmitting:!1})})}),this.resetState=(()=>{this.setState(()=>({isSubmitted:!1,isSubmitting:!1,vehicles:null,selectedVin:null,overlayType:void 0}))}),this.inputRef=(e=>{if(e)return this.props.fieldRef(e.props.name,e)}),this.selectVehicle=(e=>{let t=e.target.value;this.setState({selectedVin:t})}),this.continueWithSelectedVehicle=(e=>{e.persist();const t=this.props.creativeId,a=this.state.selectedVin;J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:X.b.ACTION_APPRAISE_VEHICLE,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:X.b.SUBMIT_VIN,creative_id:t,value:"Continue with this vehicle"}}),this.setState(()=>({isSubmittingVin:!0}),async()=>{const e=await Object(te.f)(a);this.setState({vinStyles:e,isSubmittingVin:!1})})}),this.handleZipCodeChangeProgress=(e=>{this.setState({isZipChangeInProgress:e.isZipChangeInProgress})}),this.renderHeader=(e=>V.a.createElement("header",{className:Re()("mb-1 pos-r text-gray-darker",{"mt-1_5":!e})},!e&&V.a.createElement("h4",{className:"size-24"},"Don't have your VIN or License Plate?"),V.a.createElement("div",{className:Re()({"desc-eval3463-chal2 size-14 p-1":e})},"We can help you look up your VIN by using your address. This will only be used to look up your VIN, nothing else."))),this.renderFirstNameField=((e,t,a)=>{const s=this.props.fields.firstName;let i;return a&&s&&(i=s.value()),V.a.createElement("div",null,V.a.createElement(Kt.a,{id:`first-name${this.uniqId}`,maxLength:255,defaultValue:i,name:"firstName",type:"text",label:"First Name",labelClassName:"small mb-0_5",inputClassName:Re()({"size-16":e||a,"data-input-eval3463-chal2":a}),ref:this.inputRef,isValid:!t,placeholder:a?"Enter first name":"",required:!0,onBlur:this.props.validate,onChange:this.props.validate}),V.a.createElement(Yt.a,{id:`first-name-error${this.uniqId}`,error:t,classes:"mb-1"}))}),this.renderLastNameField=((e,t,a)=>V.a.createElement("div",null,V.a.createElement(Kt.a,{id:`last-name${this.uniqId}`,maxLength:255,name:"lastName",type:"text",label:"Last Name",labelClassName:"small mb-0_5",inputClassName:Re()({"size-16":e||a,"data-input-eval3463-chal2":a}),ref:this.inputRef,isValid:!t,placeholder:a?"Enter last name":"",required:!0,onBlur:this.props.validate,onChange:this.props.validate}),V.a.createElement(Yt.a,{id:`last-name-error${this.uniqId}`,error:t,classes:"mb-1"}))),this.renderAddressField=((e,t,a)=>V.a.createElement("div",null,V.a.createElement(Kt.a,{id:`address${this.uniqId}`,maxLength:255,name:"address",type:"text",label:"Street address",labelClassName:"small mb-0_5",inputClassName:Re()({"size-16":e||a,"data-input-eval3463-chal2":a}),ref:this.inputRef,isValid:!t,placeholder:"Enter street address",required:!0,onBlur:this.props.validate,onChange:this.props.validate}),V.a.createElement(Yt.a,{id:`address-error${this.uniqId}`,error:t,classes:"mb-1"}))),this.renderApartmentField=((e,t,a)=>V.a.createElement(Kt.a,{id:`apartment${this.uniqId}`,maxLength:255,name:"apartment",type:"text",label:"Apartment, suite, etc.",labelClassName:"small mb-0_5",inputClassName:Re()({"size-16":e||a,"data-input-eval3463-chal2":a}),ref:this.inputRef,isValid:!t,placeholder:"Enter apartment, suite, etc.",isOptional:!0})),this.renderCityField=((e,t,a,s)=>V.a.createElement("div",null,V.a.createElement(Kt.a,{id:`city${this.uniqId}`,maxLength:255,defaultValue:e,name:"city",type:"text",label:"City",labelClassName:"small mb-0_5",inputClassName:Re()({"size-16":t||s,"data-input-eval3463-chal2":s}),ref:this.inputRef,isValid:!a,placeholder:s?"Enter city":"",required:!0,onBlur:this.props.validate,onChange:this.props.validate}),V.a.createElement(Yt.a,{id:`city-error${this.uniqId}`,error:a,classes:"mb-1"}))),this.renderStateField=((e,t,a)=>V.a.createElement(Dt.a,{className:Re()({"has-danger":a})},V.a.createElement(Xt.a,{name:"state",labelText:"State",labelClassName:"small mb-0_5",toggle:"Select State",labelKey:"stateCode",valueKey:"stateCode",options:t,value:e,onChange:this.onStateCodeChange}),V.a.createElement(Yt.a,{id:`state-code-error${this.uniqId}`,error:a,classes:"mt-0_5"}))),this.renderZipField=((e,t)=>V.a.createElement(ea.a,{label:"Zip",onValidate:Xe.a.validateZip,labelClasses:"small mb-0_5",inputClasses:Re()({"size-16":e||t,"data-input-eval3463-chal2":t}),inputSize:"md",isAddressZip:!0,onZipChangeInProgress:this.handleZipCodeChangeProgress})),this.renderCityStateZipFields=(()=>{const e=this.props,t=e.stateCodes,a=e.validationErrors,s=e.isMobile,i=e.isLicencePlateAndVinStep,n=a.city,r=this.state,l=r.stateCode,o=r.stateCodeError,c=r.city;return V.a.createElement("div",null,V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,lg:6},this.renderCityField(c,s,n,i)),V.a.createElement(U.a,{xs:6,lg:3},this.renderStateField(l,t,o)),V.a.createElement(U.a,{xs:6,lg:3},this.renderZipField(s,i))))})}componentDidUpdate(e,t){const a=this.props,s=a.addressStateCode,i=a.resetAddressForm,n=a.setVinFromDrawerSquishStyles,r=a.addressCity,l=this.state,o=l.vinStyles,c=l.city;m()(i,e.resetAddressForm)||this.setDefaultState(),m()(this.props.zipCode,e.zipCode)||this.setZipCodeFromPage(),s&&e.addressStateCode!==s&&this.onStateCodeChange({stateCode:s}),i||m()(t.vinStyles,o)||(n(o),this.checkVinMismatchError()),r&&r!==c&&this.setCity(r)}render(){const e=this.props,t=e.stateCodes,a=e.validationErrors,s=e.isMobile,i=e.vehicle,n=e.creativeId,r=e.handleAppraisalOnClick,l=e.isLicencePlateAndVinStep,o=e.isEval3622Chal1Enabled,c=e.isOptimizedTraffic,d=a.firstName,p=a.lastName,m=a.address,u=a.apartment,h=a.city,g=this.state,b=g.stateCode,f=g.stateCodeError,E=g.city,v=g.isSubmitting,y=g.isSubmitted,C=g.vehicles,T=g.selectedVin,I=g.isSubmittingVin,N=g.isZipChangeInProgress,_=g.overlayType,O=S()(i,"make.name",""),P=S()(i,"model.name","");let x;return C&&(x=C.length>1?pa.MULTIPLE_VINS:pa.SINGLE_VIN),V.a.createElement("div",{className:"find-vin-by-address","data-tracking-parent":n},!y||l?V.a.createElement(A.Fragment,null,this.renderHeader(l),V.a.createElement(L.a,{className:Re()({"mt-1_5":!l})},V.a.createElement(U.a,{xs:12},V.a.createElement(mt.a,{noValidate:!0,onSubmit:this.handleSubmit},V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,lg:6},this.renderFirstNameField(s,d,l)),V.a.createElement(U.a,{xs:12,lg:6},this.renderLastNameField(s,p,l))),this.renderAddressField(s,m,l),this.renderApartmentField(s,u,l),!l&&V.a.createElement("div",null,this.renderCityField(E,s,h,l),V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:6},this.renderStateField(b,t,f)),V.a.createElement(U.a,{xs:6},this.renderZipField(s)))),l&&this.renderCityStateZipFields(),!l&&V.a.createElement(L.a,{className:"mt-0_5 align-items-center"},V.a.createElement(U.a,{xs:12,md:7,lg:6,xl:7},V.a.createElement(ot.a,{type:"submit",color:"success",className:"w-100 text-transform-none size-16 text-white",disabled:N},v&&V.a.createElement("span",{className:"pr-0_5"},V.a.createElement(ht.a,{size:14,thickness:1,color:"white"})),V.a.createElement("span",{className:"size-16"},"Look up my VIN")))),l&&V.a.createElement(L.a,{className:"mt-0_5 align-items-center"},V.a.createElement(U.a,{xs:12,md:6,lg:6,xl:5},V.a.createElement(ot.a,{type:"submit",color:"success",className:"w-100 text-transform-none size-16 text-white",disabled:N||v},v&&V.a.createElement("span",{className:"pr-0_5"},V.a.createElement(ht.a,{size:14,thickness:1,color:"white"})),V.a.createElement("span",{className:"size-16"},"Look up my VIN"))),!c&&V.a.createElement(U.a,{xs:12,md:6,lg:6,xl:7},V.a.createElement("div",{className:"text-center text-md-left mt-1 mt-md-0"},V.a.createElement(ot.a,{color:"link",className:"text-primary-darker text-transform-none p-0",onClick:r,"data-index":Z.x,"data-tracking-id":"view_appraisal"},V.a.createElement("span",{className:"size-16 font-weight-normal"},aa.APPRAISE)))))),!l&&!o&&V.a.createElement("div",{className:"text-center text-md-left"},V.a.createElement(ot.a,{color:"link",className:"text-primary-darker text-transform-none p-0 mt-1_5",onClick:r,"data-index":Z.x,"data-tracking-id":"view_appraisal"},V.a.createElement("span",{className:"size-14 font-weight-normal"},aa.APPRAISE))))),V.a.createElement("div",{className:"size-10 mt-2"},"By clicking Look up my VIN, I authorize and direct Edmunds to use my information to look up the Vehicle Identification Number (VIN) of the ",O," ",P," associated with my address."),l&&_===Aa.NO_VEHICLE&&this.noFoundVehicleOverlay(),l&&_===Aa.FOUND_VEHICLES&&this.foundVehiclesOverlay()):V.a.createElement(A.Fragment,null,C&&C.length?V.a.createElement(A.Fragment,null,V.a.createElement("header",{className:"mt-1_5 mb-1 pos-r text-gray-darker"},V.a.createElement("h4",{className:"size-24"},"Great news!"),V.a.createElement("div",null,x)),C.length>1&&C.map(e=>V.a.createElement(ta.a,{key:`${e.vin}-radio`,name:`${e.vin}-radio`,onChange:this.selectVehicle,checked:T===e.vin,formGroupClassName:Re()("rounded p-0_75 mb-1 find-vin-vehicle",{"active bg-white":T===e.vin,"bg-gray-extra-light":T!==e.vin}),listItem:{title:e.vin,hideValue:!0,text:V.a.createElement("div",null,V.a.createElement("div",{className:"text-gray-darker font-weight-medium text-capitalize"},e.modelYear," ",e.make," ",e.modelDesc),V.a.createElement("div",{className:"text-gray-darker"},V.a.createElement("span",{className:"font-weight-bold mr-0_25"},"VIN:"),e.vin))}})),1===C.length&&V.a.createElement("div",{className:"bg-gray-extra-light p-0_75 rounded find-vin-vehicle d-flex align-items-baseline"},V.a.createElement("i",{className:"icon-checkmark text-success mr-0_5"}),V.a.createElement("div",null,V.a.createElement("div",{className:"text-gray-darker font-weight-medium text-capitalize"},C[0].modelYear," ",C[0].make," ",C[0].modelDesc),V.a.createElement("div",{className:"text-gray-darker"},V.a.createElement("span",{className:"font-weight-bold mr-0_25"},"VIN:"),C[0].vin))),V.a.createElement(ot.a,{color:"success",className:"mt-1_5 py-0_5 text-transform-none","data-index":Z.x,onClick:this.continueWithSelectedVehicle,disabled:!T},I&&V.a.createElement("span",{className:"pr-0_5"},V.a.createElement(ht.a,{size:14,thickness:1,color:"white"})),V.a.createElement("span",{className:"size-16 font-weight-bold"},"Continue with this vehicle"))):V.a.createElement(A.Fragment,null,V.a.createElement("header",{className:"mt-2 mb-2 pos-r text-gray-darker text-center"},V.a.createElement("img",{className:"d-inline-block mx-auto mb-1",src:da.a,alt:"no vin found"}),V.a.createElement("h4",{className:"size-20"},"Unfortunately, we can't find your VIN at this time.")))))}}xa.propTypes={fieldRef:k.a.func.isRequired,validate:k.a.func.isRequired,setVinFromDrawerSquishStyles:k.a.func.isRequired,handleAppraisalOnClick:k.a.func.isRequired,updateVinAndContinue:k.a.func.isRequired,toggleVinLpForm:k.a.func,updateStepsState:k.a.func.isRequired,vin:k.a.string,addressStateCode:k.a.string,creativeId:k.a.string,addressZipCode:k.a.string,addressCity:k.a.string,zipCode:k.a.string,isMobile:k.a.bool,stateCodes:wt.a.States,validationErrors:k.a.objectOf(k.a.string),fields:k.a.shape({firstName:k.a.shape({value:k.a.func}),lastName:k.a.shape({value:k.a.func}),address:k.a.shape({value:k.a.func}),apartment:k.a.shape({value:k.a.func}),city:k.a.shape({value:k.a.func})}),vehicle:k.a.shape({make:k.a.shape({name:k.a.string}),model:k.a.shape({name:k.a.string}),year:k.a.shape({})}).isRequired,resetAddressForm:k.a.bool,isLicencePlateAndVinStep:k.a.bool,setModelValue:k.a.func.isRequired,location:k.a.shape({}),isEval3622Chal1Enabled:k.a.bool,setVin:k.a.func,clearVin:k.a.func,setVinTabActive:k.a.func,onCompleteCallback:k.a.func,onValidationError:k.a.func,onValueChange:k.a.func,setLicensePlateAndStateCode:k.a.func,updateVin:k.a.func,isAppraisalValuePage:k.a.bool,useUniqId:k.a.bool,isEligibleHardcodeYmmBypass:k.a.bool,isOptimizedTraffic:k.a.bool,squishVinError:k.a.oneOfType([k.a.string,k.a.node,k.a.func]),licensePlate:k.a.string,lpStateCode:k.a.string},xa.defaultProps={vin:"",className:"",creativeId:void 0,addressStateCode:"",addressZipCode:"",addressCity:"",zipCode:"",vehicle:{},isLicensePlate:!1,resetAddressForm:!1,isMobile:!1,stateCodes:[],validationErrors:{},fields:{},location:{},isEval3622Chal1Enabled:!1,isLicencePlateAndVinStep:!1,toggleVinLpForm:b.a,setVin:b.a,clearVin:b.a,setVinTabActive:b.a,onCompleteCallback:b.a,onValidationError:b.a,onValueChange:b.a,setLicensePlateAndStateCode:b.a,updateVin:b.a,isAppraisalValuePage:!1,useUniqId:!1,isEligibleHardcodeYmmBypass:!1,isOptimizedTraffic:!1,squishVinError:null,licensePlate:"",lpStateCode:""};const ka={stateCodes:Object(B.a)("allStateCodes",wt.b),addressCity:Object(B.a)("location.address.city",$.c),addressStateCode:Object(B.a)("location.address.stateCode",$.c),addressZipCode:Object(B.a)("location.address.zipCode",$.c),zipCode:Object(B.a)("location.zipCode",$.c),location:Object(B.a)("location",$.c)},wa=Object(Jt.a)(Object(B.b)(xa,ka),Pa);class Ra extends A.Component{render(){const e=this.props,t=e.vehicle,a=e.creativeId,s=e.updateStepsState,i=e.isLicencePlateAndVinStep,n=e.setVin,r=e.clearVin,l=e.onCompleteCallback,o=e.onValidationError,c=e.isAppraisalValuePage,d=e.isMobile,p=e.squishVinError,m=e.onValueChange,u=e.useUniqId,h=e.isEligibleHardcodeYmmBypass,g=e.setLicensePlateAndStateCode,f=e.vin,E=e.licensePlate,v=e.stateCode,y=e.setVinTabActive,C=e.updateVin,S=e.changeStep,T=e.isOptimizedTraffic;return V.a.createElement(Zt.a,null,V.a.createElement(wa,{updateStepsState:s,creativeId:a,vehicle:t,handleAppraisalOnClick:S,updateVinAndContinue:b.a,setVinFromDrawerSquishStyles:b.a,isLicencePlateAndVinStep:i,setVin:n,clearVin:r,onCompleteCallback:l,onValidationError:o,isAppraisalValuePage:c,isMobile:d,squishVinError:p,onValueChange:m,useUniqId:u,isEligibleHardcodeYmmBypass:h,setLicensePlateAndStateCode:g,vin:f,licensePlate:E,lpStateCode:v,setVinTabActive:y,updateVin:C,isOptimizedTraffic:T}))}}Ra.propTypes={vehicle:k.a.shape({make:k.a.shape({name:k.a.string}),model:k.a.shape({name:k.a.string}),year:k.a.shape({year:k.a.string}),style:k.a.shape({id:k.a.number})}).isRequired,changeStep:k.a.func.isRequired,setVin:k.a.func.isRequired,clearVin:k.a.func.isRequired,onCompleteCallback:k.a.func.isRequired,setVinTabActive:k.a.func.isRequired,onValidationError:k.a.func.isRequired,vin:k.a.string,creativeId:k.a.string,squishVinError:k.a.oneOfType([k.a.string,k.a.node,k.a.func]),onValueChange:k.a.func,useUniqId:k.a.bool,isMobile:k.a.bool,updateStepsState:k.a.func,updateVin:k.a.func,setLicensePlateAndStateCode:k.a.func.isRequired,isLicencePlateAndVinStep:k.a.bool,isAppraisalValuePage:k.a.bool,isEligibleHardcodeYmmBypass:k.a.bool,isOptimizedTraffic:k.a.bool,licensePlate:k.a.string,stateCode:k.a.string},Ra.defaultProps={vin:"",creativeId:Z.B,squishVinError:null,onValueChange:b.a,useUniqId:!0,isMobile:!1,updateStepsState:b.a,updateVin:b.a,isLicencePlateAndVinStep:!1,isAppraisalValuePage:!1,isEligibleHardcodeYmmBypass:!1,isOptimizedTraffic:!1,licensePlate:"",stateCode:""};const Ma={ADDRESS:"ADDRESS",LICENSE_PLATE:"LICENSE_PLATE",VIN:"VIN"},ja={SQUISH_VIN:"SQUISH_VIN",VIN_ELIGIBILITY:"VIN_ELIGIBILITY"},Da={stateCodes:Object(B.a)("allStateCodes",wt.b),vinEligibility:Object(B.a)(e=>{let t=e.vehicle,a=t.make,s=t.model,i=t.year,n=e.vin,r=e.isEligibleHardcodeYmmBypass,l=e.creativeId;return e.isStepActive&&a&&s&&i?Object(kt.e)({vin:n,make:a.name,model:s.name,year:i.year,isEligibleHardcodeYmmBypass:r,trackingCreativeId:l}):null},kt.b),vinFromLicensePlate:Object(B.a)(e=>{let t=e.licensePlate,a=e.stateCode;return Object(kt.c)({licensePlate:t,stateCode:a})},kt.b),squishVins:Object(B.a)(e=>{let t=e.vehicle.style;return y()(t)?"":`styles["${t.id}"].squishVin`},Rt.d)},La=Object(q.c)(e=>({licensePlateLookupError:Object(kt.g)(e)}))(Object(B.b)(Mt.a,Da)),Fa=Object(B.b)(Qt,Da),Ua={[Ma.LICENSE_PLATE]:La,[Ma.VIN]:Fa,[Ma.ADDRESS]:Ra};class qa extends A.PureComponent{constructor(){super(...arguments),this.state={vin:"",licensePlate:"",stateCode:""},this.onValidationError=(()=>this.props.triggerEpoVinError()),this.setVin=(e=>this.setState({vin:e})),this.setLicensePlateAndStateCode=(e=>{let t=e.licensePlate,a=e.stateCode;this.setState({licensePlate:t,stateCode:a})}),this.clearVin=(()=>this.setState({vin:"",licensePlate:null,stateCode:null},()=>{this.props.clearVin()}))}componentDidUpdate(e){const t=this.props,a=t.isVinFromDrawer,s=t.vin,i=t.queryVin;e.vin||m()(e.vin,s)||!a&&!i||this.setVin(s)}render(){const e=this.props,t=e.tabId,a=e.isMobile,s=e.creativeId,i=e.vehicle,n=e.tabContentModal,r=e.errors,l=e.queryVin,o=e.setVinTabActive,c=e.onValueChange,d=e.ctaText,p=e.useUniqId,m=e.vinTabLink,u=e.isSecondary,h=e.isEligibleHardcodeYmmBypass,g=e.isStepActive,b=e.isEscapeHatch,f=e.isVinFromDrawer,E=e.forceError,v=e.isEscapeHatchDrawer,y=e.isLocationStyleStep,C=e.isFullWidth,S=e.hideVinLicensePlateBtn,T=e.isEval3463Chal1Enabled,I=e.isEval3622Chal1Enabled,N=e.updateStepsState,_=e.isAllowedToPredefineVin,O=e.isLicencePlateAndVinStep,P=e.changeStep,A=e.updateVin,x=e.isOptimizedTraffic,k=this.state,w=k.licensePlate,R=k.stateCode,M=Ua[t],j=r.get(`${t}_${ja.SQUISH_VIN}`);return V.a.createElement(M,{isAppraisalValuePage:!0,vin:this.state.vin,setVin:this.setVin,clearVin:this.clearVin,vehicle:i,onCompleteCallback:this.props.onCompleteCallback,isMobile:a,creativeId:s,tabContentModal:n,squishVinError:j,onValidationError:this.onValidationError,onValueChange:c,useUniqId:p,isSecondary:u,isEligibleHardcodeYmmBypass:h,isEscapeHatch:b,initialStateCode:b?"CA":void 0,queryVin:l,setVinTabActive:o,ctaText:d,isStepActive:g,isVinFromDrawer:f,setLicensePlateAndStateCode:this.setLicensePlateAndStateCode,licensePlate:w,stateCode:R,vinTabLink:m,forceError:E,isEscapeHatchDrawer:v,isLocationStyleStep:y,isFullWidth:C,hideVinLicensePlateBtn:S,isEval3463Chal1Enabled:T,isEval3622Chal1Enabled:I,updateStepsState:N,isAllowedToPredefineVin:_,isLicencePlateAndVinStep:O,changeStep:P,updateVin:A,isOptimizedTraffic:x})}}qa.propTypes={tabId:k.a.string.isRequired,vehicle:k.a.shape({make:k.a.shape({name:k.a.string}),model:k.a.shape({name:k.a.string}),year:k.a.shape({year:k.a.string}),style:k.a.shape({id:k.a.number})}).isRequired,onCompleteCallback:k.a.func.isRequired,clearVin:k.a.func.isRequired,triggerEpoVinError:k.a.func.isRequired,isMobile:k.a.bool,creativeId:k.a.string,tabContentModal:k.a.oneOfType([k.a.func,k.a.node]),errors:k.a.oneOfType([k.a.func,k.a.node]),queryVin:k.a.string,setVinTabActive:k.a.func,onValueChange:k.a.func,ctaText:k.a.string,vin:k.a.string,useUniqId:k.a.bool,vinTabLink:k.a.oneOfType([k.a.node,k.a.func]),isSecondary:k.a.bool,isEligibleHardcodeYmmBypass:k.a.bool,isStepActive:k.a.bool,isEscapeHatch:k.a.bool,isVinFromDrawer:k.a.bool,forceError:k.a.bool,isEscapeHatchDrawer:k.a.bool,isLocationStyleStep:k.a.bool,isFullWidth:k.a.bool,hideVinLicensePlateBtn:k.a.bool,isEval3463Chal1Enabled:k.a.bool,isEval3622Chal1Enabled:k.a.bool,isAllowedToPredefineVin:k.a.bool,updateStepsState:k.a.func,isLicencePlateAndVinStep:k.a.bool,isOptimizedTraffic:k.a.bool,changeStep:k.a.func,updateVin:k.a.func},qa.defaultProps={isMobile:!1,creativeId:null,tabContentModal:null,errors:new Map,queryVin:"",vin:"",setVinTabActive:null,onValueChange:void 0,ctaText:"Continue",useUniqId:!0,vinTabLink:null,isSecondary:!1,isEligibleHardcodeYmmBypass:!1,isStepActive:!1,isEscapeHatch:!1,isVinFromDrawer:!1,forceError:!1,isEscapeHatchDrawer:!1,isLocationStyleStep:!1,isFullWidth:!1,hideVinLicensePlateBtn:!1,isEval3463Chal1Enabled:!1,isEval3622Chal1Enabled:!1,isAllowedToPredefineVin:!0,updateStepsState:b.a,isLicencePlateAndVinStep:!1,isOptimizedTraffic:!1,changeStep:b.a,updateVin:b.a};var za=a("./site-modules/shared/utils/appraisal/check-vin-inventory.js"),Ba=a("./site-modules/shared/components/link/link.jsx"),$a=a("./site-modules/shared/utils/appraisal-link-constructor.js"),Ya=a("./site-modules/shared/constants/appraisal/paths.js");const Ha={LICENSE_PLATE:{id:Ma.LICENSE_PLATE,label:"License Plate"},VIN:{id:Ma.VIN,label:"VIN"},ADDRESS_EVAL3463:{id:Ma.ADDRESS,label:"Find My VIN"}},Za={LICENSE_PLATE_TAB_FIRST:[Ha.LICENSE_PLATE,Ha.VIN],VIN_TAB_FIRST:[Ha.VIN,Ha.LICENSE_PLATE],LICENSE_PLATE_TAB_FIRST_EVAL3463:[Ha.LICENSE_PLATE,Ha.VIN,Ha.ADDRESS_EVAL3463],VIN_TAB_FIRST_EVAL3463:[Ha.VIN,Ha.LICENSE_PLATE,Ha.ADDRESS_EVAL3463]},Ga=(e,t)=>!!e||!t,Wa=(e,t,a,s)=>a&&s?Ga(e,t)?Za.VIN_TAB_FIRST_EVAL3463:Za.LICENSE_PLATE_TAB_FIRST_EVAL3463:Ga(e,t)?Za.VIN_TAB_FIRST:Za.LICENSE_PLATE_TAB_FIRST;class Qa extends A.Component{constructor(e){var t;t=super(e),this.setActiveStepSquishVinInvalidation=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0;const i=t.props.activeTabId;t.setState(n=>{let r=n.errorMap;if(e.length>=1){const n=t.generateSquishVinErrorMessage(s||i,e,a),l=n.id,o=n.message;r.set(l,o)}else t.setMismatchError(s||i);return{errorMap:r}})},this.setMismatchError=(e=>{const t=this.getVehicleMMY(),a=t.makeName,s=t.modelName,i=t.year,n=this.state.errorMap,r=e===Ma.VIN?"VIN":"license plate",l=`${e}_${ja.SQUISH_VIN}`;n.set(l,V.a.createElement(A.Fragment,null,"The ",r," provided does not belong to a ",i," ",a," ",s,". Click"," ",V.a.createElement(Ba.a,{className:"text-primary-darker text-decoration-underline",to:Ya.b.APPRAISAL_LANDING,"data-tracking-id":"correct_squish_vin_secondary"},"here")," ","to correct your vehicle information and re-appraise your car. ",V.a.createElement(Gt.a,null)))}),this.getVehicleMMY=(()=>{const e=this.props.vehicle;return{makeName:S()(e,"make.name",""),modelName:S()(e,"model.name",""),year:S()(e,"year.year","")}}),this.getCtaText=(()=>{const e=this.props,t=e.isEscapeHatch,a=e.isEscapeHatchDrawer,s=e.isLocationStyleStep;return t?"VIEW OFFER NOW":a?"Get My Offer":s?"Continue":"See Your Car's Value"}),this.generateSquishVinErrorMessage=((e,t,a)=>{const s=this.getVehicleMMY(),i=s.makeName,n=s.modelName,r=s.year,l=t[0],o=l.makeName,c=l.modelName,d=l.makeNiceId,p=l.modelNiceId,m=l.year,u=e===Ma.VIN?"VIN":"license plate";return{id:`${e}_${ja.SQUISH_VIN}`,message:V.a.createElement(A.Fragment,null,"You're appraising a ",r," ",i," ",n," but it looks like this ",u," is associated to a ",m," ",o," ",c,". Click"," ",V.a.createElement(Ba.a,{className:"text-primary-darker text-decoration-underline",to:Object($a.b)({make:d,model:p,year:m,queryParams:{vin:a}}),"data-tracking-id":"correct_squish_vin"},"here")," ","to appraise that vehicle instead. ",V.a.createElement(Gt.a,null))}}),this.updateTabs=(()=>{const e=this.props,t=e.queryVin,a=e.isMobile;this.setState({tabs:Ga(t,a)?Za.VIN_TAB_FIRST:Za.LICENSE_PLATE_TAB_FIRST})}),this.updateVinMismatchForceError=((e,t)=>{this.setState(a=>{let s=a.errorMap;return e?(this.fireSquishVinTracking({isSquishVinValid:!e,squishStyles:t},this.props.vin),this.setActiveStepSquishVinInvalidation(t,this.props.vin,Ma.VIN)):this.clearMismatchError(Ma.VIN),{errorMap:s,forceError:e}})}),this.clearMismatchError=(e=>{const t=this.state.errorMap,a=`${e}_${ja.SQUISH_VIN}`;t.has(a)&&t.delete(a)}),this.triggerEpoVinError=(()=>{const e=new Map;return e.set(le.d,"Invalid VIN"),this.props.updateErrorMapAndScrollToInvalid(e)}),this.clearActiveStepValidations=(()=>this.setState(e=>{let t=e.errorMap;const a=this.props.activeTabId,s=`${a}_${ja.VIN_ELIGIBILITY}`;return this.clearMismatchError(a),t.has(s)&&t.delete(s),{errorMap:t}},this.triggerEpoVinError)),this.handleVin=((e,t)=>{const a=this.props,s=a.onPartnerOfferVinEligibilityUpdate,i=a.updateVinAndContinue,n=a.onActiveInventoryCheck,r=a.creativeId,l=a.trackVinEntry,o=a.updateStepsState,c=a.isLocationStyleStep,d=t.isEligibleVin,p=t.isSquishVinValid,m=t.squishStyles;this.clearActiveStepValidations(),this.fireSquishVinTracking(t,e),!p||y()(m)&&c?this.setActiveStepSquishVinInvalidation(m,e):(l(e,r),s(d),Object(za.a)(e,r,n),i(e),o("isVinFromDrawer",!0),J.a.fireCustomEvent(na,{}))}),this.fireSquishVinTracking=((e,t)=>{let a=e.isSquishVinValid,s=e.squishStyles;const n={event_type:X.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:X.b.ACTION_APPRAISE_VEHICLE,subaction_name:X.b.SUBACTION_SQUISHVIN_DECODE,action_category:X.b.SYSTEM_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_USER_INPUT,creative_id:this.props.creativeId,value:X.b.MMY_NOT_FOUND}};s.length&&(J.a.fireTrackAction(Object(i.a)({},n,{event_data:Object(i.a)({},n.event_data,{value:s.length>1?X.b.MMY_MANY_FOUND:X.b.MMY_ONE_FOUND})})),n.event_data.value=a?X.b.MMY_MATCH:X.b.MMY_MISMATCH,n.event_data.subaction_name=X.b.SUBACTION_SQUISHVIN_VALIDATION),J.a.fireTrackAction(n),[X.b.MMY_NOT_FOUND,X.b.MMY_MISMATCH].includes(n.event_data.value)&&J.a.fireTrackAction(Object(i.a)({},n,{event_data:Object(i.a)({},n.event_data,{subaction_name:X.b.SUBACTION_VIN_ERROR,value:`${t}_${n.event_data.subaction_name}_${n.event_data.value}`})}))}),this.updateVin=(async e=>{await this.props.updateVinAndContinue(e,!0)}),this.state={tabs:Wa(e.queryVin,e.isMobile,e.isEval3463Chal2Enabled,e.isLicencePlateAndVinStep),errorMap:new Map,forceError:!1}}componentDidUpdate(e){const t=this.props,a=t.isVinFromDrawer,s=t.hasVinMismatchError,i=t.vinFromDrawerSquishStyles,n=t.trackVinEntry,r=t.vin,l=t.queryVin,o=t.vehicle;a&&r&&!m()(a,e.isVinFromDrawer)&&(this.props.setVinTabActive(),i.length&&!s&&n(r,Z.K)),m()(s,e.hasVinMismatchError)&&(!s||m()(i,e.vinFromDrawerSquishStyles))&&pe(e.vehicle,o)||this.updateVinMismatchForceError(s,i),l&&!m()(e.queryVin,l)&&this.updateTabs()}render(){const e=this.props,t=e.onValueChange,a=e.isMobile,s=e.vehicle,i=e.queryVin,n=e.clearVin,r=e.isPartnerOfferEligibleVin,l=e.creativeId,o=e.vin,c=e.isEscapeHatch,d=e.isSecondary,p=e.isEligibleHardcodeYmmBypass,m=e.isStepActive,u=e.isVinFromDrawer,h=e.isEscapeHatchDrawer,g=e.activeTabId,b=e.tabContentModal,f=e.setVinTabActive,E=e.setActiveTab,v=e.vinTabLink,y=e.isFullWidth,C=e.isLocationStyleStep,S=e.hideVinLicensePlateBtn,T=e.isLicencePlateAndVinStep,I=e.isEval3463Chal1Enabled,N=e.isEval3622Chal1Enabled,_=e.updateStepsState,O=e.isAllowedToPredefineVin,P=e.changeStep,x=e.isOptimizedTraffic,k=this.state,w=k.errorMap,R=k.forceError,M=k.tabs,j=!(i||c||u||h||C);return V.a.createElement(A.Fragment,null,j&&V.a.createElement("div",{className:"epo-license-plate-and-vin-tab-buttons d-flex mb-1"},V.a.createElement("span",{className:"medium text-gray-darker font-weight-bold d-inline-block pb-0_5 mr-0_5"},"Enter by:"),V.a.createElement(It.a,{size:"md",role:"tablist"},M.map((e,t)=>{let a=e.id,s=e.label;return V.a.createElement(Nt.a,{key:a,label:s,tabId:a,isActive:a===g,onBtnClick:E,isFirstItem:0===t,isAppraisalValuePage:!0,isEscapeHatch:c})}))),V.a.createElement(Pt.a,{activeTab:g,className:"epo-license-plate-and-vin-tab-content"},M.map(e=>{let g=e.id;return V.a.createElement(Vt.a,{tabId:g,key:`tab-${g}`,"data-test":`tab-${g}`},V.a.createElement(xt.a,null,V.a.createElement(qa,{tabId:g,isMobile:a,vehicle:s,creativeId:l,onCompleteCallback:this.handleVin,clearVin:n,tabContentModal:b(g),isPartnerOfferEligibleVin:r,errors:w,forceError:R,triggerEpoVinError:this.triggerEpoVinError,onValueChange:t,useUniqId:!T||d||h,isSecondary:d,isEligibleHardcodeYmmBypass:p,isEscapeHatch:c,queryVin:i,vin:o,setVinTabActive:f,ctaText:this.getCtaText(),isStepActive:m,isVinFromDrawer:u,isEscapeHatchDrawer:h,isLocationStyleStep:C,vinTabLink:v,isFullWidth:y,hideVinLicensePlateBtn:S,isEval3463Chal1Enabled:I,isEval3622Chal1Enabled:N,updateStepsState:_,isAllowedToPredefineVin:O,isLicencePlateAndVinStep:T,changeStep:P,updateVin:this.updateVin,isOptimizedTraffic:x})))})))}}Qa.propTypes={vehicle:k.a.shape({make:k.a.shape({name:k.a.string}),model:k.a.shape({name:k.a.string}),year:k.a.shape({year:k.a.string})}).isRequired,changeStep:k.a.func,clearVin:k.a.func.isRequired,updateErrorMapAndScrollToInvalid:k.a.func.isRequired,onPartnerOfferVinEligibilityUpdate:k.a.func.isRequired,onActiveInventoryCheck:k.a.func.isRequired,updateVinAndContinue:k.a.func.isRequired,isMobile:k.a.bool,creativeId:k.a.string,onValueChange:k.a.func,isStepActive:k.a.bool,isSecondary:k.a.bool,isEligibleHardcodeYmmBypass:k.a.bool,queryVin:k.a.string,vin:k.a.string,isPartnerOfferEligibleVin:k.a.bool,isEscapeHatch:k.a.bool,isVinFromDrawer:k.a.bool,activeTabId:k.a.string,tabContentModal:k.a.func,updateStepsState:k.a.func,trackVinEntry:k.a.func,setVinTabActive:k.a.func,setActiveTab:k.a.func,vinTabLink:k.a.node,isEscapeHatchDrawer:k.a.bool,isLocationStyleStep:k.a.bool,isLicencePlateAndVinStep:k.a.bool,isFullWidth:k.a.bool,hasVinMismatchError:k.a.bool,hideVinLicensePlateBtn:k.a.bool,isEval3463Chal1Enabled:k.a.bool,isEval3622Chal1Enabled:k.a.bool,isEval3463Chal2Enabled:k.a.bool,isAllowedToPredefineVin:k.a.bool,isOptimizedTraffic:k.a.bool,vinFromDrawerSquishStyles:k.a.arrayOf(k.a.shape({}))},Qa.defaultProps={isMobile:!1,isEligibleHardcodeYmmBypass:!1,queryVin:"",vin:"",updateStepsState:b.a,trackVinEntry:b.a,isPartnerOfferEligibleVin:!1,creativeId:Z.B,onValueChange:void 0,isStepActive:!1,isSecondary:!1,isEscapeHatch:!1,isVinFromDrawer:!1,hasVinMismatchError:!1,activeTabId:"",tabContentModal:b.a,setVinTabActive:b.a,setActiveTab:b.a,vinTabLink:null,isEscapeHatchDrawer:!1,isLocationStyleStep:!1,isLicencePlateAndVinStep:!1,isFullWidth:!1,hideVinLicensePlateBtn:!1,isOptimizedTraffic:!1,isEval3463Chal1Enabled:!1,isEval3622Chal1Enabled:!1,isEval3463Chal2Enabled:!1,isAllowedToPredefineVin:!0,vinFromDrawerSquishStyles:[],changeStep:b.a};var Ka=a("./site-modules/shared/components/appraisal/appraisal-tabs-container/appraisal-tabs-container.jsx");class Xa extends A.Component{constructor(){super(...arguments),this.state={isLoaded:!1,isHiddenVinLicensePlateBtn:!1,hasVinMismatchError:!1,activeTabId:Ka.c},this.onSelect=((e,t,a,s,i)=>{const n=this.props,r=n.onDropdownsSelect,l=n.vin,o=n.vinStyles,c=n.checkVinMismatchError;r(e,t,a,s,i),l&&c(o)}),this.setVinMismatchError=(()=>this.setState({hasVinMismatchError:!0})),this.setLoaded=(()=>{this.setState(()=>({isLoaded:!0}))}),this.setActiveTab=(e=>this.setState({activeTabId:e})),this.setVinTabActive=(()=>{this.setActiveTab(Ka.g)}),this.setMmyTabActive=(()=>{this.setActiveTab(Ka.c)}),this.unsetVinMismatchError=(()=>this.setState({hasVinMismatchError:!1})),this.checkIsMmyTabActive=(()=>this.state.activeTabId===Ka.c),this.hideVinLicensePlateBtn=(()=>this.setState({isHiddenVinLicensePlateBtn:!0})),this.showVinLicensePlateBtn=(()=>this.setState({isHiddenVinLicensePlateBtn:!1})),this.handleTabLinkClick=(e=>{const t=e.currentTarget.dataset.tabId;this.setActiveTab(t)}),this.componentDidUpdateEval3460Chal1=(e=>{const t=this.props,a=t.vinStyles,s=t.isProfileOfferVinPrepopulationEnabled,i=t.checkVinMismatchError,n=this.state.hasVinMismatchError,r=a&&!m()(e.vinStyles,a);r&&a.length&&!n&&s&&this.hideVinLicensePlateBtn(),r&&s&&i(a),this.props.hasVinMismatchError!==n&&s&&(this.props.hasVinMismatchError?(this.setVinMismatchError(),this.showVinLicensePlateBtn()):(this.unsetVinMismatchError(),a&&a.length&&this.hideVinLicensePlateBtn()))}),this.trackVinEntry=(e=>{J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:X.b.ACTION_APPRAISE_VEHICLE,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_USER_INPUT,subaction_name:X.b.SUBACTION_VIN_ENTRY,creative_id:"edm-entry-appraisal-step-1",value:e}})})}componentDidMount(){J.a.domReady(()=>this.setLoaded())}componentDidUpdate(e,t){const a=this.props,s=a.vinStyles,i=a.isProfileOfferVinPrepopulationEnabled,n=this.state.activeTabId,r=s&&!m()(e.vinStyles,s);this.componentDidUpdateEval3460Chal1(e),r&&!i&&(s.length?(this.hideVinLicensePlateBtn(),this.unsetVinMismatchError()):this.setVinMismatchError()),m()(n,t.activeTabId)||(this.checkIsMmyTabActive()?this.hideVinLicensePlateBtn():y()(s)&&this.showVinLicensePlateBtn())}render(){const e=this.props,t=e.isZipCodeValid,a=e.onZipCodeChange,s=e.selectStyle,i=e.zipCode,n=e.estimatedVehicle,r=e.errorMap,l=e.isMobile,o=e.updateStepsState,c=e.vehicle,d=e.vin,p=e.isPartnerOfferEligibleVin,u=e.updateErrorMapAndScrollToInvalid,h=e.onPartnerOfferVinEligibilityUpdate,g=e.onActiveInventoryCheck,b=e.isEligibleHardcodeYmmBypass,f=e.isStepActive,E=e.updateVinAndContinue,v=e.clearVin,y=e.changeStep,C=e.isLoadingColorsAndOptions,S=e.isProfileOfferVinPrepopulationEnabled,T=e.queryVin,I=e.isAllowedToPredefineVin,N=this.props.vinStyles?this.props.vinStyles:[],_=c.make,O=c.model,P=c.year,A=this.state,x=A.isLoaded,k=A.activeTabId,w=A.isHiddenVinLicensePlateBtn,R=A.hasVinMismatchError,M=!!n,j=r.get(le.f),D=r.get(le.h),F=r.get(le.l),q=r.get(le.j),z=N.map(e=>e.styleId).join(),B=1===N.length;let $="";B&&($=N[0].styleName);const Y=this.checkIsMmyTabActive(),H=N.length>1,G=x?"See your car\u2019s value":"Loading...",W=x?"Continue":"Loading...";return V.a.createElement("div",{className:"location-and-style-step"},V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,className:"px-0 mb-1"},V.a.createElement(It.a,{size:"md",role:"tablist"},Ka.d.DEFAULT.map((e,t)=>{let a=e.id,s=e.label;return V.a.createElement(Nt.a,{key:a,label:s,tabId:a,isActive:a===k,onBtnClick:this.setActiveTab,isFirstItem:0===t,isAppraisalValuePage:!0})})))),!Y&&V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,md:6,className:"px-0"},V.a.createElement(vt.a,{isZipCodeValid:t,onZipCodeChange:a,zipCode:i,zipClassName:"pr-md-1 mb-0",errorMap:r,disabled:!x,zipWrapperClassName:"mb-1"}))),V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,md:k===Ka.g?6:12,lg:k===Ka.g?6:12},V.a.createElement(Qa,{activeTabId:k,vehicle:c,creativeId:Z.c,setActiveTab:this.setActiveTab,clearVin:v,isPartnerOfferEligibleVin:p,updateErrorMapAndScrollToInvalid:u,onPartnerOfferVinEligibilityUpdate:h,updateVinAndContinue:E,onActiveInventoryCheck:g,onValueChange:this.showVinLicensePlateBtn,useUniqId:!0,isMobile:l,updateStepsState:o,isSecondary:!0,isEligibleHardcodeYmmBypass:b,hideVinLicensePlateBtn:w,queryVin:T,vin:d,isVinFromDrawer:!!d&&!I&&!m()(d,T),trackVinEntry:this.trackVinEntry,isStepActive:f,isLocationStyleStep:!0,isFullWidth:!0,hasVinMismatchError:R,vinFromDrawerSquishStyles:N,isAllowedToPredefineVin:I,vinTabLink:V.a.createElement(_t.a,{classNames:"text-decoration-underline",onClick:this.setVinTabActive,tabLink:Ka.f})}),!R&&!!N.length&&w&&!Y&&V.a.createElement(L.a,{className:Re()("size-14",{"mb-1_5":!B})},V.a.createElement(U.a,{xs:12,className:"px-0"},V.a.createElement("div",{className:"font-weight-medium"},P.year," ",_.name," ",O.name),V.a.createElement("div",null,$))))),V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,className:"px-0"},V.a.createElement(Et.a,{tag:"div",showAllSubmodels:M,hasModel:!0,hasYear:!0,hasStyle:!0,vehicle:n,selectStyle:s,hasOptionTruncate:!1,inputClasses:"form-control pr-2 w-100 mmy-select input-content",makeLabel:"Make",modelLabel:"Model",yearLabel:"Year",styleLabel:"Style",labelClassName:"small mb-0_25",errorMessageClassNames:"mt-0_5",makeDropdownClassNames:Re()("has-right-padding mb-1 p-0 pr-md-0_75 pr-lg-1",{"d-none":!Y}),modelDropdownClassNames:Re()("mb-1 p-0 pl-md-0_75 pl-lg-1",{"d-none":!Y}),submodelDropdownClassNames:Re()("mb-1 p-0 pl-md-0_75 pl-lg-1",{"d-none":!Y}),yearDropdownClassNames:Re()("has-right-padding mb-1 mb-md-0 p-0 pr-md-0_75 pr-lg-1",{"d-none":!Y}),styleDropdownClassNames:Re()("p-0",{"d-none":!Y&&(!H||!w||R),"mb-0 pl-lg-1 pl-md-0_75 pos-r style-dropdown-error-gutter":Y,"mt-1 mt-md-0 has-right-padding pr-lg-1 pr-md-0_75 col-12 col-md-6":!Y}),buttonGroupClassNames:"d-none",onDropdownsSelect:this.onSelect,errorMake:j,errorModel:D,errorYear:F,errorStyle:q,pubStatesYears:Z.a,isMobile:l,updateStepsState:o,disabled:!x,enableSpinner:!0,styleIds:z,showFindStyleLink:Y,isProfileOfferVinPrepopulationEnabled:S,isStyleIdQueryParamEnabled:!N.length||N.length>1,isStyledSelects:!0}))),Y&&!l&&V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,md:6,className:"px-0 mt-1"},V.a.createElement(vt.a,{isZipCodeValid:t,onZipCodeChange:a,zipCode:i,zipClassName:"pr-md-1 mb-0 mmy-zip-code",errorMap:r,disabled:!x}))),Y&&l&&V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:4,md:6,className:"px-0 mt-2 mt-md-3"},V.a.createElement(vt.a,{isZipCodeValid:t,onZipCodeChange:a,zipCode:i,zipClassName:"pr-md-0_75 mb-0",errorMap:r,disabled:!x,labelClassName:"icon-location text-primary-darker ml-0_75",inputClassName:"pl-2",isMobile:!0,zipWrapperClassName:"mb-0"})),V.a.createElement(U.a,{xs:7,md:6,lg:4,className:"px-0 mt-2 mt-md-3 ml-auto pl-md-0_75"},V.a.createElement(ot.a,{type:"submit",onClick:y,"data-index":Z.m,"data-tracking-id":Z.i[Z.F],color:"success",className:Re()("heading-5 text-white py-0_5 form-button text-transform-none pos-r d-block w-100",Z.r),disabled:!x||C},C&&V.a.createElement("span",{className:"pr-0_5"},V.a.createElement(ht.a,{size:14,thickness:1,color:"white"})),"Continue"))),(Y&&!l||w&&(!Y||!l))&&V.a.createElement(L.a,{className:Re()("mt-2",{"mt-md-2_5":Y})},V.a.createElement(U.a,{xs:12,md:4,lg:5,xl:4,className:"px-0"},V.a.createElement(ot.a,{type:"submit",onClick:y,"data-index":Z.m,"data-tracking-id":Z.i[Z.F],color:"success",className:Re()("heading-5 text-white py-0_5 form-button text-transform-none pos-r d-block w-100",Z.r),disabled:!x||C},C&&V.a.createElement("span",{className:"pr-0_5"},V.a.createElement(ht.a,{size:14,thickness:1,color:"white"})),Y?W:G)),!Y&&V.a.createElement(U.a,{xs:12,md:4},V.a.createElement(ot.a,{type:"submit",color:"link",onClick:this.setMmyTabActive,className:Re()("heading-5 text-primary-darker py-0 text-transform-none d-block py-0_5 font-weight-normal mx-auto mx-md-0 mt-1 mt-md-0"),disabled:!x},"Not my vehicle"))),!Y&&V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,md:8,className:"appraisal-tab-link-copy text-gray-dark size-14 mt-1_5 bg-gray-extra-light rounded p-1 tab-info",role:"tablist"},V.a.createElement("div",{className:"font-weight-bold text-primary-darker"},"Did you know?"),V.a.createElement("div",null,V.a.createElement("span",null,"By entering your "),V.a.createElement(_t.a,{onClick:this.handleTabLinkClick,tabLink:Ka.e[k].FIRST})," or ",V.a.createElement(_t.a,{onClick:this.handleTabLinkClick,tabLink:Ka.e[k].SECOND}),V.a.createElement("span",null,", you\u2019ll get a more accurate appraisal that may raise your car's value.")))))}}Xa.propTypes={isZipCodeValid:k.a.bool.isRequired,onZipCodeChange:k.a.func.isRequired,onDropdownsSelect:k.a.func.isRequired,updateStepsState:k.a.func,selectStyle:k.a.bool,isMobile:k.a.bool,zipCode:k.a.string,vin:k.a.string,estimatedVehicle:ee.b.StyleWithoutSubmodels,vehicle:k.a.shape({}),errorMap:k.a.objectOf(k.a.string),vinStyles:k.a.arrayOf(k.a.shape({})),isPartnerOfferEligibleVin:k.a.bool,isEligibleHardcodeYmmBypass:k.a.bool,isStepActive:k.a.bool,updateErrorMapAndScrollToInvalid:k.a.func,onPartnerOfferVinEligibilityUpdate:k.a.func,onActiveInventoryCheck:k.a.func,updateVinAndContinue:k.a.func,clearVin:k.a.func,changeStep:k.a.func,isLoadingColorsAndOptions:k.a.bool,isProfileOfferVinPrepopulationEnabled:k.a.bool,hasVinMismatchError:k.a.bool,isAllowedToPredefineVin:k.a.bool,queryVin:k.a.string,checkVinMismatchError:k.a.func},Xa.defaultProps={zipCode:"",vin:"",estimatedVehicle:null,vehicle:{},selectStyle:!1,isStepActive:!1,isMobile:!1,errorMap:new Map,updateStepsState:b.a,vinStyles:null,isPartnerOfferEligibleVin:!1,isEligibleHardcodeYmmBypass:!1,updateErrorMapAndScrollToInvalid:b.a,onPartnerOfferVinEligibilityUpdate:b.a,onActiveInventoryCheck:b.a,updateVinAndContinue:b.a,clearVin:b.a,changeStep:b.a,isLoadingColorsAndOptions:!1,isProfileOfferVinPrepopulationEnabled:!1,hasVinMismatchError:!1,isAllowedToPredefineVin:!0,queryVin:"",checkVinMismatchError:b.a};const Ja={vinStyles:Object(B.a)(e=>Object(te.d)(e),te.b)},es=Object(B.b)(Xa,Ja);var ts=a("../node_modules/lodash/uniqBy.js"),as=a.n(ts),ss=a("./site-modules/shared/utils/collapse-utils.jsx"),is=a("./site-modules/shared/utils/inventory/search-filter.js"),ns=a("./site-modules/shared/utils/inventory/tracking.js"),rs=a("./site-modules/shared/utils/inventory-utils/build-filter-pixel-value.js");function ls(e){let t=e.selected,a=e.classes;return V.a.createElement("span",{className:Re()("d-inline-block checkbox",a,{"icon-checkbox-checked2":t,"icon-checkbox-unchecked2":!t})})}function os(e){let t=e.color;return V.a.createElement("span",{className:"checkbox checkbox-color d-flex justify-content-center align-items-center rounded-circle"},V.a.createElement("span",{className:"rounded-circle",style:{backgroundColor:`rgb(${t})`}}))}ls.propTypes={selected:k.a.bool,classes:k.a.string},ls.defaultProps={selected:!1,classes:"align-self-center"},os.propTypes={color:k.a.string.isRequired};class cs extends A.Component{constructor(){super(...arguments),this.handleFacetSelect=(()=>{const e=this.props,t=e.onUpdate,a=e.facet,s=e.facetName;t(Object(i.a)({},a,{type:s}),!a.selected)})}render(){const e=this.props,t=e.facet,a=e.disableTracking,i=e.facetName,n=e.hideCount,r=e.hideName,l=e.normalSize,o=e.checkboxClasses,c=e.labelClasses,d=e.showPrice,p=t.name,m=t.count,u=void 0===m?0:m,h=t.selected,g=t.rgb,b=t.value,f=t.price,E=(void 0===f?{}:f).usedTradeIn,v=Object(rs.a)(i,b,p),y=Object(ns.a)(v),C=a?null:y;return V.a.createElement("li",{className:"list-unstyled"},V.a.createElement(Ft.a,{className:Re()("checkbox-label pos-r d-flex mb-1 mb-lg-0_5",c),tabIndex:-1},V.a.createElement(qt.a,Object(s.a)({onChange:this.handleFacetSelect,type:"checkbox",className:"input custom-control-input mt-0",checked:!!h,tabIndex:0},C)),g?V.a.createElement(os,{color:g}):V.a.createElement(ls,{classes:o,selected:h}),!r&&V.a.createElement("span",{className:Re()("name mr-0_25",{"ml-0_75":!g&&!l,"ml-1_5":g||l,small:!l})},p),!n&&V.a.createElement("span",{className:"xsmall"},"(",Object(We.c)(u),")"),d&&E&&V.a.createElement("span",{className:"ml-0_75"},Object(Ge.a)(E))))}}cs.propTypes={facet:k.a.shape({}).isRequired,onUpdate:k.a.func.isRequired,hideCount:k.a.bool,hideName:k.a.bool,disableTracking:k.a.bool,normalSize:k.a.bool,showPrice:k.a.bool,facetName:k.a.string.isRequired,checkboxClasses:k.a.string,labelClasses:k.a.string},cs.defaultProps={hideCount:!1,hideName:!1,disableTracking:!1,showPrice:!1,normalSize:!1,checkboxClasses:"",labelClasses:""};a("./site-modules/shared/components/filter-facets/facet-checkbox/facet-checkbox.scss");const ds=[];class ps extends A.Component{constructor(){super(...arguments),this.state={collapse:!1},this.toggleCollapse=(()=>{this.setState(e=>({collapse:!e.collapse}))}),this.renderCheckbox=(e=>{const t=e.value,a=e.id,s=e.name,i=this.props,n=i.onUpdate,r=i.hideCount,l=i.facetName,o=i.disableTracking,c=i.normalSize,d=i.checkboxClasses,p=i.labelClasses,m=i.showPrice,u=t||a||s;return V.a.createElement(cs,{onUpdate:n,hideCount:r,key:u,facet:e,facetName:l,disableTracking:o,normalSize:c,checkboxClasses:d,labelClasses:p,showPrice:m})})}render(){const e=this.props,t=e.values,a=e.visibleValues,s=e.listClasses,i=e.collapseClasses,n=e.additionalContent,r=e.description,l=e.normalSize,o=e.collapseText,c=e.showCollapseIcon,d=e.combineValues,p=this.state.collapse,m=this.renderCheckbox;let u,h;d?(u=Object(is.b)(t),h=ds):(u=t.slice(0,a),h=t.slice(u.length));const g=Re()("m-0",s,{small:!l}),b=p?o.less:o.more;return V.a.createElement(A.Fragment,null,V.a.createElement("div",{className:"facet-checkbox"},Boolean(u.length)&&V.a.createElement("ul",{className:g},u.map(m)),Boolean(h.length)&&V.a.createElement(ss.a,{isOpen:p},V.a.createElement("ul",{className:g},h.map(m))),(Boolean(h.length)||n)&&V.a.createElement("div",{className:"d-flex px-0_5 px-md-1 mb-0_5 justify-content-between"},Boolean(h.length)&&V.a.createElement("button",{onClick:this.toggleCollapse,className:Re()("show-more border-0 px-0",i,{small:!l})},`${b}`,c&&V.a.createElement("span",{className:Re()("ml-0_25",{"icon-arrow-up3":p,"icon-arrow-down3":!p})})),n)),r&&V.a.createElement("div",{className:"small px-0_5 px-2_5 px-lg-1 pb-0_5"},r))}}ps.propTypes={values:k.a.arrayOf(k.a.shape({name:k.a.string.isRequired,value:k.a.string,id:k.a.string,count:k.a.number,selected:k.a.bool,price:k.a.shape({})})),collapseText:k.a.shape({}),visibleValues:k.a.number,onUpdate:k.a.func.isRequired,hideCount:k.a.bool,disableTracking:k.a.bool,normalSize:k.a.bool,showCollapseIcon:k.a.bool,showPrice:k.a.bool,combineValues:k.a.bool,listClasses:k.a.string,checkboxClasses:k.a.string,labelClasses:k.a.string,collapseClasses:k.a.string,description:k.a.string,facetName:k.a.string.isRequired,additionalContent:k.a.element},ps.defaultProps={values:[],visibleValues:4,hideCount:!1,disableTracking:!1,normalSize:!1,showCollapseIcon:!1,showPrice:!1,combineValues:!1,listClasses:"px-0_5 px-md-1",checkboxClasses:"",labelClasses:"",collapseClasses:"text-gray-dark",description:"",collapseText:{less:"show less",more:"show more"},additionalContent:null};var ms=a("./site-modules/shared/components/color-feature-list-smart/color-feature-list-smart.jsx");a("./site-modules/shared/components/color-list-smart-v2/color-list-smart-v2.scss");function us(e){let t=e.name,a=e.rgb,s=e.opacity,i=e.onClick,n=e.className,r=e.isSelected,l=e.isDisabled,o=e.trackingId,c=e.trackingValue;const d="transparent"===a;return V.a.createElement("label",{htmlFor:`color-item-${t}`,className:n},V.a.createElement("div",{className:Re()("color-item-ring rounded-circle mx-auto p-0_25",{"color-ring-selected":r})},V.a.createElement("input",{id:`color-item-${t}`,className:Re()("color-item d-flex rounded-circle mx-auto",{"color-item-selected":r},{"color-item-btn":i},{"unknown-color":d},{disabled:l}),style:{backgroundColor:s?`rgba(${a},${s})`:`rgb(${a})`},name:"color",title:t,type:"checkbox","aria-label":t,onClick:i,"data-tracking-id":o,"data-tracking-value":c,disabled:l})),V.a.createElement("div",{className:Re()("size-12 color-item-name pos-r",{"font-weight-bold":r})},t))}us.propTypes={name:k.a.string.isRequired,rgb:k.a.string.isRequired,onClick:k.a.func.isRequired,isSelected:k.a.bool.isRequired,opacity:k.a.string,className:k.a.string,isDisabled:k.a.bool,trackingId:k.a.string,trackingValue:k.a.string},us.defaultProps={opacity:null,className:"my-0_25 mx-0_5",isDisabled:!1,trackingId:null,trackingValue:null};const hs=e=>{let t=e.listItems,a=e.selectedItems,i=e.keyPrefix,n=e.itemClassName,r=e.className,l=e.onClick,o=e.showCheckmark,c=e.ariaDescribedBy,d=e.ariaInvalid;const p=t.some(e=>"transparent"===S()(e,"properties.rgb"));return V.a.createElement(A.Fragment,null,p&&V.a.createElement("span",{className:"d-flex align-items-center size-14"},V.a.createElement("i",{className:"icon-notification2 mr-0_5"}),"Some color swatches are unavailable"),V.a.createElement(L.a,Object(s.a)({className:Re()("color-list-smart-v2 mt-1",r)},d&&c?{"aria-describedby":c,"aria-invalid":!0}:{}),t.map(e=>{let t=e.name,s=e.properties,r=e.price,c=e.disabled,d=e.trackingId,p=e.trackingValue;const m=S()(s,"rgb"),u=S()(s,"opacity"),h=S()(r,"baseMSRP",0);return m?V.a.createElement(U.a,{xs:4,md:3,className:"text-center mb-2",key:`${i} ${t} (${m})`},V.a.createElement(us,{rgb:m,opacity:u,name:t,baseMSRP:h,onClick:l,className:n,isSelected:!!a[t],isDisabled:c,showCheckmark:o,trackingId:d,trackingValue:p})):null})))};hs.propTypes={itemClassName:k.a.string,listItems:k.a.arrayOf(k.a.shape({name:k.a.string,properties:k.a.shape({rgb:k.a.string,opacity:k.a.string}),price:k.a.shape({baseMSRP:k.a.number}),disabled:k.a.bool,trackingId:k.a.string,trackingValue:k.a.string})).isRequired,keyPrefix:k.a.string,selectedItems:k.a.shape({}),className:k.a.string,onClick:k.a.func.isRequired,showCheckmark:k.a.bool,ariaDescribedBy:k.a.string,ariaInvalid:k.a.bool},hs.defaultProps={keyPrefix:"",itemClassName:"",selectedItems:{},className:"",showCheckmark:!0,ariaDescribedBy:"",ariaInvalid:!1};const gs=Object(ms.a)(hs,"color"),bs="--";const fs={v3ColorsAndOptions:Object(B.a)(e=>{return((e,t)=>{const a=S()(e,"style.id");return a?`styles.${a}.${t}`:""})(e.vehicle,"colorsAndOptions")},ee.c)},Es=Object(B.b)(function(e){let t=e.v3ColorsAndOptions,a=e.optionsFromGraphQlWithPrice,s=e.vehicle;const i=Object(A.useState)(!1),n=Object(qe.a)(i,2),r=n[0],l=n[1],o=S()(s,"style.id"),c=function(e){const t=Object(A.useRef)();return Object(A.useEffect)(()=>{t.current=e}),t.current}(o);return Object(A.useEffect)(()=>{o!==c&&r&&l(!1);const e=a&&a.length;if(!r&&t&&e){const s=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter(e=>e.price&&(e.price.usedPrivateParty>0||e.price.usedTmvRetail>0||e.price.usedTradeIn>0))}(t.options).length,i=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter(e=>{let t=e.options;return t&&t.length&&t.every(e=>{let t=e.oemCode;return t&&t!==bs})})}(a);((e,t)=>{l(!0),J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:X.b.ACTION_APPRAISE_VEHICLE,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:"v3_graphql_option_delta",creative_id:Z.c,value:e}}),J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:X.b.ACTION_APPRAISE_VEHICLE,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:"graphql_option_oemcode_delta",creative_id:Z.c,value:t}})})(s-e,a.length-i.length)}},[a,r,c,o,t]),null},fs);a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/colors-and-options-step/colors-and-options-step.scss");const vs={AVAILABLE_COLORS_COUNT:"available_colors_count",AVAILABLE_OPTIONS_COUNT:"available_options_count",STYLE_ENGINE_SIZE:"style_engine_size",STYLE_TRANSMISSION_TYPE:"style_transmission_type",STYLE_DRIVETRAIN:"style_drivetrain"};function ys(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).filter(e=>e.price&&(e.price.usedPrivateParty>0||e.price.usedTmvRetail>0||e.price.usedTradeIn>0))}function Cs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=t.options,s=void 0===a?[]:a,i=t.engineSize,n=t.transmissionType;return{options:s,colors:e,engineSize:i,driveTrain:t.driveTrain,transmissionType:n,selectedColor:{},selectedColorName:""}}function Ss(e){return e.filter(e=>{let t=e.properties;return t&&t.rgb}).length}class Ts extends A.Component{constructor(){super(...arguments),this.state=Cs(this.props.colors,this.props.vehicleFeatures),this.getDrawerCreativeId=(()=>{return this.props.drawerCreativeId||Z.t}),this.fireTrackAction=(e=>{let t=e.subactionName,a=e.value;const s=this.props.isExtendedReport?Z.c:this.getDrawerCreativeId();J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:X.b.ACTION_APPRAISE_VEHICLE,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:t,creative_id:s,value:a}})}),this.handleOptionsSelect=((e,t)=>{const a=[...this.state.options],s=a.findIndex(t=>{return t.id===e.id});a[s].selected=t,this.setState({options:a},()=>{const e=this.state.options.filter(e=>{return e.selected}),t=this.state.options.length;this.props.onOptionsSelect(e,t)})}),this.handleColorSelect=(e=>{const t=e?{[e]:!0}:{};this.setState({selectedColor:t,selectedColorName:e},()=>{const e=this.state,t=e.selectedColorName,a=e.colors.find(e=>{return e.name===t});this.props.onColorSelect(a)})})}static getDerivedStateFromProps(e,t){let a=e.colors,s=e.vehicleFeatures,i=void 0===s?{}:s,n=t.colors,r=t.options,l=void 0===r?[]:r;const o=i.options||[];return!a||!o||m()(a,n)&&(d=l,(c=o)&&d&&c.length===d.length&&c.every((e,t)=>{const a=d[t];return a&&e.id===a.id}))?null:Cs(a,i);var c,d}componentDidUpdate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=this.props,s=a.colors,i=a.vehicleFeatures,n=a.onPartnerOfferEligibilityUpdate,r=a.updateStepsState,l=a.isStepActive,o=a.partnerOfferEligibilityResponse,c=a.preSelectedColor,d=a.setLoadingColorsAndOptions,p=e.partnerOfferEligibilityResponse,u=e.colors,h=e.vehicleFeatures;if(s&&i&&(!m()(i,h)||!m()(s,u))){d(!1);const e=i.options,t=ys(void 0===e?[]:e);this.fireTrackAction({subactionName:vs.AVAILABLE_COLORS_COUNT,value:Ss(s)}),this.fireTrackAction({subactionName:vs.AVAILABLE_OPTIONS_COUNT,value:t.length})}const g=this.state,b=g.colors,f=g.selectedColor,E=g.engineSize,v=g.transmissionType,C=g.driveTrain,S=e.isStepActive!==l;if(l&&S&&y()(f)&&c&&c.id){const e=b.find(e=>{return e.id===c.id})||{name:""};this.handleColorSelect(e.name)}if(y()(o)||m()(o,p)||(r("partnerOfferEligibilityResponse",o),n(o.isEligible)),s&&(y()(s)||!Ss(s))&&i&&y()(i))return;const T=t.engineSize,I=t.transmissionType,N=t.driveTrain;if(i&&!m()(i,h)){const e=i.options;r("partnerEquipment",(void 0===e?[]:e).map(e=>e.name))}T===E&&I===v&&N===C||(this.fireTrackAction({subactionName:vs.STYLE_ENGINE_SIZE,value:E}),this.fireTrackAction({subactionName:vs.STYLE_TRANSMISSION_TYPE,value:v}),this.fireTrackAction({subactionName:vs.STYLE_DRIVETRAIN,value:C}))}render(){const e=this.state,t=e.options,a=e.colors,i=e.selectedColor,n=e.selectedColorName,r=this.props,l=r.isMobile,o=r.colors,c=r.vehicleFeatures,d=r.errorMap,p=r.vehicle,m=S()(c,"options",[]),u=ys(t),h=u.length,g=u.slice(0,Math.round(h/2)),b=u.slice(g.length),f={less:"See less",more:"See more"},E=d.get(le.a),v=`${le.a}-error-${Object(zt.c)()}`;return V.a.createElement(L.a,{className:"colors-and-options-step text-gray-darker"},V.a.createElement(Es,{optionsFromGraphQlWithPrice:u,vehicle:p}),!y()(o)&&Ss(o)||ys(m).length?V.a.createElement(A.Fragment,null,V.a.createElement(U.a,{xs:12,className:"px-0 mb-1"},V.a.createElement("div",{className:"font-weight-bold mb-0_5"},"Exterior Color: ",V.a.createElement("span",{className:"font-weight-normal"},n)),V.a.createElement(gs,Object(s.a)({listItems:a,selectedItems:i,showCheckmark:!1,updateHOCState:this.handleColorSelect},E?{ariaDescribedBy:v,ariaInvalid:!0}:{})),V.a.createElement(Yt.a,{id:v,error:E})),!!h&&V.a.createElement(U.a,{xs:12,className:"px-0"},V.a.createElement("div",{className:"mb-1"},V.a.createElement("div",{className:"font-weight-bold"},"Add Additional Equipment:")),V.a.createElement(L.a,{className:"pl-0_5"},(l?[u]:[g,b]).map((e,t)=>V.a.createElement(U.a,{xs:12,md:6,className:"p-0",key:`equipment-${t}`},V.a.createElement(ps,{onUpdate:this.handleOptionsSelect,values:e,facetName:"options",listClasses:"options-list p-0 pr-md-0_5",checkboxClasses:"medium",labelClasses:"align-items-baseline",visibleValues:l?6:e.length,collapseText:f,collapseClasses:"text-primary-darker pl-1_25",showCollapseIcon:!0,normalSize:!0,disableTracking:!0,hideCount:!0})))))):V.a.createElement(U.a,{xs:12,className:"display-3 px-0"},"Sorry, we couldn't find any colors and options! Please continue to the next step."))}}Ts.propTypes={onOptionsSelect:k.a.func.isRequired,onColorSelect:k.a.func.isRequired,onPartnerOfferEligibilityUpdate:k.a.func.isRequired,updateStepsState:k.a.func.isRequired,isStepActive:k.a.bool.isRequired,colors:ee.b.Colors,vehicleFeatures:ee.b.VehicleFeatures,isExtendedReport:k.a.bool,isZipCodeValid:k.a.bool,isMobile:k.a.bool,errorMap:k.a.objectOf(k.a.string),vehicle:k.a.shape({}),zipCode:k.a.string,partnerOfferEligibilityResponse:kt.a.Eligibility,preSelectedColor:k.a.shape({}),drawerCreativeId:k.a.string,setLoadingColorsAndOptions:k.a.func},Ts.defaultProps={colors:void 0,vehicleFeatures:void 0,isExtendedReport:!1,isMobile:!1,isZipCodeValid:!1,errorMap:new Map,vehicle:{},zipCode:"",partnerOfferEligibilityResponse:{},preSelectedColor:{},drawerCreativeId:"",setLoadingColorsAndOptions:b.a};const Is={colors:Object(B.a)(e=>{return((e,t)=>{const a=S()(e,"style.id");return a?`styles.${a}.${t}`:""})(e.vehicle,"colorsAndOptions")},ee.c,function(e){const t=e.colors.sort((e,t)=>{const a=S()(e,"properties.rgb"),s=S()(t,"properties.rgb");return a?s?"transparent"===a?-1:"transparent"===s?1:a===s?0:a<s?-1:1:-1:1});return as()(t,"id")}),vehicleFeatures:Object(B.a)(e=>{let t=e.vehicle;const a=S()(t,"style.id");return a?Object(ee.v)(a):""},ee.c),partnerOfferEligibilityResponse:Object(B.a)(e=>{let t=e.vehicle,a=e.zipCode,s=e.isZipCodeValid,i=e.isExtendedReport,n=e.isStepActive;if(i&&s&&n){const e=S()(t,"make.slug",""),s=S()(t,"model.slug",""),i=S()(t,"style.year",null);return Object(kt.d)({make:e,model:s,year:i,zipCode:a})}return null},kt.b)},Ns=Object(q.c)(e=>({zipCode:S()(e,"visitor.location.zipCode")}))(Object(B.b)(Ts,Is));var _s=a("./site-modules/shared/components/select/select.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/condition-and-mileage-step/condition-and-mileage-step.scss");const Os={THRESHOLD:5e3,MIN:100},Ps=e=>{return(new Date).getFullYear()-e>=11};function As(e){const t=new Date,a=t.getFullYear(),s=t.getMonth()+1-2,i=s>0?s:0,n=a-e;return n<0||0===n&&0===i?Os.MIN:Ps(e)?13e4:12e3*n+1e3*i}function Vs(e){let t=e.mileage,a=e.condition,i=e.isMileageValid,n=e.onMileageChange,r=e.onConditionChange,l=e.getMileageRef,o=e.onMileageBlur,c=e.errorMap,d=e.isStepActive,p=e.make,m=e.model,u=e.year;const h=Object(A.useRef)(null),g=Object(A.useState)(As(u)),b=Object(qe.a)(g,2),f=b[0],E=b[1],v=Object(A.useCallback)(()=>{if(d&&!t&&i){const e=As(u);E(e),n({target:{value:`${e}`}}),h.current&&h.current.touch()}},[d,t,i,u,n]);Object(A.useEffect)(()=>{d&&v()},[d,v]),Object(A.useEffect)(()=>{d&&!a&&r({target:{value:Z.n.AVERAGE}})},[d,a,r]);const y=c.get(le.g),C=c.get(le.c),S=`${le.g}-error-${Object(zt.c)()}`,T=`${le.c}-error-${Object(zt.c)()}`;return V.a.createElement(L.a,{className:"text-gray-darker condition-and-mileage-step"},V.a.createElement(U.a,{xs:12,md:6},V.a.createElement("div",{className:"mb-1 size-16 font-weight-bold"},"Vehicle Condition"),V.a.createElement("div",{className:Re()("pos-r condition-dropdown custom-select-arrow",{"has-danger":!!C})},V.a.createElement(_s.a,Object(s.a)({isLabelHidden:!0,name:"vehicleCondition",className:"select form-control form-control-lg text-gray-darker size-16 pr-2 condition-select",options:Z.q.map(e=>({label:e.title,value:e.title})),value:a,onChange:function(e){let t=e.value;r({target:{value:t}})}},C?{ariaDescribedBy:C,ariaInvalid:!0}:{}))),V.a.createElement(Yt.a,{id:T,error:C,classes:"mt-1"}),V.a.createElement("div",{className:"mt-0_5 size-14 text-gray-dark mb-2_5"},a&&Z.q.find(e=>e.title===a).text,V.a.createElement("div",null,a===Z.n.DAMAGED&&V.a.createElement("div",{className:"mt-1"},"Sorry,",V.a.createElement(Ba.a,{to:"/",title:"Edmunds.com",className:"mx-0_25"},"Edmunds.com"),'does not provide estimates for damaged vehicles. To derive a value for a "Damaged" vehicle, simply take the "Average" condition and subtract the cost of restoring the vehicle to "Average" condition.',V.a.createElement(ot.a,{color:"link",onClick:function(){r({target:{value:Z.n.AVERAGE}})},className:"text-capitalize text-underline text-gray-darker p-0 border-0 align-top ml-0_25"},V.a.createElement("span",{className:"size-14 font-weight-normal"},"Got It"))))),V.a.createElement(Kt.a,Object(s.a)({placeholder:"Enter Mileage",type:"string",inputMode:"numeric",pattern:"[0-9]*",id:"mileage",name:"mileage",label:"Mileage",inputClassName:"heading-5 font-weight-normal mileage-field",labelClassName:"mb-1 font-weight-bold text-gray-darker",ref:function(e){l(e),h.current=e},value:t,isValid:!y&&i,onChange:n,onBlur:o},y?{ariaDescribedBy:S,ariaInvalid:!0}:{})),V.a.createElement(Yt.a,{id:S,error:y}),V.a.createElement("div",{className:"mt-0_5 size-14 text-gray-dark"},function(e,t,a,s){const i=e+Os.THRESHOLD;return`In your area, the average mileage for a ${t} ${a} ${s} is between ${e>Os.THRESHOLD?e-Os.THRESHOLD:Os.MIN} - ${i} miles.`}(f,u,p,m))))}Vs.propTypes={isMileageValid:k.a.bool.isRequired,getMileageRef:k.a.func.isRequired,onConditionChange:k.a.func.isRequired,onMileageChange:k.a.func.isRequired,onMileageBlur:k.a.func.isRequired,mileage:k.a.string,condition:k.a.string,errorMap:k.a.objectOf(k.a.oneOfType([k.a.string,k.a.node,k.a.func])),isStepActive:k.a.bool,make:k.a.string,model:k.a.string,year:k.a.oneOfType([k.a.string,k.a.number])},Vs.defaultProps={mileage:"",condition:"",errorMap:new Map,isStepActive:!1,make:"",model:"",year:""};var xs=a("./site-modules/shared/components/loading-spinner/loading-spinner.jsx"),ks=a("./site-modules/shared/components/image/image.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-step-head.scss");function ws(e){let t=e.title,a=e.make,s=e.model,i=e.style,n=e.photo,r=e.descriptionValues,l=e.isExtendedReport,o=e.showExteriorColor,c=e.showAddEquipment,d=e.changeStep;const p=Object(Ze.d)({makeSlug:a,modelSlug:s}),m="border-0 p-0 text-transform-none font-weight-normal text-primary-darker btn-link text-left edit-link",u={Exterior:{stepId:Z.m,trackingId:"edit_color"},Mileage:{stepId:Z.p,trackingId:"edit_mileage"}};return V.a.createElement(A.Fragment,null,V.a.createElement(U.a,{xs:12},V.a.createElement("div",{className:"heading-4"},t),V.a.createElement("div",{className:"text-gray-darker"},i)),V.a.createElement(U.a,{xs:12,md:l?5:6},V.a.createElement(Ba.a,{className:Re()("d-block my-0_75 text-center",{"text-md-left":l}),to:p,target:"_blank"},V.a.createElement(ks.a,{imageId:n,className:Re()("img-fluid",{rounded:l}),alt:t,source:He.d.MEDIA}))),l&&V.a.createElement(U.a,{xs:12,md:7,className:"pt-md-0_5"},r.map(e=>{let t=e.title,a=e.value,s=e.isTotal;return("Exterior"!==t||"Exterior"===t&&o)&&V.a.createElement("div",{key:t,className:"text-info pb-0_5"},V.a.createElement("span",null,t,":"),V.a.createElement("span",{className:"pl-0_25"},s?V.a.createElement(A.Fragment,null,Object(Ge.a)(a),V.a.createElement("div",{className:"small"},"As of ",Ye()(Date.now(),"longDate"))):a),(e=>{const t=u[e];return t?V.a.createElement("span",{className:"pl-0_5 size-14"},"(",V.a.createElement(ot.a,{onClick:d,className:m,"data-tracking-id":t.trackingId,"data-index":t.stepId},"edit"),")"):null})(t))}),c&&V.a.createElement(ot.a,{onClick:d,className:m,"data-tracking-id":"edit_options","data-index":Z.m},V.a.createElement("span",{className:"icon-plus-circle2 mr-0_5"}),"Add additional equipment to my appraisal")))}function Rs(e){let t=e.descriptionValues;const a=["Exterior"],s=Ye()(Date.now(),"shortDate");return t.map(e=>{let t=e.title,i=e.value,n=e.isTotal;return V.a.createElement(L.a,{key:t,className:Re()({"mb-0_75":n})},V.a.createElement(U.a,{className:Re()({"text-gray small":!n,"text-gray-darker font-weight-bold":n}),xs:6},t),V.a.createElement(U.a,{className:Re()("text-right",{"text-gray small":!n,"text-gray-darker font-weight-bold":n,"color-name-selection":a.includes(t)}),xs:6},n?V.a.createElement(A.Fragment,null,Object(Ge.a)(i),V.a.createElement("div",{className:"appraisal-date font-weight-normal mt-0_25"},`As of ${s}`)):i))})}ws.propTypes={changeStep:k.a.func.isRequired,title:k.a.string,make:k.a.string,model:k.a.string,style:k.a.string,photo:k.a.string,descriptionValues:k.a.arrayOf(k.a.shape({})),isExtendedReport:k.a.bool,showExteriorColor:k.a.bool,showAddEquipment:k.a.bool},ws.defaultProps={title:"",make:"",model:"",style:"",photo:"",descriptionValues:[],isExtendedReport:!1,showExteriorColor:!0,showAddEquipment:!1},Rs.propTypes={descriptionValues:k.a.arrayOf(k.a.shape({}))},Rs.defaultProps={descriptionValues:[]};var Ms=a("./site-modules/shared/components/tooltip-item/tooltip-item.jsx");a("./site-modules/shared/components/appraisal/appraisal-report-price-title/appraisal-report-price-title.scss");function js(e){let t=e.id,a=e.title,i=e.info,n=e.placement,r=e.columnsSize,l=e.className,o=e.iconClassName,c=e.onTooltipOpen;return V.a.createElement(U.a,Object(s.a)({},r,{className:l}),a,"\xa0",!(!i||!t)&&V.a.createElement(Ms.a,{id:t,className:"appraisal-table-info-btn",iconClassName:o,item:{text:i,placement:n},useUniqId:!0,onTooltipOpen:c}))}js.propTypes={info:k.a.string,title:k.a.oneOfType([k.a.string,k.a.object]).isRequired,id:k.a.string,columnsSize:k.a.shape({xs:k.a.number,md:k.a.number,lg:k.a.number}),placement:k.a.string,className:k.a.string,iconClassName:k.a.string,onTooltipOpen:k.a.func},js.defaultProps={info:"",id:"",placement:"bottom",className:"",columnsSize:{xs:8,md:8,lg:8},iconClassName:"ml-0_5 xsmall",onTooltipOpen:b.a};var Ds=a("./site-modules/shared/utils/nice-name.js"),Ls=a("./site-modules/shared/utils/calculator/calculator-helper.js"),Fs=a("./constants/pub-states.js"),Us=a("./site-modules/shared/constants/key-values.js");class qs extends A.Component{constructor(){super(...arguments),this.state={value:"",isMoreInfoCollapsed:!1},this.handlePayoffChange=(e=>{e.persist();const t=Object(Ge.d)(e.target.value),a=t>0?-t:t;this.setState({value:a})}),this.handleBlur=(()=>{this.props.onPayoffChange(this.state.value)}),this.handleEnterPress=(e=>{e.key===Us.a&&(e.preventDefault(),e.target.blur())}),this.toggleMoreInfo=(()=>this.setState(e=>({isMoreInfoCollapsed:!e.isMoreInfoCollapsed})))}render(){const e=this.state,t=e.isMoreInfoCollapsed,a=e.value;return V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:7},V.a.createElement("span",{id:"payoff-amount",className:"font-weight-normal mb-1"},"Do you owe anything on your trade-in?")),V.a.createElement(U.a,{xs:5},V.a.createElement("div",{className:"payment-field ml-md-1 pos-r"},V.a.createElement("span",{className:"i-dollar"},"$"),V.a.createElement(qt.a,{name:"payOffAmount",type:"number",inputMode:"numeric",className:"input-content text-gray-darker text-right pl-1 pr-0",onChange:this.handlePayoffChange,onBlur:this.handleBlur,onKeyPress:this.handleEnterPress,value:a,"data-testid":"payOffAmount"}))),V.a.createElement(U.a,null,V.a.createElement(ot.a,{color:"link","aria-describedby":"total-trade-in","aria-expanded":!t,className:"p-0 mt-0_25 text-decoration-none text-left heading-6 font-weight-normal",onClick:this.toggleMoreInfo},V.a.createElement("div",{className:"text-primary-darker"},V.a.createElement("span",null,Z.G.title),V.a.createElement("span",{className:Re()("pl-0_25 small text-primary-darker",{"icon icon-arrow-down2":!t,"icon icon-arrow-up2":t})}))),V.a.createElement(dt.a,{className:"mt-0_75","aria-hidden":t,isOpen:t},V.a.createElement("p",{className:"text-gray-darker"},Z.G.PAYOFF_AMOUNT))))}}qs.propTypes={onPayoffChange:k.a.func.isRequired};var zs=a("./site-modules/shared/components/car-buying/odometer-payment-value/odometer-payment-value.jsx");class Bs extends A.Component{constructor(){super(...arguments),this.state={isMoreInfoCollapsed:!1},this.toggleMoreInfo=(()=>this.setState(e=>({isMoreInfoCollapsed:!e.isMoreInfoCollapsed})))}render(){const e=this.props,t=e.totalTradeIn,a=e.infoMessage,s=this.state.isMoreInfoCollapsed;return V.a.createElement(L.a,{className:"trade-in"},V.a.createElement(U.a,{xs:8,className:"text-gray-darker font-weight-bold"},V.a.createElement("span",{id:"total-trade-in"},Z.fb.title)),V.a.createElement(U.a,{xs:4,className:"font-weight-bold text-right"},V.a.createElement(zs.a,{value:t}),V.a.createElement("div",{className:"appraisal-date font-weight-normal mt-0_25 mr-0_5"},"As of ",Ye()(Date.now(),"shortDate"))),V.a.createElement(U.a,null,V.a.createElement(ot.a,{color:"link","aria-describedby":"total-trade-in","aria-expanded":!s,className:"p-0 mt-0_25 text-decoration-none text-left heading-6 font-weight-normal",onClick:this.toggleMoreInfo},V.a.createElement("div",{className:"text-primary-darker"},V.a.createElement("span",null,Z.G.title),V.a.createElement("span",{className:Re()("pl-0_25 small text-primary-darker",{"icon icon-arrow-down2":!s,"icon icon-arrow-up2":s})}))),V.a.createElement(dt.a,{className:"mt-0_75","aria-hidden":s,isOpen:s},V.a.createElement("p",{className:"text-gray-darker"},Z.G.TOTAL_TRADE_IN)),a&&V.a.createElement("div",{className:"mt-0_75 small text-gray-darker","data-test":"total-trade-in-info-message"},a)))}}Bs.propTypes={totalTradeIn:k.a.number,infoMessage:k.a.string},Bs.defaultProps={totalTradeIn:0,infoMessage:""};class $s extends A.Component{constructor(){super(...arguments),this.state={isMoreInfoCollapsed:!1},this.toggleMoreInfo=(()=>this.setState(e=>({isMoreInfoCollapsed:!e.isMoreInfoCollapsed})))}render(){const e=this.props,t=e.appliedTradeIn,a=e.infoMessage,s=e.skipMoreInfo,i=e.className,n=e.classNameValue,r=e.hideAppraisalDate,l=this.state.isMoreInfoCollapsed;return V.a.createElement(L.a,{className:Re()("trade-in",{"mt-1_25":!s})},V.a.createElement(U.a,{xs:8,className:Re()("text-gray-darker font-weight-bold",i)},V.a.createElement("span",null,Z.b.title)),V.a.createElement(U.a,{xs:4,className:Re()("font-weight-bold text-right",n)},V.a.createElement(zs.a,{value:t}),!r&&V.a.createElement("div",{className:"appraisal-date font-weight-normal mt-0_25 mr-0_5"},"As of ",Ye()(Date.now(),"shortDate"))),!s&&V.a.createElement(U.a,null,V.a.createElement(ot.a,{color:"link","aria-describedby":"payoff-amount","aria-expanded":!l,className:"p-0 mt-0_25 text-decoration-none text-left heading-6 font-weight-normal",onClick:this.toggleMoreInfo},V.a.createElement("div",{className:"text-primary-darker"},V.a.createElement("span",null,Z.G.title),V.a.createElement("span",{className:Re()("pl-0_25 small text-primary-darker",{"icon icon-arrow-down2":!l,"icon icon-arrow-up2":l})}))),V.a.createElement(dt.a,{className:"mt-0_75","aria-hidden":l,isOpen:l},V.a.createElement("p",{className:"text-gray-darker"},Z.G.APPLIED_TRADE_IN)),a&&V.a.createElement("div",{className:"mt-0_75 small text-gray-darker","data-test":"applied-trade-in-info-message"},a)))}}function Ys(e){let t=e.title,a=e.value,s=e.values,i=e.info;const n=a[Z.kb];return n?V.a.createElement(A.Fragment,null,V.a.createElement(L.a,{className:"mb-0_5 mt-0_75"},V.a.createElement(js,{title:t,info:i,id:Object(Ds.c)(t),columnsSize:{xs:9,md:9,lg:9}}),V.a.createElement(U.a,{xs:3,className:"text-right"},Object(Ge.c)(n)),!!s.length&&s.map(e=>{let a=e.name,s=e.price;return V.a.createElement(A.Fragment,{key:a},V.a.createElement(U.a,{xs:9,className:Re()("mt-0_75 pl-1_5",{"option-names-selections":"Optional Equipment"===t})},a),V.a.createElement(U.a,{xs:3,className:"mt-0_75 text-right"},function(e){const t=e&&e[Z.kb];return Object(Ge.c)(t)}(s)))}))):null}function Hs(e){let t=e.totalPrice,a=e.priceList,i=e.onPayoffChange,n=e.sellingPrice,r=e.msrp,l=e.residualValue,o=e.isPurchase,c=e.isUsed,d=e.styleId,p=e.zipCode,m=e.pageName,u=e.venomVersion;const h=Object(A.useState)(!1),g=Object(qe.a)(h,2),b=g[0],f=g[1],E=Object(A.useState)(t),v=Object(qe.a)(E,2),y=v[0],C=v[1],T=Object(A.useState)(0),I=Object(qe.a)(T,2),N=I[0],_=I[1],O=Object(A.useState)(0),P=Object(qe.a)(O,2),x=P[0],k=P[1],w=Object(A.useState)({totalTradeInMsg:"",appliedTradeInMsg:""}),R=Object(qe.a)(w,2),M=R[0],j=R[1];Object(A.useEffect)(()=>{let e=!1;return async function(){const t=await Object(Ls.a)({salesPrice:n,msrp:r,residual:l,isPurchase:o,isUsed:c,styleId:d,zipCode:p,tradeIn:y,pageName:m,venomVersion:u});if(!e){const e=c?Fs.a.USED:Fs.a.NEW,a=Object(Ls.d)(t,K.ab)||y,s=Object(Ls.i)(S()(t,"limitCriteria",{}),e).tradeInValidationError;i(x,a),j({totalTradeInMsg:y<0?K.fb:"",appliedTradeInMsg:s}),_(a)}}(),()=>{e=!0}},[y]);return V.a.createElement("div",null,V.a.createElement(ot.a,{color:"link",block:!0,"data-tracking-id":"view_detailed_report",className:"m-0 p-0 mt-0_75 text-decoration-none text-left heading-6 font-weight-normal",onClick:()=>f(!b)},V.a.createElement("span",{className:"text-primary-darker"},V.a.createElement("span",null,"See Detailed Report"),V.a.createElement("span",{className:Re()("small ml-0_25",{"icon-arrow-up3":b,"icon-arrow-down3":!b})}))),V.a.createElement(dt.a,{isOpen:b,className:"heading-5 font-weight-normal"},a.map(e=>V.a.createElement(Ys,Object(s.a)({key:`appraisal report - ${e.title}`},e)))),V.a.createElement("hr",{className:"my-1_5 my-md-1"}),V.a.createElement(qs,{onPayoffChange:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;C(t+e),k(e)}}),V.a.createElement("hr",{className:"my-1_5 my-md-1"}),V.a.createElement(Bs,{totalTradeIn:y,infoMessage:M.totalTradeInMsg}),V.a.createElement($s,{appliedTradeIn:N,infoMessage:M.appliedTradeInMsg}))}$s.propTypes={appliedTradeIn:k.a.number,infoMessage:k.a.string,skipMoreInfo:k.a.bool,className:k.a.string,classNameValue:k.a.string,hideAppraisalDate:k.a.bool},$s.defaultProps={appliedTradeIn:0,infoMessage:"",skipMoreInfo:!1,className:"",classNameValue:"",hideAppraisalDate:!1},Ys.propTypes={title:k.a.string.isRequired,value:k.a.shape({}),values:k.a.arrayOf(k.a.shape({})),info:k.a.string},Ys.defaultProps={info:"",values:[],value:{}},Hs.propTypes={totalPrice:k.a.number.isRequired,priceList:k.a.arrayOf(k.a.shape({})),onPayoffChange:k.a.func.isRequired,sellingPrice:k.a.number,msrp:k.a.number,residualValue:k.a.number,isPurchase:k.a.bool,isUsed:k.a.bool,styleId:k.a.number,zipCode:k.a.string,venomVersion:k.a.string,pageName:k.a.string},Hs.defaultProps={priceList:[],sellingPrice:0,msrp:0,residualValue:0,isPurchase:!1,isUsed:!1,styleId:null,zipCode:"",venomVersion:"",pageName:""};const Zs=Object(q.c)(e=>({venomVersion:S()(e,"venomVersion.version"),pageName:S()(e,"pageContext.page.name")}))(Hs);function Gs(e){let t=e.getVehicleData,a=e.onPayoffChange,s=e.changeStep,i=e.vehiclePhoto,n=e.totalPrices,r=e.priceList,l=e.sellingPrice,o=e.msrp,c=e.residualValue,d=e.isPurchase,p=e.isUsed,m=e.color,u=e.condition,h=e.mileage,g=e.showExteriorColor,b=e.showAddEquipment,f=e.zipCode;const E=t(),v=E.makeName,y=E.modelName,C=E.makeSlug,S=E.modelSlug,T=E.styleName,I=E.year,N=E.styleId,_=`${I} ${v} ${y}`,O=n[Z.kb],P=[{title:"Appraisal value:",value:O,isTotal:!0},{title:"Mileage",value:h},{title:"Exterior",value:m.name},{title:"Condition",value:u}];return V.a.createElement(L.a,{className:"mb-md-1_5 appraisal-report-step-head"},V.a.createElement(ws,{changeStep:s,title:_,make:C,model:S,style:T,photo:i,descriptionValues:P,showExteriorColor:g,showAddEquipment:b}),V.a.createElement(U.a,{xs:12,md:6,className:"pt-md-0_5"},V.a.createElement(Rs,{descriptionValues:P}),V.a.createElement(Zs,{totalPrice:O,priceList:r,onPayoffChange:a,sellingPrice:l,msrp:o,residualValue:c,isPurchase:d,isUsed:p,styleId:N,zipCode:f})))}Gs.propTypes={getVehicleData:k.a.func.isRequired,changeStep:k.a.func.isRequired,onPayoffChange:k.a.func.isRequired,priceList:k.a.arrayOf(k.a.shape({})),totalPrices:k.a.shape({}),sellingPrice:k.a.number,msrp:k.a.number,residualValue:k.a.number,isPurchase:k.a.bool,isUsed:k.a.bool,vehiclePhoto:k.a.string,color:k.a.shape({}),condition:k.a.string,mileage:k.a.string,showExteriorColor:k.a.bool,showAddEquipment:k.a.bool,zipCode:k.a.string},Gs.defaultProps={priceList:[],sellingPrice:0,msrp:0,residualValue:0,isPurchase:!1,isUsed:!1,stepId:Z.ab,vehiclePhoto:"",color:{},condition:"",mileage:"",totalPrices:{},showExteriorColor:!1,showAddEquipment:!1,zipCode:""};a("./site-modules/shared/components/appraisal/appraisal-report-toggle-btn/appraisal-report-toggle-btn.scss");function Ws(e){let t=e.onClick,a=e.show,s=e.showText,i=e.hideText,n=e.btnClassNames;return V.a.createElement(ot.a,{color:"link",size:"lg",className:Re()("appraisal-report-toggle-btn w-100 text-left px-0 py-0 mt-0_5",n),onClick:t,"data-tracking-id":"view_detailed_report"},a?s:i,V.a.createElement("span",{className:Re()("text-primary align-middle small pl-0_25",{"icon-arrow-down3":a,"icon-arrow-up3":!a})}))}Ws.propTypes={onClick:k.a.func.isRequired,show:k.a.bool,showText:k.a.string,hideText:k.a.string,btnClassNames:k.a.string},Ws.defaultProps={show:!0,showText:"Show estimated values",hideText:"Hide estimated values",btnClassNames:""};var Qs=a("./site-modules/shared/components/appraisal/transaction-type-select/transaction-type-select.jsx"),Ks=a("../node_modules/reactstrap/lib/ButtonDropdown.js"),Xs=a.n(Ks),Js=a("../node_modules/reactstrap/lib/DropdownToggle.js"),ei=a.n(Js),ti=a("../node_modules/reactstrap/lib/DropdownMenu.js"),ai=a.n(ti);a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-step-condition-dropdown.scss");class si extends A.Component{constructor(){super(...arguments),this.state={isOpen:!1},this.onChange=(e=>{let t=e.currentTarget.value;this.setState({isOpen:!1},()=>{this.props.onUpdate(t)})}),this.onToggleOpen=(()=>{this.setState(e=>({isOpen:!e.isOpen}))})}render(){const e=this.state.isOpen,t=this.props,a=t.selectedCondition,s=t.conditionClassName;return V.a.createElement(Xs.a,{isOpen:e,toggle:this.onToggleOpen,className:"condition-container align-baseline"},V.a.createElement(ei.a,{className:"m-0 p-0 condition text-capitalize size-16","aria-haspopup":!0},V.a.createElement("span",{"aria-label":"vehicle-condition",className:Re()("px-0_25",s)},a),V.a.createElement("i",{"aria-hidden":!0,className:"brand-primary-darker size-12 py-0 my-0 pr-0_25 icon-arrow-down3"})),V.a.createElement(ai.a,{right:!0,className:"condition-dropdown-shadow p-0_25"},Z.o.map(e=>{let t=e.title,s=e.text;return V.a.createElement(A.Fragment,{key:`${t}-btn`},V.a.createElement(ot.a,{className:Re()("condition-dropdown-btn size-14  font-weight-normal text-gray-darker py-0_5 px-0_75 m-0 w-100",{"font-weight-bold":a===t}),onClick:this.onChange,value:t},V.a.createElement("div",{className:"btn-title d-flex text-capitalize justify-content-between"},t,V.a.createElement("i",{"aria-hidden":!0,hidden:a!==t,className:"btn-title-icon text-primary-darker font-weight-bold align-self-center icon-checkmark mr-0_25"})),V.a.createElement("div",{className:"display-6 condition-dropdown-description"},s)))})))}}si.propTypes={selectedCondition:k.a.string.isRequired,onUpdate:k.a.func.isRequired,conditionClassName:k.a.string},si.defaultProps={selectOnOpen:!1,conditionClassName:""};a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-step-bar-chart.scss");function ii(e){let t=e.prices,a=e.selectedType,s=e.selectedCondition;return t.length&&V.a.createElement("div",{className:"appraisal-report-bar-chart pt-2_5 pt-sm-1_5"},V.a.createElement(L.a,{className:"bar-chart justify-content-center text-center text-gray-darker align-items-end size-14"},t.map((e,t)=>{const i=`appraisal-report-bar-chart-bar-${t}`;return V.a.createElement(U.a,{key:i,xs:3,className:Re()("bar d-flex align-items-end justify-content-center pb-0_5 mx-0_25 mx-lg-0_5 pos-r",`bar-${t}`,a,{"selected-condition font-weight-bold":Z.o[t].title===s})},Object(Ge.c)(e))})),V.a.createElement("hr",{className:"bar-chart-underline my-0"}),V.a.createElement(L.a,{className:"justify-content-center my-0_5"},Z.o.map(e=>{let t=e.title,a=e.text;return V.a.createElement(U.a,{xs:3,key:`${t}-${a}`,className:"bar-description size-12 text-gray-darker text-center px-0 px-lg-05 mx-0_25 mx-lg-0_5"},V.a.createElement("span",{className:Re()({"font-weight-bold":t===s})},t)," ",V.a.createElement(Ms.a,{id:t.toLowerCase(),className:"appraisal-table-info-btn",iconClassName:"small text-gray-darker",item:{text:a,placement:"bottom"},useUniqId:!0}))})))}ii.propTypes={prices:k.a.arrayOf(k.a.number),selectedType:k.a.string,selectedCondition:k.a.string},ii.defaultProps={prices:[],selectedType:Z.kb,selectedCondition:Z.n.AVERAGE};var ni=a("./site-modules/shared/components/profile/firebase-auth.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step-extended/appraisal-report-extended-detailed.scss");const ri="We use data from a wide variety of sources to provide you with your Edmunds appraisal report, considering factors such as the car's year, make, model, trim, mileage, depreciation and features. This is not a firm offer on your car.",li="selected-outlined";class oi extends A.Component{static getDerivedStateFromProps(e,t){const a=e.emailReportStatus,s=t.isSubmitting,i=t.isSubmitted;return a===Z.u.SENT?(s&&J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:X.b.ACTION_SIGN_UP,subaction_name:X.b.SUCCESS_EMAIL_ONLY_SIGN_UP,action_cause:X.b.ACTION_CAUSE_BUTTON_CLICK,action_category:X.b.USER_ACTION_CATEGORY,creative_id:"edm-entry-track-car-value"}}),{isSubmitting:!1,isSubmitted:i||s}):null}constructor(e){var t;t=super(e),this.onEmailFormFieldFocus=(()=>{const e=this.props,t=e.emailReportStatus,a=e.resetEmailReportStatus;this.state.isSubmitted&&(t===Z.u.SENT&&a(),this.setState({isSubmitted:!1}))}),this.getPrices=function(e){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=t.props.allConditionPricing,i=t.state.selectedType;return a?s.rough[e]:Z.o.map(t=>{let a=t.title;return s[a.toLowerCase()][e][i]})},this.getConditionDescription=(e=>Z.o.find(t=>{return t.title===e})),this.uniqInputId="",this.editLinkClassName="border-0 p-0 text-transform-none font-weight-normal text-primary-darker btn-link text-left edit-link",this.editLinkDataByDescriptionTitle={Exterior:{stepId:Z.m,trackingId:"edit_color"},Mileage:{stepId:Z.p,trackingId:"edit_mileage"}},this.handleTypeChange=(e=>{let t=e.value;const a=this.props.stepId;this.setState(()=>({selectedType:t})),this.props.updateStepsState("selectedReportType",t),J.a.fireTrackAction(Object(Z.rb)(t,this.props.creativeId)),J.a.fireTrackAction(Z.d[a][t])}),this.handleConditionChange=(e=>{this.props.updateStepsState("condition",e)}),this.handleSubmitEmail=(async e=>{const t=this.props,a=t.validate,s=t.resetEmailReportStatus;e.preventDefault(),e.stopPropagation();const i=a();i&&s(),this.setState({isSubmitting:i},async()=>{const e=this.props,t=e.isAuthenticated,a=e.doesNotHaveEmail,s=e.updateIdmData,n=e.fields,r=e.validateEmailAsync;await nt({isAuthenticated:t,doesNotHaveEmail:a,isValid:i,emailField:n.email,updateIdmData:s,validateEmailAsync:r,fetchSignInMethodsForEmail:ni.e,fireValidExistingEmailCustomEvent:se.g}),J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:X.b.ACTION_SIGN_UP,subaction_name:X.b.SUBMIT_SIGN_UP_EMAIL,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_BUTTON_CLICK,creative_id:"edm-entry-track-car-value",value:"TRACK"}})})}),this.inputRef=(e=>{if(e)return this.props.fieldRef(e.props.name,e)}),this.renderEditLink=(e=>{const t=this.editLinkDataByDescriptionTitle[e];return V.a.createElement("span",{className:"pl-0_5 size-14"},"(",V.a.createElement(ot.a,{onClick:this.props.changeStep,className:this.editLinkClassName,"data-tracking-id":t.trackingId,"data-index":t.stepId},"edit"),")")}),this.renderPriceRow=(e=>{let t=e.prices,a=e.className,i=e.priceClassName,n=void 0===i?"":i,r=e.titleProps,l=e.conditionOrderNumber;return t.find(e=>void 0!==e)?V.a.createElement(L.a,{key:r.title,className:Re()("extended-report-table-row px-0_25",a)},V.a.createElement(js,Object(s.a)({iconClassName:"small text-gray-darker"},r,{columnsSize:{xs:8,lg:4}})),t.map((e,t)=>{const a=`${e}-${r.id}-${t}`;return V.a.createElement(U.a,{xs:2,key:a,className:Re()("text-right py-0_5 py-lg-0_75 hidden-md-down",n,{[li]:t===l})},Object(Ge.c)(e))}),V.a.createElement(U.a,{xs:4,className:Re()("text-right py-0_5 py-lg-0_75 hidden-lg-up",n)},Object(Ge.c)(t[l]))):null}),this.renderReportDetailHeader=(()=>{const e=this.props,t=e.stepId,a=e.isMobile;return V.a.createElement(A.Fragment,null,V.a.createElement("div",{className:"heading-4 d-flex align-items-center"},V.a.createElement("span",{className:"icon-edmunds-car text-primary size-24 mr-0_5"}),"Your Edmunds Appraisal ",V.a.createElement("span",{className:"d-none d-md-block"},"\xa0Report")),V.a.createElement("div",{className:"my-0_5 size-14"},"As of ",Ye()(Date.now(),"mm/dd/yyyy")),t===Z.x&&!a&&V.a.createElement("div",{className:"my-0_5 mb-lg-1_5 size-14"},ri))}),this.renderEmailSection=(()=>{const e=this.props,t=e.validationErrors.email,a=e.validate,s=e.userEmail,i=e.isMobile,n=this.state,r=n.isSubmitting,l=n.isSubmitted,o=l?"Sent!":"SEND",c=i?"Email":"Enter Your Email";return V.a.createElement("div",{className:"mb-2"},V.a.createElement("div",{className:Re()("rounded email-section-wrapper pt-1 pb-1_5 w-100",{"px-1_5":!i,"px-1":i})},V.a.createElement("div",{className:"text-center text-md-left"},V.a.createElement("div",{className:"d-flex justify-content-center align-items-center justify-content-md-start"},V.a.createElement("span",{className:"icon-edmunds-car text-primary size-24 mr-0_5"}),V.a.createElement("span",{className:"heading-5"},"Know what your car is worth")),V.a.createElement("div",{className:"size-14"},"Get a copy of your appraisal report and monthly updates on the value of your car.")),V.a.createElement(mt.a,{noValidate:!0,onSubmit:this.handleSubmitEmail,className:"mt-1"},V.a.createElement(U.a,{xl:8,md:10,className:"px-0"},V.a.createElement("div",{className:"w-100 d-flex"},V.a.createElement(U.a,{className:"px-0",xs:i?8:9},V.a.createElement(Kt.a,{className:"mb-0",defaultValue:s,"data-tracking-id":"provide_email","data-tracking-parent":"edm-entry-track-car-value","data-tracking-ignore-value":!0,id:`offer-card-email-${this.uniqInputId}`,maxLength:255,name:"email",type:"email",inputClassName:"px-0_5 mb-0 email-input","aria-label":c,ref:this.inputRef,isValid:!t,required:!0,onFocus:this.onEmailFormFieldFocus,onBlur:a,readOnly:r,placeholder:`${c} \u2020`})),V.a.createElement(U.a,{xs:i?4:3,className:"px-0"},V.a.createElement(ot.a,{type:"submit",color:"success",className:Re()("w-100 size-16 text-white py-0_5 track-btn text-capitalize",{"p-0":i,"pl-0_75":!i&&r,"pl-0_25":i&&r}),"data-tracking-id":"submit_sign_up_email",disabled:l},r&&V.a.createElement("span",{className:Re()({"pr-0_5":!i,"pr-0_25":i})},V.a.createElement(ht.a,{size:14,thickness:1,color:"white"})),V.a.createElement("span",{className:"size-16"},o)))),t&&V.a.createElement("div",{id:`error-email-${this.uniqInputId}`,className:"size-12 mt-0_25 text-danger d-none d-md-block"},t)))),V.a.createElement("div",{className:Re()("text-gray size-10",{"mt-0_25":!i,"mt-0_75":i})},"\u2020 By clicking Send, I accept the terms of the"," ",V.a.createElement(Ba.a,{target:"_blank",rel:"noopener noreferrer",to:"/about/visitor-agreement.html",className:"text-gray-darker disclaimer"},V.a.createElement("u",null,"Edmunds Visitor Agreement")),"."," ",V.a.createElement(Ba.a,{target:"_blank",rel:"noopener noreferrer",to:"/about/privacy.html",className:"text-gray-darker disclaimer"},V.a.createElement("u",null,"Our collection and use of your personal information")),"."))}),this.renderReportTableHeader=(()=>{const e=this.props,t=e.changeStep,a=e.isMobile,s=e.getVehicleData,i=e.mileage,n=e.color,r=e.vin,l=e.stepId,o=e.showBarChart,c=e.showVehicleDetails,d=e.zipCode,p=e.showExteriorColor,m=e.showAddEquipment,u=e.condition,h=this.state.selectedType,g=Z.lb[h].info,b=s(),f=b.makeName,E=b.modelName,v=b.styleName,y=b.year;return V.a.createElement("div",{className:"text-gray-darker"},c?V.a.createElement(A.Fragment,null,V.a.createElement("div",null,this.renderReportDetailHeader()),V.a.createElement("div",{className:"appraisal-report-vehicle-details size-16 text-gray-darker text-md-left mt-1 mb-1_5"},V.a.createElement("div",{className:"font-weight-bold"},y," ",f," ",E),V.a.createElement("div",null,v),V.a.createElement("div",null,"Mileage: ",Object(We.c)(parseInt(i,10)),this.renderEditLink("Mileage")),p&&V.a.createElement("div",null,"Exterior: ",n.name,this.renderEditLink("Exterior")),l===Z.x&&V.a.createElement("div",null,"VIN: ",r),V.a.createElement("div",null,"Zip code: ",d),m&&V.a.createElement(ot.a,{onClick:t,className:this.editLinkClassName,"data-tracking-id":"edit_options","data-index":Z.m},V.a.createElement("span",{className:"icon-plus-circle2 mr-0_5"}),"Add additional equipment to my appraisal"))):V.a.createElement("div",null,this.renderReportDetailHeader()),this.renderEmailSection(),o?V.a.createElement(A.Fragment,null,a&&V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12},V.a.createElement(Qs.a,{labelText:"Transaction type select",isLabelHidden:!0,onChange:this.handleTypeChange,selected:h,className:"mb-1"}))),V.a.createElement(L.a,{className:"justify-content-between"},!a&&V.a.createElement(U.a,{lg:6,md:5,xs:8},V.a.createElement(Qs.a,{labelText:"Transaction type select",isLabelHidden:!0,onChange:this.handleTypeChange,selected:h,className:"mb-1"}))),V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,className:"size-12 text-center"},g)),V.a.createElement(L.a,{className:"justify-content-center pb-2_5 pb-sm-1_5"},V.a.createElement(U.a,{xs:12},V.a.createElement(ii,{prices:this.getPrices("totalPrices"),selectedType:h,selectedCondition:u})))):V.a.createElement(A.Fragment,null,V.a.createElement(L.a,{className:"justify-content-between flex-md-row-reverse mb-md-1_5"},V.a.createElement(U.a,{md:5,lg:6},V.a.createElement(Qs.a,{labelText:"Transaction type select",isLabelHidden:!0,onChange:this.handleTypeChange,selected:h,className:"mb-1_5"})))))}),this.renderYourAppraisal=(e=>V.a.createElement("div",{className:Re()("text-gray-darker size-12 text-center font-weight-bold",e)},"Your car's value")),this.renderReportTable=(()=>{const e=this.props.condition,t=this.state.selectedType,a=[Object(i.a)({},Z.X.NATIONAL_BASE,{prices:this.getPrices("nationalPrices")}),Object(i.a)({},Z.X.OPTIONAL_EQUIPMENT,{prices:this.getPrices("optionalPrices"),optionsValues:this.getPrices("optionalPricesValues",!0)}),Object(i.a)({},Z.X.COLOR_ADJUSTMENT,{prices:this.getPrices("colorPrices")}),Object(i.a)({},Z.X.REGIONAL_ADJUSTMENT,{prices:this.getPrices("regionalPrices")}),Object(i.a)({},Z.X.MILEAGE_ADJUSTMENT,{prices:this.getPrices("mileagePrices")}),Object(i.a)({},Z.X.CONDITION_ADJUSTMENT,{prices:this.getPrices("conditionPrices")}),{title:"Value",prices:this.getPrices("totalPrices"),isTotal:!0}],s=V.a.createElement(L.a,{className:"extended-report-table-head-your-appraisal px-0_25 hidden-md-down"},V.a.createElement(U.a,{xs:7,lg:4}),Z.o.map(t=>{let a=t.title;const s=a===e;return V.a.createElement(U.a,{xs:2,key:`table-head-condition-selected-${a}`,className:Re()("py-0_5",{[li]:s})},s&&this.renderYourAppraisal())}),V.a.createElement(U.a,{xs:5})),n=V.a.createElement(L.a,{className:"extended-report-table-head px-0_25 size-14 font-weight-bold"},V.a.createElement(U.a,{xs:7,lg:4,className:Re()("d-flex align-items-end align-items-lg-baseline","py-1 py-lg-0_5")}),Z.o.map(t=>{let a=t.title,s=t.text;return V.a.createElement(U.a,{xs:2,key:a,className:Re()("text-right hidden-md-down","py-1 py-lg-0_5",{[li]:a===e})},V.a.createElement("div",{className:"d-none d-lg-block d-xl-inline"},a),V.a.createElement(Ms.a,{id:a.toLowerCase(),className:"appraisal-table-info-btn",iconClassName:"small text-gray-darker",item:{text:s,placement:"bottom"},useUniqId:!0}))}),V.a.createElement(U.a,{xs:5,className:Re()("hidden-lg-up text-right d-flex align-items-end justify-content-end","py-1 py-lg-0_5")},V.a.createElement("div",null,this.renderYourAppraisal("pr-1_25"),V.a.createElement(si,{onUpdate:this.handleConditionChange,selectedCondition:e})))),r=a.map(a=>{const s=a.title,i=a.info,n=a.prices,r=a.optionsValues,l=void 0===r?[]:r,o=a.totalPrice,c=a.isTotal,d=Z.o.findIndex(t=>t.title===e),p=!!l.length&&l.map(e=>{let a=e.name,s=e.price;return this.renderPriceRow({prices:Array(Z.o.length).fill(s[t]),conditionOrderNumber:d,className:"extended-report-table-option-row",titleProps:{title:a,id:Object(Ds.c)(a),className:"py-0_5 py-lg-0_75 pl-1"}})});return V.a.createElement(A.Fragment,{key:s},this.renderPriceRow({prices:n,conditionOrderNumber:d,totalPrice:o,className:Re()("extended-report-table-item-row",{"extended-report-table-total-row":c}),priceClassName:{"heading-4":c},titleProps:{title:c?V.a.createElement(A.Fragment,null,V.a.createElement("span",{className:"hidden-lg-up"},e," Condition "),s):s,info:i,id:Object(Ds.c)(s),className:Re()("py-lg-0_75",{"py-0_75 font-weight-bold":c,"py-0_5":!c})}}),p)});return V.a.createElement("div",{className:"text-gray-darker size-14"},s,n,r)});const a=e.selectedReportType;this.state={selectedType:a,isSubmitting:!1,isSubmitted:!1}}componentDidMount(){this.uniqInputId=Object(zt.c)()}render(){const e=this.props.isDetailedReportOpen;return V.a.createElement(A.Fragment,null,this.renderReportTableHeader(),V.a.createElement(dt.a,{isOpen:e},this.renderReportTable()))}}oi.propTypes={stepId:k.a.string.isRequired,isDetailedReportOpen:k.a.bool.isRequired,handleEmailReportClick:k.a.func.isRequired,changeStep:k.a.func.isRequired,emailReportStatus:k.a.string,resetEmailReportStatus:k.a.func,updateStepsState:k.a.func,allConditionPricing:k.a.shape({rough:k.a.object,average:k.a.object,clean:k.a.object,outstanding:k.a.object}).isRequired,selectedReportType:k.a.string,condition:k.a.string,creativeId:k.a.string,getVehicleData:k.a.func.isRequired,mileage:k.a.string,vin:k.a.string,color:k.a.shape({}),showVehicleDetails:k.a.bool,showBarChart:k.a.bool,showExteriorColor:k.a.bool,showAddEquipment:k.a.bool,zipCode:k.a.string,validationErrors:k.a.objectOf(k.a.string),validate:k.a.func.isRequired,userEmail:k.a.string,fields:k.a.shape({}),validateEmailAsync:k.a.func.isRequired,updateIdmData:k.a.func.isRequired},oi.defaultProps={emailReportStatus:"",resetEmailReportStatus:b.a,updateStepsState:b.a,condition:"",selectedReportType:Z.kb,creativeId:Z.g,mileage:"",color:{},vin:"",showVehicleDetails:!1,showBarChart:!0,showExteriorColor:!1,showAddEquipment:!1,zipCode:"",validationErrors:{},userEmail:"",fields:{}};const ci=Object(Y.a)(oi),di=Object(q.c)(e=>({userEmail:S()(e,"profile.data.idm.identifiers.email[0]"),isAuthenticated:e.profile.isAuthenticated,doesNotHaveEmail:!S()(e,"profile.data.idm.identifiers.email[0]")}))(Object(Jt.a)(ci,it)),pi="Hide detailed report",mi="See detailed report";class ui extends A.Component{constructor(){super(...arguments),this.state={isDetailedReportOpen:!0},this.getDisplayConditions=(()=>{switch(this.props.stepId){case Z.ab:return{showVehicleDetails:!1,showBarChart:!0};case Z.x:return{showVehicleDetails:!0,showBarChart:!0};default:return{showVehicleDetails:!1,showBarChart:!1}}}),this.getReportView=(()=>{const e=this.props,t=e.changeStep,a=e.stepId,s=e.emailReportStatus,i=e.resetEmailReportStatus,n=e.handleEmailReportClick,r=e.updateStepsState,l=e.allConditionPricing,o=e.selectedReportType,c=e.condition,d=e.creativeId,p=e.isMobile,m=e.getVehicleData,u=e.mileage,h=e.color,g=e.vin,b=e.zipCode,f=e.showExteriorColor,E=e.showAddEquipment,v=this.state.isDetailedReportOpen,y=this.getDisplayConditions(),C=y.showVehicleDetails,S=y.showBarChart;return V.a.createElement(di,{changeStep:t,stepId:a,isDetailedReportOpen:v,handleEmailReportClick:n,emailReportStatus:s,resetEmailReportStatus:i,updateStepsState:r,allConditionPricing:l,selectedReportType:o,condition:c,creativeId:d,isMobile:p,getVehicleData:m,mileage:u,color:h,vin:g,showVehicleDetails:C,showBarChart:S,zipCode:b,showExteriorColor:f,showAddEquipment:E})}),this.toggleDetailedReport=(()=>this.setState(e=>({isDetailedReportOpen:!e.isDetailedReportOpen})))}render(){const e=this.state.isDetailedReportOpen;return V.a.createElement("div",{className:"appraiser-report-step-extended rounded"},this.getReportView(),V.a.createElement("div",{className:"pt-1"},V.a.createElement(Ws,{onClick:this.toggleDetailedReport,show:!e,hideText:pi,showText:mi,btnClassNames:"text-primary"})))}}ui.propTypes={stepId:k.a.string,totalPrices:k.a.shape({tradeIn:k.a.number,privateParty:k.a.number,dealerRetail:k.a.number}).isRequired,handleEmailReportClick:k.a.func.isRequired,getVehicleData:k.a.func.isRequired,changeStep:k.a.func.isRequired,emailReportStatus:k.a.string,resetEmailReportStatus:k.a.func,updateStepsState:k.a.func,allConditionPricing:k.a.shape({rough:k.a.object,average:k.a.object,clean:k.a.object,outstanding:k.a.object}),selectedReportType:k.a.string,creativeId:k.a.string,condition:k.a.string,mileage:k.a.string,vin:k.a.string,color:k.a.shape({}),isMobile:k.a.bool,zipCode:k.a.string,showExteriorColor:k.a.bool,showAddEquipment:k.a.bool},ui.defaultProps={stepId:Z.ab,emailReportStatus:"",resetEmailReportStatus:b.a,updateStepsState:b.a,allConditionPricing:null,selectedReportType:"",condition:"",creativeId:Z.g,isMobile:!1,mileage:"",color:{},vin:"",zipCode:"",showExteriorColor:!1,showAddEquipment:!1};var hi=a("./site-modules/shared/components/logos/carmax-logo.jsx"),gi=a("./site-modules/shared/components/logos/edmunds-logo-text.jsx");a("./site-modules/shared/components/appraisal/appraisal-partner-offer-value-props/appraisal-partner-offer-value-props.scss");const bi=[{text:"No-obligation offer you can keep in your back pocket"},{text:"Easy way to sell your car quickly"},{text:"Haggle free so you don\u2019t have to negotiate"}];function fi(){return V.a.createElement("section",{className:"appraisal-partner-offer-value-props size-14 text-gray-darker"},V.a.createElement("ul",{className:"pl-1 pr-1_5 h-100 d-flex flex-column justify-content-around"},bi.map(e=>{let t=e.text;return V.a.createElement("li",{key:t,className:"mb-0_5 pl-0_5"},V.a.createElement("i",{className:"icon-checkmark text-success size-16"})," ",t)})))}var Ei=a("./site-modules/shared/components/appraisal/appraisal-utm-storage/appraisal-utm-storage.js");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/license-plate-and-vin-step/license-plate-and-vin-step.scss");const vi={title:"Edmunds market insights and a real offer on your car",details:[{id:"#1",text:"Get the Edmunds Appraisal, so you know what it's worth"},{id:"#2",text:"Get an instant, no obligation offer from CarMax to see how it compares"},{id:"#3",text:"No contact info needed, no annoying calls"}]},yi=["NY","CA"],Ci=(e,t,a)=>e?a:!!t||!a;class Si extends A.Component{constructor(e){super(e),this.onActiveStep=(()=>{this.props.isEscapeHatch?J.a.fireTrackAction(Z.D):J.a.fireTrackAction(Z.E)}),this.setVinFromDrawerSquishStyles=(e=>{this.setState({vinFromDrawerSquishStyles:e})}),this.setActiveTab=(e=>this.setState({activeTabId:e})),this.getStepEdmundsHeader=(()=>V.a.createElement(L.a,{className:"mb-1_5"},V.a.createElement(U.a,{xs:12,className:"mb-1_5 pt-0_5"},V.a.createElement(gi.a,{className:"edm-logo"})),V.a.createElement(U.a,{xs:12,className:"heading-4 mb-0_5"},vi.title),V.a.createElement(U.a,{xs:12,xl:9,className:"size-14"},V.a.createElement(A.Fragment,null,V.a.createElement("ul",{className:"pl-1 mb-0"},vi.details.map(e=>V.a.createElement("li",{key:e.id},e.text))))))),this.getStepHeader=(()=>{const e=this.props,t=e.isEscapeHatch,a=e.isMobile,s=e.vehicle,i=s.make,n=s.model,r=s.year;return t?V.a.createElement(L.a,{className:"mb-1_5 text-center text-gray-darker"},V.a.createElement(U.a,{xs:12,className:"mb-1_5 mb-md-1_25 pt-2_5"},V.a.createElement("div",{className:"partner-logo mx-auto"},V.a.createElement(hi.a,null))),V.a.createElement(U.a,{xs:12,className:Re()("mb-1",{"heading-4":a,"heading-3":!a})},"CarMax wants to buy your",V.a.createElement("br",null),r.year," ",i.name," ",n.name,"!"),V.a.createElement(U.a,{xs:12},V.a.createElement(ks.a,{imageId:"img/eva/price-reveal-v2.png",source:He.d.STATIC,alt:"Price Reveal",className:"price-reveal"})),V.a.createElement(U.a,{xs:12,xl:9,className:"size-14 mx-auto mt-0_75"},"All we need is your ",this.state.activeTabId===Ma.VIN?"VIN":"License Plate"," to see your",V.a.createElement("br",null),"no-obligation and hassle free cash offer.")):this.getStepEdmundsHeader()}),this.setVinTabActive=(()=>this.setActiveTab(Ma.VIN)),this.setLicensePlateTabActive=(()=>this.setActiveTab(Ma.LICENSE_PLATE)),this.getTabContents=(()=>{const e=this.props,t=e.onValueChange,a=e.isMobile,s=e.vehicle,i=e.queryVin,n=e.clearVin,r=e.isPartnerOfferEligibleVin,l=e.trackingCreativeId,o=e.vin,c=e.isEscapeHatch,d=e.isSecondary,p=e.isEligibleHardcodeYmmBypass,m=e.isStepActive,u=e.isVinFromDrawer,h=e.hasVinMismatchError,g=e.updateErrorMapAndScrollToInvalid,b=e.onPartnerOfferVinEligibilityUpdate,f=e.updateVinAndContinue,E=e.onActiveInventoryCheck,v=e.isLicencePlateAndVinStep,y=e.isAllowedToPredefineVin,C=e.eval3463Recipe,S=e.changeStep,T=e.updateStepsState,I=this.state,N=I.activeTabId,_=I.vinFromDrawerSquishStyles,O=this.isEval3463ChalAllowed("chal2"===C);return V.a.createElement(A.Fragment,null,c&&!a&&V.a.createElement(fi,null),V.a.createElement(Qa,{vinFromDrawerSquishStyles:_,activeTabId:N,isMobile:a,vehicle:s,creativeId:l,setActiveTab:this.setActiveTab,clearVin:n,tabContentModal:this.tabContentModal,isPartnerOfferEligibleVin:r,onPartnerOfferVinEligibilityUpdate:b,updateVinAndContinue:f,onActiveInventoryCheck:E,onValueChange:t,useUniqId:c,isSecondary:d,isEligibleHardcodeYmmBypass:p,isEscapeHatch:c,queryVin:i,vin:o,setVinTabActive:this.setVinTabActive,isStepActive:m,isVinFromDrawer:u,hasVinMismatchError:h,updateErrorMapAndScrollToInvalid:g,trackVinEntry:this.trackVinEntry,vinTabLink:V.a.createElement(_t.a,{classNames:"text-decoration-underline",onClick:this.setVinTabActive,tabLink:Ka.f}),isLicencePlateAndVinStep:v,isAllowedToPredefineVin:y,isEval3463Chal2Enabled:O,changeStep:S,updateStepsState:T,isOptimizedTraffic:this.isOptimizedTraffic}))}),this.getDrawerCreativeId=(()=>{return`${this.props.trackingCreativeId}-popup`}),this.isAddressToVinExcludedState=(e=>yi.includes(e)),this.isEval3463ChalAllowed=(e=>{const t=this.props.stateCode;return e&&!this.isAddressToVinExcludedState(t)}),this.isOptimizedTraffic=[Ei.a.isSemCampaignAppraisals,Ei.a.isSemCampaignFacebook,this.props.isAppExtensionPage].some(e=>!!e),this.updateActiveTabId=(()=>{const e=this.props,t=e.queryVin,a=e.isMobile,s=e.isEscapeHatch;this.setState({activeTabId:Ci(s,t,a)?Ma.VIN:Ma.LICENSE_PLATE})}),this.trackVinEntry=((e,t)=>{J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:X.b.ACTION_APPRAISE_VEHICLE,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_USER_INPUT,subaction_name:X.b.SUBACTION_VIN_ENTRY,creative_id:t,value:e}})}),this.fireSkippedStepEvents=(()=>{const e=this.props,t=e.vin,a=e.isVinFromDrawer,s=this.state.vinFromDrawerSquishStyles;if(t){const e=s.length&&a?this.getDrawerCreativeId():Z.e;this.trackVinEntry(t,e),J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:X.b.ACTION_APPRAISE_VEHICLE,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_USER_INPUT,subaction_name:X.b.SUBACTION_VIN_STEP_BYPASS,creative_id:Z.e,value:t}})}}),this.tabContentModal=(e=>{const t=this.props,a=t.changeStep,s=t.onValueChange,i=t.isMobile,n=t.vehicle,r=t.clearVin,l=t.isPartnerOfferEligibleVin,o=t.vin,c=t.isEscapeHatch,d=t.isEligibleHardcodeYmmBypass,p=t.isStepActive,m=t.updateErrorMapAndScrollToInvalid,u=t.onPartnerOfferVinEligibilityUpdate,h=t.onActiveInventoryCheck,g=t.updateVinAndContinue,b=t.updateStepsState,f=t.isLicencePlateAndVinStep,E=t.eval3463Recipe,v=t.stateCode;if(c)return V.a.createElement(ot.a,{color:"link",className:"p-0 border-0 text-primary-darker text-transform-none size-16 find-vin-modal-open-btn",onClick:e===Ma.VIN?this.setLicensePlateTabActive:this.setVinTabActive},V.a.createElement("span",{className:"font-weight-normal"},"Use my ",e===Ma.VIN?"License Plate":"VIN"," instead"));const y=e===Ma.LICENSE_PLATE,C=this.getDrawerCreativeId(),S=(e,t)=>{const E=e||t;return V.a.createElement(oa,{isMobile:i,creativeId:E?Z.K:C,changeStep:a,isLicensePlate:y,vehicle:n,updateVinAndContinue:g,updateStepsState:b,isEval3463Chal1Enabled:e,isEval3622Chal1Enabled:t,setVinFromDrawerSquishStyles:this.setVinFromDrawerSquishStyles,licensePlateAndVinForm:V.a.createElement(Qa,{isEval3463Chal1Enabled:e,isEval3622Chal1Enabled:t,isMobile:i,activeTabId:y?Ma.VIN:Ma.LICENSE_PLATE,vehicle:n,creativeId:E?Z.K:C,setActiveTab:this.setActiveTab,clearVin:r,isPartnerOfferEligibleVin:l,updateErrorMapAndScrollToInvalid:m,onPartnerOfferVinEligibilityUpdate:u,updateVinAndContinue:g,onActiveInventoryCheck:h,onValueChange:s,useUniqId:!0,updateStepsState:b,isSecondary:!0,isEligibleHardcodeYmmBypass:d,isEscapeHatch:c,vin:o,setVinTabActive:this.setVinTabActive,trackVinEntry:this.trackVinEntry,isStepActive:p,isEscapeHatchDrawer:!0,isFullWidth:!0,vinTabLink:V.a.createElement(_t.a,{classNames:"text-decoration-underline",onClick:this.setVinTabActive,tabLink:Ka.f}),isLicencePlateAndVinStep:f})})},T=V.a.createElement(Oe.a,{name:"EVAL-3622",showDefault:!0},V.a.createElement(Oe.c,{name:"ctrl",isDefault:!0}),V.a.createElement(Oe.c,{name:"chal0"}),V.a.createElement(Oe.c,{name:"chal1"},S(!1,!0)));return this.isAddressToVinExcludedState(v)?this.isOptimizedTraffic?null:S():this.isOptimizedTraffic?T:S(this.isEval3463ChalAllowed("chal1"===E))});const t=e.queryVin,a=e.isMobile,s=e.isEscapeHatch;this.state={activeTabId:Ci(s,t,a)?Ma.VIN:Ma.LICENSE_PLATE,vinFromDrawerSquishStyles:[]}}componentDidMount(){this.props.isStepActive&&this.onActiveStep()}componentDidUpdate(e){const t=this.props,a=t.isStepActive,s=t.isStepDone,i=t.queryVin,n=t.vinStyles,r=a!==e.isStepActive&&a,l=s&&!a&&!m()(s,e.isStepDone);r&&this.onActiveStep(),l&&this.fireSkippedStepEvents(),i&&!m()(e.queryVin,i)&&this.updateActiveTabId(),m()(this.state.vinFromDrawerSquishStyles,n)||m()(e.vinStyles,n)||this.setVinFromDrawerSquishStyles(n)}render(){const e=this.props,t=e.trackingCreativeId,a=e.isMobile,s=e.isEscapeHatch,i=V.a.createElement(A.Fragment,null,this.getStepHeader(),!s||a?this.getTabContents():V.a.createElement("div",{className:"d-md-flex d-lg-block d-xl-flex"},this.getTabContents()));return V.a.createElement("div",{className:Re()("license-plate-and-vin-step",{"teaser-offer-card pl-1 pr-1_25 pb-2 mb-2 px-md-3_5":s}),"data-tracking-parent":t},i)}}Si.propTypes={vehicle:k.a.shape({make:k.a.shape({name:k.a.string}),model:k.a.shape({name:k.a.string}),year:k.a.shape({year:k.a.string})}).isRequired,onPartnerOfferVinEligibilityUpdate:k.a.func.isRequired,onActiveInventoryCheck:k.a.func.isRequired,updateVinAndContinue:k.a.func.isRequired,clearVin:k.a.func.isRequired,changeStep:k.a.func.isRequired,updateErrorMapAndScrollToInvalid:k.a.func.isRequired,isMobile:k.a.bool,trackingCreativeId:k.a.string,onValueChange:k.a.func,updateStepsState:k.a.func,isStepActive:k.a.bool,isSecondary:k.a.bool,isEligibleHardcodeYmmBypass:k.a.bool,queryVin:k.a.string,vin:k.a.string,stateCode:k.a.string,isPartnerOfferEligibleVin:k.a.bool,isEscapeHatch:k.a.bool,isVinFromDrawer:k.a.bool,hasVinMismatchError:k.a.bool,isStepDone:k.a.bool,isAppExtensionPage:k.a.bool,isLicencePlateAndVinStep:k.a.bool,isAllowedToPredefineVin:k.a.bool,vinStyles:k.a.arrayOf(k.a.shape({})),eval3463Recipe:k.a.string},Si.defaultProps={isMobile:!1,isEligibleHardcodeYmmBypass:!1,queryVin:"",stateCode:"",vin:"",updateStepsState:b.a,isPartnerOfferEligibleVin:!1,isStepDone:!1,trackingCreativeId:Z.B,onValueChange:void 0,isStepActive:!1,isSecondary:!1,isEscapeHatch:!1,isVinFromDrawer:!1,hasVinMismatchError:!1,tabContentModal:b.a,isAppExtensionPage:!1,isLicencePlateAndVinStep:!1,isAllowedToPredefineVin:!0,vinStyles:[],eval3463Recipe:"ctrl"};const Ti={vinStyles:Object(B.a)(e=>{let t=e.vin;return Object(te.d)({vin:t})},te.b)},Ii=Object(q.c)(e=>({isAppExtensionPage:S()(e,"pageContext.isAppExtensionPage"),stateCode:S()(e,"visitor.location.stateCode")}))(Object(B.b)(Si,Ti));var Ni=a("./site-modules/shared/pages/seo.jsx"),_i=a("./site-modules/shared/components/delighted/delighted.jsx");function Oi(e){let t=e.onClick,a=e.deviceType,s=e.title,i=e.pageName,n=e.sessionId,r=e.disableNpsSurvey,l=e.isEpo;if(r)return null;const o=l?_i.a.PartnerOffer:_i.a.VehicleAppraiser,c={device_type:a,page:s,page_name:i,session_id:n};return V.a.createElement(_i.b,{product:o,linkParams:c,title:"We Want Your Feedback",onClick:t})}Oi.propTypes={onClick:k.a.func.isRequired,deviceType:k.a.oneOf(["mobile","desktop"]),title:k.a.string,pageName:k.a.string,sessionId:k.a.string,disableNpsSurvey:k.a.bool,isEpo:k.a.bool},Oi.defaultProps={deviceType:null,title:null,pageName:null,sessionId:null,disableNpsSurvey:!1,isEpo:!1};const Pi=Object(q.c)(e=>({deviceType:e.mobile?"mobile":"desktop",title:S()(e,"seo.headContent.title")||Ni.c.title,pageName:S()(e,"pageContext.legacy.pageName")||S()(e,"pageContext.page.name"),sessionId:S()(e,"visitor.session"),disableNpsSurvey:S()(e,"featureFlags.disableNpsSurvey")}))(Oi);class Ai extends A.PureComponent{render(){const e=this.props,t=e.getVehicleData,a=e.handleEmailReportClick,i=e.changeStep,n=e.updateStepsState,r=e.totalPrices,l=e.allConditionPricing,o=e.selectedReportType,c=e.stepId,d=e.creativeId,p=e.zipCode,m=e.color,u=e.condition,h=e.mileage,g=e.vin,b=e.emailReportStatus,f=e.resetEmailReportStatus,E=e.isMobile,v=e.isPartnerOfferEligible,y=e.hideDelightedSurvey,C=e.handleDelightedSurveyClick,S=e.showExteriorColor,T=e.showAddEquipment,I=e.showReportPricesOnly,N=e.isEscapeHatch,_=e.licensePlateAndVinProps,O=e.offerType,P=()=>V.a.createElement(ui,{changeStep:i,stepId:c,totalPrices:r,allConditionPricing:l,handleEmailReportClick:a,emailReportStatus:b,resetEmailReportStatus:f,creativeId:d,selectedReportType:o,updateStepsState:n,condition:u,isMobile:E,getVehicleData:t,mileage:h,color:m,vin:g,isPartnerOfferEligible:v,zipCode:p,showExteriorColor:S,showAddEquipment:T,offerType:O,isEscapeHatch:N});return I?P():V.a.createElement(A.Fragment,null,N&&V.a.createElement(L.a,{className:"appraisal-report-step-head"},V.a.createElement(U.a,{xs:12},V.a.createElement(Ii,Object(s.a)({},_,{isMobile:E,isEscapeHatch:N})))),N&&V.a.createElement("div",{className:Re()({"pr-2":!E})},V.a.createElement(Ue,{isMobile:E,className:"mb-2"})),P(),N&&V.a.createElement(A.Fragment,null,V.a.createElement("hr",{className:"my-2"}),V.a.createElement(Ii,Object(s.a)({},_,{isMobile:E,isEscapeHatch:N,isSecondary:!0})),v&&V.a.createElement("hr",{className:"my-2"})),!y&&V.a.createElement(A.Fragment,null,!v&&V.a.createElement("hr",null),V.a.createElement(Pi,{onClick:C})))}}Ai.propTypes={getVehicleData:k.a.func.isRequired,changeStep:k.a.func.isRequired,handleEmailReportClick:k.a.func.isRequired,updateStepsState:k.a.func.isRequired,stepId:k.a.string,creativeId:k.a.string,selectedReportType:k.a.string,zipCode:k.a.string,color:k.a.shape({}),condition:k.a.string,mileage:k.a.string,vin:k.a.string,totalPrices:k.a.shape({}),allConditionPricing:k.a.shape({}),partnerOfferEligibilityResponse:k.a.shape({}),emailReportStatus:k.a.string,resetEmailReportStatus:k.a.func,isMobile:k.a.bool,isPartnerOfferEligible:k.a.bool,hideDelightedSurvey:k.a.bool,handleDelightedSurveyClick:k.a.func,showExteriorColor:k.a.bool,showAddEquipment:k.a.bool,showReportPricesOnly:k.a.bool,isEscapeHatch:k.a.bool,licensePlateAndVinProps:k.a.shape({}),offerType:k.a.string},Ai.defaultProps={stepId:Z.ab,creativeId:Z.g,selectedReportType:Z.kb,zipCode:"",color:{},condition:"",mileage:"",vin:"",emailReportStatus:"",resetEmailReportStatus:b.a,totalPrices:{},allConditionPricing:{},partnerOfferEligibilityResponse:{},isMobile:!1,isPartnerOfferEligible:!1,hideDelightedSurvey:!1,handleDelightedSurveyClick:null,showExteriorColor:!1,showAddEquipment:!1,showReportPricesOnly:!1,isEscapeHatch:!1,licensePlateAndVinProps:{},offerType:""};var Vi=a("../node_modules/lodash/merge.js"),xi=a.n(Vi),ki=a("../node_modules/lodash/assignInWith.js"),wi=a.n(ki),Ri=a("../node_modules/lodash/find.js"),Mi=a.n(Ri),ji=a("../node_modules/lodash/clone.js"),Di=a.n(ji),Li=a("./site-modules/shared/components/map-link/map-link.jsx"),Fi=a("./site-modules/shared/utils/address-format.js"),Ui=a("./site-modules/shared/utils/phone-format.js"),qi=a("./site-modules/shared/components/arrow-link/arrow-link.jsx");a("./site-modules/shared/components/radio-list/radio-list.scss"),a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/nearest-stores/nearest-stores.scss");const zi={creative_id:Z.W,action_name:X.b.ACTION_RECEIVE_EPO,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_USER_INPUT};class Bi extends A.Component{constructor(){super(...arguments),this.state={selectedStore:"",store:{}},this.selectStore=(e=>{let t=e.target.value;const a=this.props.nearestStores,s=Mi()(a,{name:t});this.setState({selectedStore:t}),this.props.updateStore(s),J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_COMPLETED,event_data:Object(i.a)({},zi,{subaction_name:X.b.SUBACTION_DEALER_SELECT_DISTANCE,value:s.distance})})})}static getDerivedStateFromProps(e,t){const a=e.store,s=a&&a.name||"";return t.selectedStore!==s?{selectedStore:s}:null}render(){const e=this.props,t=e.nearestStores,a=e.isSecondary,s=e.store,i=e.appointmentUri,n=e.toggleScheduleAppointmentDrawer,r=this.state.selectedStore,l=e=>V.a.createElement("div",{className:"nearest-stores w-100"},e);if(y()(s)||y()(t))return l(V.a.createElement(Zi,null));const o=s.storeUrl;return l(V.a.createElement(A.Fragment,null,V.a.createElement(hi.a,null),V.a.createElement("div",{className:"mb-1_5"},"You can redeem this offer at any CarMax location. Here are your nearby locations:"),V.a.createElement("div",{className:"nearest-stores-list radio-list"},t.map((e,t)=>{let s=e.id,l=e.name,o=e.addressLine1,c=e.addressLine2,d=e.city,p=e.state,m=e.distance;return V.a.createElement(ta.a,{key:`${s}${a?"-2":""}`,formGroupClassName:Re()("rounded store-wrapper p-0_5 pl-0_75 pos-r",{"active pt-1_75 bg-white":r===l}),labelContainerClassName:"w-100 pos-r pl-0 pr-0_25",name:`${s}${a?"-2":""}`,onChange:this.selectStore,checked:r===l,listItem:{trackingId:"dealer_select",trackingValue:`Dealer ${t+1}`,title:l,hideValue:!0,text:V.a.createElement("div",{className:"size-14 d-flex flex-column"},V.a.createElement("div",{className:"pl-1_25"},r===l&&V.a.createElement("div",{className:"text-uppercase bg-primary text-white text-center font-weight-bold badge"},"Your store"),r!==l&&V.a.createElement("div",{className:"make-store"},"Make this my store"),V.a.createElement("div",{className:"font-weight-bold"},"CarMax ",l),r===l&&V.a.createElement(A.Fragment,null,V.a.createElement("div",null,o),V.a.createElement("div",null,c),r===l&&V.a.createElement("div",{className:"d-flex mt-0_25"},V.a.createElement("div",{className:"phone-link"},V.a.createElement("a",{href:`tel:${Object(Ui.a)(Z.k)}`,"data-tracking-id":"instant_offer_call_dealer","data-tracking-value":Object(Ui.b)(Z.k),className:"text-underline mt-0_25"},Object(Ui.c)(Z.k))),V.a.createElement("span",{className:"text-gray mx-0_25"},"|"),V.a.createElement(Li.a,{location:Object(Fi.b)({street:o,city:d,state:p},l),className:"text-underline",target:"_blank","data-tracking-id":"partner_offer_directions_to_dealer","data-tracking-ignore-value":!0},"Directions"))),V.a.createElement("div",{className:"size-12 text-gray mt-0_25"},m," miles away")),r===l&&V.a.createElement(A.Fragment,null,V.a.createElement("hr",{className:"w-100 mx-0 my-0_5"}),V.a.createElement(qi.a,{className:"size-14 pl-1_25",target:"_blank",to:i,rel:"noopener noreferrer","data-tracking-id":"instant_offer_dealer_site_clickout","data-tracking-value":`Schedule an appointment - location${a?"2":""}`,onClick:n},"Schedule an appointment")))}})})),V.a.createElement("div",{className:"ml-2"},V.a.createElement(qi.a,{className:"mt-0_5 size-14",target:"_blank",to:o,rel:"noopener noreferrer","data-tracking-id":"instant_offer_dealer_site_clickout"},$i.LOCATION))))}}Bi.propTypes={nearestStores:k.a.arrayOf(k.a.shape({id:k.a.string,name:k.a.string,addressLine1:k.a.string,addressLine2:k.a.string,latitude:k.a.number,longitude:k.a.number,message:k.a.string,phone:k.a.string,city:k.a.string,state:k.a.string,zipCode:k.a.string,storeUrl:k.a.string,distance:k.a.number})),isSecondary:k.a.bool,updateStore:k.a.func,store:k.a.shape({name:k.a.string,addressLine1:k.a.string,addressLine2:k.a.string,longitude:k.a.number,latitude:k.a.number,storeUrl:k.a.string}),appointmentUri:k.a.string.isRequired,toggleScheduleAppointmentDrawer:k.a.func},Bi.defaultProps={nearestStores:[],isSecondary:!1,updateStore:b.a,store:{},toggleScheduleAppointmentDrawer:b.a};const $i={MAKE_APPOINTMENT:"Make an appointment",PRINT:"Print Offer",EMAIL:"Email Offer",BY_APPOINTMENT:"By Appointment Only",LOCATION:"View More Locations",SCHEDULE_AN_APPOINTMENT:"Schedule an appointment",SCHEDULE_APPOINTMENT:"Schedule Appointment",CARMAX:"CarMax",TEXT_OFFER:"Text Offer"};function Yi(e){let t=e.appointmentUri,a=e.ctaTextsTracking,s=e.renderNoOffer,i=e.storeUrl,n=e.isMobile,r=e.toggleScheduleAppointmentDrawer,l=t;return s?(l=t||i)?V.a.createElement(ot.a,{color:"success",target:"_blank",className:"heading-5 text-white text-capitalize py-0_75 py-lg-0_5 px-lg-3",href:l,rel:"noopener noreferrer",block:n,"data-tracking-id":"instant_offer_dealer_site_clickout","data-tracking-value":a.SCHEDULE_APPOINTMENT,onClick:r},$i.SCHEDULE_APPOINTMENT):null:l?V.a.createElement(qi.a,{className:"size-14",target:"_blank",to:l,rel:"noopener noreferrer","data-tracking-id":"instant_offer_dealer_site_clickout","data-tracking-value":a.SCHEDULE_APPOINTMENT,onClick:r},$i.SCHEDULE_AN_APPOINTMENT):null}Yi.propTypes={appointmentUri:k.a.string,ctaTextsTracking:k.a.shape({}),renderNoOffer:k.a.bool,storeUrl:k.a.string,isMobile:k.a.bool,toggleScheduleAppointmentDrawer:k.a.func},Yi.defaultProps={appointmentUri:"",ctaTextsTracking:{},renderNoOffer:!1,storeUrl:"",isMobile:!1,toggleScheduleAppointmentDrawer:null};const Hi=(e,t,a)=>{const s=((e,t)=>e||t)(e,a);return V.a.createElement(U.a,{xs:12,className:"text-left size-12 mt-1"},"1 For the safety of our customers and associates, due to the COVID-19 Pandemic, CarMax will fulfill this offer by appointment only.\xa0",s&&V.a.createElement(Ba.a,{className:"appointment-text-link text-primary-darker",target:"_blank",to:s,"data-tracking-id":"partner_schedule_dropoff","data-tracking-value":`${t.MAKE_APPOINTMENT} - legal`},$i.MAKE_APPOINTMENT,"."))};function Zi(e){let t=e.ctaTextsTracking;return V.a.createElement("div",{className:"size-14"},V.a.createElement("div",{className:"mb-0_5"},V.a.createElement(hi.a,null)),V.a.createElement("div",null,"You can redeem this offer at any CarMax location."," ",V.a.createElement("span",{className:"text-primary-darker"},V.a.createElement(Ba.a,{target:"_blank",to:Z.l,rel:"noopener noreferrer","data-tracking-id":"instant_offer_dealer_site_clickout","data-tracking-value":t.LOCATION},"Click here to locate a CarMax near you"))))}function Gi(e){let t=e.appointmentUri,a=e.store,s=e.ctaTextsTracking,i=e.renderNoOffer;const n=e=>V.a.createElement("div",{className:Re()("size-14 text-center",{"text-lg-left":!i})},e);if(y()(a))return n(V.a.createElement(Zi,{ctaTextsTracking:s}));const r=a.name,l=a.addressLine1,o=a.addressLine2,c=a.city,d=a.state,p=a.storeUrl,m=a.message===$i.BY_APPOINTMENT,u=V.a.createElement(A.Fragment,null,m&&V.a.createElement("div",{className:"carmax-appointment-btn d-inline-block my-0_5 p-0_5"},$i.BY_APPOINTMENT,V.a.createElement("sup",null,"1")),V.a.createElement("div",{className:"font-weight-bold"},"CarMax ",r),V.a.createElement("div",null,l),V.a.createElement("div",null,o)),h=l&&c&&d,g=t||p,b=!h&&u;return n(V.a.createElement(A.Fragment,null,g&&i?V.a.createElement("a",{href:g,className:"d-block mb-0_5","data-tracking-id":"instant_offer_dealer_site_clickout",target:"_blank",rel:"noopener noreferrer","data-tracking-value":s.CARMAX},V.a.createElement(hi.a,null)):V.a.createElement("div",{className:"mb-0_5"},V.a.createElement(hi.a,null)),m&&t?V.a.createElement(Ba.a,{target:"_blank",to:t,"data-tracking-id":"partner_schedule_dropoff","data-tracking-value":s.BY_APPOINTMENT},b):b,h&&V.a.createElement(Li.a,{location:Object(Fi.b)({street:l,city:c,state:d},r),className:"text-decoration-none-hover",target:"_blank","data-tracking-id":"partner_offer_directions_to_dealer","data-tracking-ignore-value":!0},u),V.a.createElement("a",{href:`tel:${Object(Ui.a)(Z.k)}`,"data-tracking-id":"instant_offer_call_dealer","data-tracking-value":Object(Ui.b)(Z.k),className:"d-block text-primary-darker"},Object(Ui.c)(Z.k)),V.a.createElement(qi.a,{className:"mt-0_5 size-14",target:"_blank",to:p,rel:"noopener noreferrer","data-tracking-id":"instant_offer_dealer_site_clickout","data-tracking-value":s.LOCATION},$i.LOCATION)))}Zi.propTypes={ctaTextsTracking:k.a.objectOf(k.a.string)},Zi.defaultProps={ctaTextsTracking:$i},Gi.propTypes={appointmentUri:k.a.string,store:k.a.shape({name:k.a.string,addressLine1:k.a.string,addressLine2:k.a.string,city:k.a.string,state:k.a.string,storeUrl:k.a.string}),ctaTextsTracking:k.a.objectOf(k.a.string),renderNoOffer:k.a.bool},Gi.defaultProps={appointmentUri:null,store:{},ctaTextsTracking:$i,renderNoOffer:!1};class Wi extends A.Component{constructor(e){super(e),this.getInstructionSteps=(e=>{return[{header:"Make an appointment with CarMax",body:V.a.createElement(Yi,{appointmentUri:e,ctaTextsTracking:this.ctaTextsTracking,toggleScheduleAppointmentDrawer:this.props.toggleScheduleAppointmentDrawer})},{header:"Bring in offer, vehicle and the following:",body:V.a.createElement("ul",{className:"pl-1 mb-0"},V.a.createElement("li",null,"Title (if it's not with the lien holder)**"),V.a.createElement("li",null,"Valid Registration"),V.a.createElement("li",null,"Valid state-issued photo ID for all titleholders"),V.a.createElement("li",null,"All keys and remotes (if applicable)"))},{header:"We'll verify the vehicle's condition and you'll leave with payment in-hand",body:null}].map((e,t)=>{const a=`epo-instant-offer-instruction-${t}`,s=e.header,i=e.body;return V.a.createElement("div",{key:a,className:"how-to-item pos-r d-flex pb-1"},V.a.createElement("div",{className:"mr-0_5 text-center size-20"},V.a.createElement("span",{className:"step-counter rounded-circle d-inline-block"},t+1)),V.a.createElement("div",{className:"mt-0_25"},V.a.createElement("div",{className:"font-weight-bold"},s),i&&V.a.createElement("div",{className:"mt-0_5"},i)))})}),this.getNearestStores=(()=>{const e=this.props,t=e.appointmentUri,a=e.store,s=e.nearestStores,i=e.isSecondary,n=e.toggleScheduleAppointmentDrawer,r=e.updateStore;return V.a.createElement(Bi,{nearestStores:s,store:a,appointmentUri:t,updateStore:r,toggleScheduleAppointmentDrawer:n,isSecondary:i})}),this.getEmailButton=(()=>{const e=this.props,t=e.handleEmailReportClick;return e.emailReportStatus===Z.u.SENT?V.a.createElement("div",{className:"heading-6 d-flex align-items-center mr-sm-1 flex-column-reverse flex-sm-row"},"Email Sent!",V.a.createElement("i",{className:"icon-checkmark pl-sm-0_25 text-success mb-0_25 mb-sm-0"})):V.a.createElement(ot.a,{color:"link",className:"appraisal-email-report-btn size-16 p-0 mr-sm-1 text-primary-darker d-flex align-items-center flex-column-reverse flex-sm-row",onClick:t,"data-tracking-id":"begin_sign_up","data-tracking-value":this.ctaTextsTracking.EMAIL},V.a.createElement("span",{className:"font-weight-normal text-transform-none"},$i.EMAIL),V.a.createElement("i",{className:"pl-sm-0_25 icon icon-envelop3 text-gray mb-0_25 mb-sm-0"}))}),this.emailAndPrintButtons=(()=>{const e=this.props,t=e.redemptionCertificateUri,a=e.isSecondary,s=e.handleOpenSendToPhoneModal;return V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,className:"d-flex justify-content-around justify-content-sm-center my-1"},a&&this.getEmailButton(),V.a.createElement(Ba.a,{className:"print-offer-btn size-16 mx-sm-1 text-primary-darker d-flex align-items-center flex-column-reverse flex-sm-row",target:"_blank",to:t,"data-tracking-id":"partner_schedule_dropoff","data-tracking-value":this.ctaTextsTracking.PRINT},V.a.createElement("span",null,$i.PRINT),V.a.createElement("i",{className:"pl-sm-0_25 icon icon-printer3 text-gray mb-0_25 mb-sm-0"})),V.a.createElement(ot.a,{color:"link",className:"appraisal-text-offer-btn size-16 p-0 ml-sm-1 text-primary-darker d-flex align-items-center flex-column-reverse flex-sm-row",onClick:s,"data-tracking-id":"partner_send_to_phone","data-tracking-value":this.ctaTextsTracking.TEXT_OFFER},V.a.createElement("span",{className:"font-weight-normal text-transform-none"},$i.TEXT_OFFER),V.a.createElement("i",{className:"pl-sm-0_25 icon-mobile text-gray mb-0_25 mb-sm-0"}))))}),this.ctaTextsTracking=this.props.isSecondary?wi()({},$i,(e,t)=>`${t}2`):Di()($i)}componentDidMount(){const e=this.props,t=e.nearestStores,a=e.store,s=!y()(a)&&Mi()(t,{name:a.name});s&&!this.props.isSecondary&&J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_COMPLETED,event_data:Object(i.a)({},zi,{subaction_name:X.b.SUBACTION_DEFAULT_DEALER_DISTANCE,value:s.distance})})}render(){const e=this.props,t=e.appointmentUri,a=e.store,s=e.isMobile,i=a&&a.message===$i.BY_APPOINTMENT;return V.a.createElement("div",{className:"instant-offer-partner-next-steps"},!s&&V.a.createElement("div",{className:"mt-0_5"},this.emailAndPrintButtons()),s?V.a.createElement(L.a,{className:"text-gray-darker px-lg-1 justify-content-center justify-content-lg-between"},V.a.createElement(U.a,{xs:12},V.a.createElement("div",{className:"heading-4 mt-1_5"},"How to Redeem Your Offer")),V.a.createElement(U.a,{xs:12,sm:8,lg:7,className:"size-14 text-center mt-1_5"},V.a.createElement("div",{className:"d-inline-block text-left"},this.getInstructionSteps(t))),V.a.createElement(U.a,{xs:12,lg:6,xl:5,className:"mb-1_5"},s&&this.emailAndPrintButtons(),V.a.createElement("div",{className:"mt-1"},this.getNearestStores()))):V.a.createElement(L.a,{className:"text-gray-darker px-lg-1 justify-content-center justify-content-lg-between flex-column-reverse flex-md-row"},V.a.createElement(U.a,{xs:12,sm:8,lg:6},V.a.createElement("div",{className:"heading-4 my-1_5"},"How to Redeem Your Offer"),V.a.createElement("div",{className:"d-inline-block text-left size-14"},this.getInstructionSteps(t))),V.a.createElement(U.a,{xs:12,lg:6,xl:5,className:"my-1_5"},this.getNearestStores())),V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,className:"size-12 mb-1"},"*The offer from CarMax is contingent on your providing accurate information on Edmunds.com. CarMax will conduct an in-person verification of your vehicle and evaluate other vehicle use and history information prior to finalizing the offer. Any differences between the information you provide about your vehicle and the vehicle's actual condition, use, and history may impact the offer you receive from CarMax."),V.a.createElement(U.a,{xs:12,className:"size-12"},"**The title must be provided at the time of sale and all titleholders should be present. If a previously paid-off lien is listed on the title, you will need both the title and lien release from the lienholder before CarMax can purchase your car."),i&&Hi(t,this.ctaTextsTracking)))}}function Qi(e){const t=e.store,a=e.isMobile,s=e.eval2657Recipe,i=e.appointmentUri,n=e.isSecondary,r=e.renderNoOffer,l=e.toggleScheduleAppointmentDrawer,o=t||{},c=o.message,d=o.storeUrl,p=c===$i.BY_APPOINTMENT,m=wi()({},$i,(e,t)=>`${t}${r?" CarMax":""}${n?"2":""}`);return V.a.createElement(A.Fragment,null,V.a.createElement(Gi,{appointmentUri:i,store:t,ctaTextsTracking:m,renderNoOffer:r}),V.a.createElement("div",{className:"mt-1"},"chal"===s?V.a.createElement(Yi,{appointmentUri:i,ctaTextsTracking:m,renderNoOffer:r,storeUrl:d,isMobile:a,toggleScheduleAppointmentDrawer:l}):V.a.createElement(Yi,{appointmentUri:i,ctaTextsTracking:m,renderNoOffer:r,storeUrl:d,isMobile:a})),p&&Hi(i,m,d))}Wi.propTypes={appointmentUri:k.a.string.isRequired,redemptionCertificateUri:k.a.string.isRequired,nearestStores:k.a.arrayOf(k.a.shape({})),store:k.a.shape({name:k.a.string,addressLine1:k.a.string,addressLine2:k.a.string,longitude:k.a.number,latitude:k.a.number}),handleEmailReportClick:k.a.func.isRequired,emailReportStatus:k.a.string,isSecondary:k.a.bool,isMobile:k.a.bool,toggleScheduleAppointmentDrawer:k.a.func,updateStore:k.a.func,handleOpenSendToPhoneModal:k.a.func},Wi.defaultProps={emailReportStatus:"",isSecondary:!1,isMobile:!1,toggleScheduleAppointmentDrawer:null,store:{},updateStore:b.a,nearestStores:[],handleOpenSendToPhoneModal:b.a},Qi.propTypes={renderNoOffer:k.a.bool,store:k.a.shape({}),isMobile:k.a.bool,eval2657Recipe:k.a.string,conditionPricing:k.a.shape({}),appointmentUri:k.a.string,isSecondary:k.a.bool,toggleScheduleAppointmentDrawer:k.a.func},Qi.defaultProps={renderNoOffer:!1,store:{},isMobile:!1,eval2657Recipe:"ctrl",conditionPricing:{},appointmentUri:null,isSecondary:!1,toggleScheduleAppointmentDrawer:b.a};var Ki=a("../node_modules/lodash/compact.js"),Xi=a.n(Ki),Ji=a("./site-modules/shared/utils/core-link-constructor.js"),en=a("./site-modules/shared/utils/build-and-price-link-constructor.js"),tn=a("./site-modules/shared/utils/srp-link-constructor.js");function an(e){let t=e.getVehicleData,a=e.toggleAppraiserDrawer;const s=t(),i=s.makeName,n=s.modelName,r=s.year,l=s.modelSlug,o=s.makeSlug,c=s.publicationState;return 5!==Xi()([i,n,r,l,o]).length?null:V.a.createElement("div",null,V.a.createElement("h3",{className:"heading-4 mb-1"},"Learn more about the ",r," ",i," ",n),V.a.createElement("ul",{className:"list-unstyled"},V.a.createElement("li",{className:"mb-1"},V.a.createElement(Ba.a,{to:Object(Ji.b)({makeSlug:o,modelSlug:l}),className:"text-primary-darker"},"Read Reviews for the ",i," ",n)),[Fs.a.NEW,Fs.a.NEW_USED].includes(c)&&V.a.createElement("li",{className:"mb-1"},V.a.createElement(Ba.a,{to:Object(en.a)({make:o,model:l,year:r}),className:"text-primary-darker"},"Build & Price a New ",i," ",n)),V.a.createElement("li",{className:"mb-1"},V.a.createElement(Ba.a,{to:Object(tn.p)({make:o,model:l}),className:"text-primary-darker"},"Browse Inventory for a ",i," ",n," near you")),V.a.createElement("li",null,a?V.a.createElement(ot.a,{color:"default",className:"text-primary-darker bg-white p-0 m-0 text-capitalize size-16 border-0",onClick:a},"Start Over"):V.a.createElement(Ba.a,{to:Ya.b.APPRAISAL_LANDING,className:"text-primary-darker"},"Start Over"))))}an.propTypes={getVehicleData:k.a.func.isRequired,toggleAppraiserDrawer:k.a.func},an.defaultProps={toggleAppraiserDrawer:null};a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-error-message.scss");class sn extends A.Component{componentDidMount(){const e=this.props,t=e.vin;e.isExtendedReport&&J.a.fireTrackAction(Z.eb),t&&J.a.fireTrackAction(xi()({},Z.eb,{event_data:{subaction_name:X.b.SUBACTION_VIN_ERROR,value:`${this.props.vin}_${X.b.SUBACTION_EPO_OFFER}_TMV_REPORT_ERROR`}}))}render(){const e=this.props,t=e.getVehicleData,a=e.isMobile,s=e.appointmentUri,i=e.conditionPricing,n=e.eval2657Recipe,r=e.partnerOfferEligibilityResponse,l=e.toggleScheduleAppointmentDrawer,o=e.isExtendedReport,c=e.toggleAppraiserDrawer;return V.a.createElement("div",{"data-tracking-parent":Z.U},V.a.createElement("div",{className:Re()("appraisal-report-error-message text-gray-darker text-center pt-2_5 pb-1_5 px-2 mb-2")},V.a.createElement("span",{className:"icon-edmunds-car text-primary size-30"}),V.a.createElement("h2",{className:"size-24"},"We're sorry. We are unable to generate an appraisal report for your car at this time."),o&&V.a.createElement(A.Fragment,null,V.a.createElement("p",{className:"size-16 mb-2"},"You can still schedule an appointment with CarMax to sell your car."),V.a.createElement(Qi,{appointmentUri:s,conditionPricing:i,eval2657Recipe:n,isMobile:a,store:r.store,renderNoOffer:!0,toggleScheduleAppointmentDrawer:l}))),V.a.createElement(an,{getVehicleData:t,toggleAppraiserDrawer:c}))}}sn.propTypes={getVehicleData:k.a.func.isRequired,partnerOfferEligibilityResponse:k.a.shape({}),isMobile:k.a.bool,isExtendedReport:k.a.bool,eval2657Recipe:k.a.string,conditionPricing:k.a.shape({}),appointmentUri:k.a.string,vin:k.a.string,toggleScheduleAppointmentDrawer:k.a.func,toggleAppraiserDrawer:k.a.func},sn.defaultProps={partnerOfferEligibilityResponse:{},isMobile:!1,isExtendedReport:!1,eval2657Recipe:"ctrl",vin:"",conditionPricing:{},appointmentUri:null,toggleScheduleAppointmentDrawer:b.a,toggleAppraiserDrawer:null};a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/appraisal-report-step/appraisal-report-step.scss");class nn extends A.Component{constructor(){super(...arguments),this.state={nationalPrices:{},regionalPrices:{},colorPrices:{},optionalPrices:{},totalPrices:{},mileagePrices:{},conditionPrices:{},isLoading:!0,optionalPricesValues:[],allConditionPricing:{},isTradeInCalculated:!1,conditionPricing:{}},this.getPriceList=(()=>{const e=this.state,t=e.nationalPrices,a=e.regionalPrices,s=e.totalPrices,n=e.mileagePrices,r=e.colorPrices,l=e.conditionPrices,o=e.optionalPrices,c=e.optionalPricesValues,d=this.props.isExtendedReport;return[Object(i.a)({},Z.X.NATIONAL_BASE,{value:t}),Object(i.a)({},Z.X.OPTIONAL_EQUIPMENT,{value:o,values:c}),Object(i.a)({},Z.X.COLOR_ADJUSTMENT,{value:r}),Object(i.a)({},Z.X.REGIONAL_ADJUSTMENT,{value:a}),Object(i.a)({},Z.X.MILEAGE_ADJUSTMENT,{value:n}),Object(i.a)({},Z.X.CONDITION_ADJUSTMENT,{value:l}),{title:d?"Value":"Value at Time of Build",value:s,isTotal:!0}]}),this.getAppraisalReportEditControls=(()=>{const e=this.props,t=e.color,a=e.options,s=e.hasPartnerEquipment,i=e.showAddEquipment;return{showExteriorColor:0!==Object.keys(t).length,showAddEquipment:i&&s&&0===a.length}}),this.initialize=(()=>{const e=this.props,t=e.resetEmailReportStatus,a=e.onReportFormed;t(),this.calculateTradeIn(),a(!0,Z.ab)}),this.resetIsTradeInCalculated=(()=>this.setState({isTradeInCalculated:!1})),this.calculateTradeIn=(()=>{const e=this.props,t=e.condition,a=e.options,s=e.creativeId,n=e.tmvConditions,r=Te(t,n,a),l=Ce(n);this.setState(Object(i.a)({},r,{allConditionPricing:Ie(n,a),isTradeInCalculated:!0,conditionPricing:l}),()=>{const e=this.props,t=e.isExtendedReport,a=e.updateStepsState,r=e.vehiclePhoto,l=this.state,o=l.totalPrices,c=l.certifiedUsedPrice,d=l.allConditionPricing,p=l.nationalPrices,m=!!o[Z.kb],u=!y()(p),h=Ne(d);m&&a("allConditionTotalPrices",h),t&&!y()(o)&&u?(J.a.fireTrackAction(Object(Z.bb)(s)),a("appraisalEmailData",Object(i.a)({},this.state,{certifiedUsedPrice:c,vehiclePhoto:r,tmvConditions:n}))):m&&u||J.a.fireTrackAction(Object(Z.I)(s))})}),this.displayReport=(()=>{const e=this.props,t=e.getVehicleData,a=e.onPayoffChange,i=e.changeStep,n=e.sellingPrice,r=e.msrp,l=e.residualValue,o=e.isPurchase,c=e.isUsed,d=e.vehiclePhoto,p=e.color,m=e.condition,u=e.mileage,h=e.zipCode,g=this.state.totalPrices;return V.a.createElement(Gs,Object(s.a)({getVehicleData:t,changeStep:i,onPayoffChange:a,priceList:this.getPriceList(),totalPrices:g,sellingPrice:n,msrp:r,residualValue:l,isPurchase:o,isUsed:c,vehiclePhoto:d,color:p,condition:m,mileage:u,zipCode:h},this.getAppraisalReportEditControls()))}),this.displayExtendedReport=(()=>{const e=this.props,t=e.getVehicleData,a=e.handleEmailReportClick,i=e.changeStep,n=e.updateStepsState,r=e.selectedReportType,l=e.stepId,o=e.stepNextId,c=e.creativeId,d=e.zipCode,p=e.color,m=e.options,u=e.condition,h=e.mileage,g=e.vin,b=e.emailReportStatus,f=e.resetEmailReportStatus,E=e.isMobile,v=e.isPartnerOfferEligible,y=e.hideDelightedSurvey,C=e.handleDelightedSurveyClick,S=e.partnerOfferEligibilityResponse,T=e.showReportExtendedPriceOnly,I=e.isEscapeHatch,N=e.licensePlateAndVinProps,_=e.offerType,O=this.state,P=O.totalPrices,A=O.allConditionPricing;return V.a.createElement(Ai,Object(s.a)({getVehicleData:t,changeStep:i,updateStepsState:n,handleEmailReportClick:a,totalPrices:P,allConditionPricing:A,selectedReportType:r,stepId:l,stepNextId:o,creativeId:c,zipCode:d,color:p,options:m,condition:u,mileage:h,vin:g,partnerOfferEligibilityResponse:S,emailReportStatus:b,resetEmailReportStatus:f,isMobile:E,isPartnerOfferEligible:v,hideDelightedSurvey:y,handleDelightedSurveyClick:C,showReportPricesOnly:T},this.getAppraisalReportEditControls(),{isEscapeHatch:I,licensePlateAndVinProps:N,offerType:_}))})}static getDerivedStateFromProps(e){return{isLoading:o()(e.tmvConditions)}}componentDidMount(){this.props.isReportActive&&this.initialize()}componentDidUpdate(e){const t=this.props,a=t.isReportActive,s=t.tmvConditions,i=this.state.isTradeInCalculated,n=!m()(s,e.tmvConditions);!a||h()(s)||i&&!n||this.initialize(),!a&&i&&!h()(s)&&n&&this.resetIsTradeInCalculated()}render(){const e=this.state,t=e.totalPrices,a=e.isLoading,s=e.nationalPrices,i=e.conditionPricing,n=e.isTradeInCalculated,r=this.props,l=r.getVehicleData,o=r.isExtendedReport,c=r.creativeId,d=r.renderNoAppraisalReportMessage,p=r.partnerOfferEligibilityResponse,m=r.isMobile,u=r.toggleScheduleAppointmentDrawer,h=r.vin,g=r.isReportActive,b=r.toggleAppraiserDrawer,f=r.isEscapeHatch,E=l(),v=E.makeName,C=E.modelName,S=E.year,T=(o&&!y()(t)||t[Z.kb])&&!y()(s),I=o?this.displayExtendedReport():this.displayReport();d&&d(!T);const N=T?V.a.createElement("div",{"data-tracking-parent":c},V.a.createElement("div",{className:Re()("appraisal-report-step",{"mx-md-1_5":f})},I)):V.a.createElement(A.Fragment,null,g&&n&&V.a.createElement(sn,{getVehicleData:l,partnerOfferEligibilityResponse:p,isMobile:m,vin:h,isExtendedReport:o,conditionPricing:i,toggleScheduleAppointmentDrawer:u,toggleAppraiserDrawer:b}));return V.a.createElement(xs.a,{isLoading:a},a?V.a.createElement("div",{className:"display-2"},"Calculating appraisal for your ",S," ",v," ",C,"!"):N)}}nn.propTypes={stepId:k.a.string,onReportFormed:k.a.func.isRequired,updateStepsState:k.a.func.isRequired,handleEmailReportClick:k.a.func.isRequired,getVehicleData:k.a.func.isRequired,toggleAppraiserDrawer:k.a.func,vehiclePhoto:k.a.string,zipCode:k.a.string,mileage:k.a.string,condition:k.a.string,vin:k.a.string,options:k.a.arrayOf(k.a.shape({})),color:k.a.shape({}),partnerOfferEligibilityResponse:k.a.shape({}),isReportActive:k.a.bool,isMobile:k.a.bool,isExtendedReport:k.a.bool,emailReportStatus:k.a.string,resetEmailReportStatus:k.a.func,stepNextId:k.a.string,isPartnerOfferEligible:k.a.bool,hideDelightedSurvey:k.a.bool,handleDelightedSurveyClick:k.a.func,onPayoffChange:k.a.func.isRequired,isPurchase:k.a.bool,showReportExtendedPriceOnly:k.a.bool,sellingPrice:k.a.number,msrp:k.a.number,residualValue:k.a.number,isUsed:k.a.bool,selectedReportType:k.a.string,creativeId:k.a.string,tmvConditions:k.a.shape({}),hasPartnerEquipment:k.a.bool,changeStep:k.a.func,renderNoAppraisalReportMessage:k.a.func,toggleScheduleAppointmentDrawer:k.a.func,isEscapeHatch:k.a.bool,licensePlateAndVinProps:k.a.shape({}),showAddEquipment:k.a.bool,offerType:k.a.string},nn.defaultProps={stepId:Z.ab,vehiclePhoto:"",resetEmailReportStatus:b.a,toggleScheduleAppointmentDrawer:b.a,toggleAppraiserDrawer:null,zipCode:"",mileage:"",vin:"",condition:"",options:[],color:{},partnerOfferEligibilityResponse:{},isReportActive:!1,isMobile:!1,isExtendedReport:!1,emailReportStatus:"",stepNextId:"",isPartnerOfferEligible:!1,hideDelightedSurvey:!1,handleDelightedSurveyClick:null,isPurchase:!1,showReportExtendedPriceOnly:!1,sellingPrice:0,msrp:0,residualValue:0,isUsed:!1,selectedReportType:Z.kb,creativeId:Z.g,tmvConditions:null,hasPartnerEquipment:!1,changeStep:b.a,renderNoAppraisalReportMessage:null,isEscapeHatch:!1,licensePlateAndVinProps:{},showAddEquipment:!0,offerType:""};const rn={vehiclePhoto:Object(B.a)(e=>{const t=(0,e.getVehicleData)().styleId;return t?`styles.${t}.photo`:""},ee.c)},ln=Object(q.c)((e,t)=>{const a=t.getVehicleData().styleId;return{tmvConditions:S()(e.vehicle,Object(ee.C)(a))}})(Object(B.b)(nn,rn));var on=a("../node_modules/lodash/map.js"),cn=a.n(on),dn=a("../node_modules/lodash/groupBy.js"),pn=a.n(dn),mn=a("../node_modules/lodash/pick.js"),un=a.n(mn),hn=a("../node_modules/lodash/omit.js"),gn=a.n(hn),bn=a("../node_modules/lodash/cloneDeep.js"),fn=a.n(bn);const En={ADD:"add",REMOVE:"remove"},vn={SINGLE:"single",MULTIPLE:"multiple"};a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/offer-conditions-step/radio-group/radio-group.scss");function yn(e){let t=e.onChange,a=e.answers,s=e.selected,i=e.trackingId,n=e.name,r=e.title,l=e.className,c=e.labelTextClassName;const d=new Map;return a.forEach(e=>{let t=e.detailQuestions;o()(t)||t.forEach(e=>{let t=e.id,a=e.answerType;d.set(`${t}`,a)})}),V.a.createElement("div",{className:Re()("conditions-questions-radio-group question",l)},r&&V.a.createElement(Ft.a,{className:"text-gray-darker mb-1"},r),V.a.createElement(It.a,{className:"d-flex","data-toggle":"buttons",role:"radiogroup","aria-label":r},a.map(e=>{let a=e.id,r=e.desc,l=e.detailQuestions;const p=`condition-question-selection-${n}-${a}`,m=(e=>e===s)(a);return V.a.createElement(ot.a,{key:p,tag:Ft.a,for:p,outline:!m,size:"responsive",color:m?"primary":"secondary",className:Re()("radio-group-button d-flex align-items-center justify-content-center mb-0 py-0_25",{active:m,"bg-white text-gray-darker":!m})},V.a.createElement(qt.a,{"data-tracking-id":i,"data-tracking-value":r,type:"radio",id:p,name:n,value:a,onChange:function(){const e={detailQuestionsAnswerTypeById:d,actionType:o()(l)?En.REMOVE:En.ADD};t({name:n,value:a,action:e})},checked:m,className:"condition-question-input"}),V.a.createElement("span",{className:Re()("font-weight-normal",c)},r))})))}yn.propTypes={onChange:k.a.func.isRequired,answers:k.a.arrayOf(k.a.shape({id:k.a.oneOfType([k.a.string,k.a.number]),desc:k.a.string})).isRequired,name:k.a.oneOfType([k.a.number,k.a.string]).isRequired,selected:k.a.oneOfType([k.a.number,k.a.string]),title:k.a.string,trackingId:k.a.string,className:k.a.string,labelTextClassName:k.a.string},yn.defaultProps={selected:"",title:"",trackingId:"",className:"",labelTextClassName:""};var Cn=a("./site-modules/shared/components/checkbox/checkbox.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/offer-conditions-step/checkbox-list/checkbox-list.scss");const Sn=/\(select all that apply\)/gi;function Tn(e){let t=e.onChange,a=e.name,s=e.title,i=e.answers,n=e.selected,r=e.className;const l=Sn.test(s);return V.a.createElement("div",{className:Re()("conditions-questions-checkbox-list question",r)},V.a.createElement("div",{className:"text-gray-darker mb-1"},s.replace(Sn,""),l&&V.a.createElement("span",{className:"small text-gray-dark"},"Select all that apply")),i.map(e=>{let s=e.id,i=e.desc;const r=`condition-question-selection-${a}-${s}`,l=n[s]||!1;return V.a.createElement("div",{className:"mb-1",key:r},V.a.createElement(Cn.a,{id:r,name:a,value:s,onChange:function(e){const i=e.target.checked;t({name:a,value:s,isSelected:i})},checked:l,labelClassName:"condition-question-input",labelText:i,textLabelClassName:"text-gray-darker pl-1_75"}))}))}Tn.propTypes={onChange:k.a.func.isRequired,answers:k.a.arrayOf(k.a.shape({id:k.a.oneOfType([k.a.string,k.a.number]),desc:k.a.string})).isRequired,name:k.a.oneOfType([k.a.string,k.a.number]).isRequired,title:k.a.string,selected:k.a.shape({id:k.a.bool}),className:k.a.string},Tn.defaultProps={title:"",selected:{},className:""};const In={"exterior--paint-body-work":{v2QuestionId:300,v2AnswerIdsByV1Value:{0:1,1:2,2:3,3:4}},"interior--broken-parts":{v2QuestionId:410,v2AnswerIdsByV1Value:{0:1,1:2,2:3,3:4}},"interior--fabric-issues":{v2QuestionId:420,v2AnswerIdsByV1Value:{0:1,1:2,2:3,3:4}},tires:{v2QuestionId:500,v2AnswerIdsByV1Value:{0:1,2:2,4:3}},keys:{v2QuestionId:600,v2AnswerIdsByV1Value:{1:2,2:1}},"mechanical--odometer-untrusted":{v2QuestionId:1e3,v2AnswerIdsByV1Value:{false:1,true:2}},"other--odor":{v2QuestionId:830,v2AnswerIdsByV1Value:{false:1,true:2}},"accidents--minor":{v2QuestionId:110,v2AnswerIdsByV1Value:{0:1,1:2,2:3},v2ParentQuestionId:100,v2ParentAnswerId:2},"accidents--major":{v2QuestionId:120,v2AnswerIdsByV1Value:{0:1,1:2,2:3},v2ParentQuestionId:100,v2ParentAnswerId:2},"mechanical--inoperable":{v2QuestionId:210,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:200,v2ParentAnswerId:2},"mechanical--engine":{v2QuestionId:220,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:200,v2ParentAnswerId:2},"mechanical--transmission":{v2QuestionId:230,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:200,v2ParentAnswerId:2},"after-market--suspension":{v2QuestionId:710,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:700,v2ParentAnswerId:2},"after-market--engine":{v2QuestionId:720,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:700,v2ParentAnswerId:2},"other--convertible-top":{v2QuestionId:810,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:800,v2ParentAnswerId:2},"other--air-conditioning":{v2QuestionId:820,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:800,v2ParentAnswerId:2},"other--missing-standard-equipment":{v2QuestionId:840,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:800,v2ParentAnswerId:2},"frame-damage":{v2QuestionId:910,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:900,v2ParentAnswerId:2},"flood-damage":{v2QuestionId:920,v2AnswerIdsByV1Value:{false:1,true:2},v2ParentQuestionId:900,v2ParentAnswerId:2},"mechanical--check-engine-light":{v2QuestionId:240,v2AnswerIdsByV1Value:{index:1},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"},"mechanical--4x4-service":{v2QuestionId:240,v2AnswerIdsByV1Value:{index:2},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"},"mechanical--check-brakes-light":{v2QuestionId:240,v2AnswerIdsByV1Value:{index:3},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"},"mechanical--other-warning-light":{v2QuestionId:240,v2AnswerIdsByV1Value:{index:4},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"},"mechanical--brakes":{v2QuestionId:251,v2AnswerIdsByV1Value:{index:1},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"},"mechanical--steering":{v2QuestionId:251,v2AnswerIdsByV1Value:{index:2},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"},"mechanical--suspension":{v2QuestionId:251,v2AnswerIdsByV1Value:{index:3},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"},"mechanical--other":{v2QuestionId:251,v2AnswerIdsByV1Value:{index:4},v2ParentQuestionId:200,v2ParentAnswerId:2,answerType:"multiple"}};a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/offer-conditions-step/offer-conditions-step.scss");const Nn=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;const n=e.name,r=t.name,l=a.year;return 4===Xi()([n,r,l,s||i]).length};function _n(e){return e===vn.MULTIPLE?{}:1}class On extends A.Component{constructor(){var e;e=super(...arguments),this.state={offerPayload:{},questionsAnswered:{}},this.onAnswerSelect=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.state,s=a.offerPayload,i=a.questionsAnswered,n={},r=t.actionType,l=t.detailQuestionsAnswerTypeById,o=void 0===l?new Map:l,c=Array.from(o.keys());switch(r){case En.ADD:Object.keys(s).concat(c).forEach(e=>{const t=o.get(e)===vn.MULTIPLE?{}:void 0;n[e]=i[e]||s[e]||t});break;case En.REMOVE:Object.keys(gn()(s,c)).forEach(e=>{n[e]=i[e]||s[e]});break;default:Object.keys(s).forEach(e=>{n[e]=i[e]||s[e]})}e.setState({offerPayload:n})},this.handleSelect=(e=>{const t=e.name,a=e.value,s=e.isSelected;this.setState(e=>{let i=e.questionsAnswered;const n=fn()(i);return n[t]||(n[t]={}),n[t][a]=s,{questionsAnswered:n}},()=>this.onAnswerSelect())}),this.handleChange=(e=>{const t=e.name,a=e.value,s=e.action;this.setState(e=>{let s=e.questionsAnswered;return{questionsAnswered:Object(i.a)({},s,{[t]:a})}},()=>this.onAnswerSelect(s))}),this.renderDetailQuestions=(e=>{const t=this.state.questionsAnswered;return y()(e)?null:V.a.createElement(A.Fragment,null,e.map(e=>{const a=e.id,s=e.desc,i=e.answers,n=e.answerType,r=t[a],l=`detail-question-${a}`;switch(n){case vn.MULTIPLE:return V.a.createElement(xt.a,{key:l},V.a.createElement(Tn,{onChange:this.handleSelect,title:s,answers:i,name:a,selected:r}));default:return V.a.createElement(xt.a,{key:l},V.a.createElement(yn,{onChange:this.handleChange,title:s,answers:i,name:a,selected:r,labelTextClassName:"text-transform-none"}))}}))}),this.renderFieldError=(e=>{const t=this.props.errorMap,a=this.state.offerPayload,s=t.get(le.b);if(!s)return null;const i=s.singleQuestionErrorMessage,n=s.multipleQuestionsErrorMessage,r=e.map(e=>{return`${e.id}`}),l=r.length>1,o=un()(a,r),c=r.every(e=>o[e]),d=e.reduce((e,t)=>{let s=t.id,i=t.answers;const n=a[s],r=i.find(e=>e.id===n);return r?e.concat(r):e},[]).reduce((e,t)=>{let a=t.detailQuestions;return a?e.concat(a.map(e=>{return`${e.id}`})):e},[]),p=un()(a,d),m=d.every(e=>p[e]);let u="";return c?m||(u=n):u=l?n:i,V.a.createElement(Yt.a,{id:`conditionsQuestionsSection-error-${Object(zt.c)()}`,classes:"mb-0_5",error:u})})}static getDerivedStateFromProps(e,t){const a=e.conditionsQuestions.questionsUngrouped,s=e.isStepActive,i=e.vinEligibility,n=t.offerPayload,r=t.questionsAnswered;if(!y()(a)&&y()(n)){const e={};return a.forEach(t=>{const a=t.id,s=t.answerType;t.answerType===vn.MULTIPLE?e[a]=r[a]||_n(s):e[a]=r[a]}),{offerPayload:e}}if(s&&y()(r)&&i&&!y()(i.lastConditionQuestionResponses)){const e=i.lastConditionQuestionResponses,t={};return Object.keys(e).forEach(a=>{const s=e[a],i=In[a],n=i.v2QuestionId,r=i.v2AnswerIdsByV1Value,l=i.v2ParentQuestionId,o=i.v2ParentAnswerId,c=i.answerType;if(l&&!t[l]&&(t[l]=o),c===vn.MULTIPLE){const e=t[n]||_n(c);e[r.index]=!0,t[n]=e}else t[n]=r[s]}),a.forEach(e=>{let a=e.id,s=e.answerType;t[a]||(t[a]=_n(s))}),{questionsAnswered:t,offerPayload:t}}return null}shouldComponentUpdate(e,t){const a=this.props,s=a.conditionsQuestions,i=a.vinEligibility,n=a.isStepActive,r=a.errorMap,l=this.state,o=l.questionsAnswered,c=l.offerPayload;return!(e.isStepActive===n&&m()(e.conditionsQuestions,s)&&m()(e.vinEligibility,i)&&m()(e.errorMap,r)&&m()(t.offerPayload,c)&&m()(t.questionsAnswered,o))}componentDidUpdate(e,t){const a=this.props,s=a.vinEligibility,i=a.updateQuestionnaireResponses,n=a.onPartnerOfferVinEligibilityUpdate,r=a.vehicle,l=a.isVinFromDrawer,o=a.isStepActive,c=a.predefinedVin,d=this.state.offerPayload,p=r.make,u=r.model,h=r.year,g=o!==e.isStepActive,b=d!==t.offerPayload;!Nn(p,u,h,c,l)||y()(s)||m()(s,e.vinEligibility)||n(s.isEligibleVin),o&&(g||b)&&i(d)}render(){const e=this.props.conditionsQuestions,t=e.questionsUngrouped,a=e.questionsGroupedByCategory,s=this.state.questionsAnswered;return V.a.createElement(L.a,{className:"offer-conditions-step"},!t||t&&!t.length?V.a.createElement(U.a,{xs:12,className:"display-3 px-0"},"We don't have any more questions about your vehicle's condition. Please continue to the next step."):V.a.createElement(U.a,{xs:12,className:"conditions-questions"},cn()(a,(e,t)=>V.a.createElement("div",{className:"questions-section",key:`questions-section-${t}`},t&&V.a.createElement("div",{className:"text-gray-darker mb-0_5 font-weight-bold"},t),this.renderFieldError(e),e.map(e=>{const t=e.id,a=e.desc,i=e.answers,n=s[t],r=(Mi()(i,["id",n])||[]).detailQuestions;switch(e.answerType){case vn.MULTIPLE:return V.a.createElement(xt.a,{key:`parent-question-${t}`},V.a.createElement(Tn,{onChange:this.handleSelect,title:a,answers:i,name:t,selected:n}));default:return V.a.createElement(A.Fragment,{key:`parent-question-${t}`},V.a.createElement(xt.a,{key:`parent-question-${t}`},V.a.createElement(yn,{onChange:this.handleChange,title:a,answers:i,name:t,selected:n,labelTextClassName:"text-transform-none"})),this.renderDetailQuestions(r))}})))))}}On.propTypes={updateQuestionnaireResponses:k.a.func.isRequired,onPartnerOfferVinEligibilityUpdate:k.a.func,conditionsQuestions:k.a.shape({questionsUngrouped:kt.a.ConditionsQuestions,questionsGroupedByCategory:k.a.shape({[k.a.string]:kt.a.ConditionsQuestions})}),vinEligibility:kt.a.VinEligibility,errorMap:k.a.objectOf(k.a.shape({})),isStepActive:k.a.bool,vehicle:k.a.shape({make:k.a.shape({name:k.a.string}),model:k.a.shape({name:k.a.string}),year:k.a.shape({year:k.a.string})}),location:k.a.shape({}),isVinFromDrawer:k.a.bool,predefinedVin:k.a.string},On.defaultProps={conditionsQuestions:{questionsUngrouped:[],questionsGroupedByCategory:{}},vinEligibility:null,errorMap:new Map,isStepActive:!1,onPartnerOfferVinEligibilityUpdate:b.a,vehicle:{},location:null,isVinFromDrawer:!1,predefinedVin:""};const Pn={conditionsQuestions:Object(B.a)(e=>{let t=e.location;return Object(kt.f)(t)},kt.b,e=>({questionsUngrouped:e,questionsGroupedByCategory:pn()(e,"category")})),vinEligibility:Object(B.a)(e=>{let t=e.vehicle,a=t.make,s=t.model,i=t.year,n=e.vin,r=e.isEligibleHardcodeYmmBypass,l=e.isStepActive,o=e.predefinedVin,c=e.isVinFromDrawer;return l||Nn(a,s,i,o,c)?Object(kt.e)({vin:n||o,make:a.name,model:s.name,year:i.year,isEligibleHardcodeYmmBypass:r}):null},kt.b)},An=Object(q.c)(e=>({location:S()(e,"pageContext.location")}))(Object(B.b)(On,Pn));var Vn=a("../node_modules/create-hmac/browser.js"),xn=a.n(Vn);a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/epo-processing/epo-processing.scss");const kn=[{successStateKey:"isProcessing",copy:"Processing your vehicle information"},{successStateKey:"isAnalyzing",copy:"Analyzing thousands of local transactions"},{successStateKey:"isPreparing",copy:"Searching for a no-obligation offer on your car"}],wn=e=>e?{processing:1150,analyzing:1750,preparing:3e3,completed:3500}:{processing:350,analyzing:500,preparing:850,completed:1e3};class Rn extends A.Component{constructor(e){super(e),this.state={isAnalyzing:!1,isProcessing:!1,isPreparing:!1},this.setProcessing=(()=>this.setState({isProcessing:!0})),this.setAnalyzing=(()=>this.setState({isAnalyzing:!0})),this.setPreparing=(()=>this.setState({isPreparing:!0}));const t=e.isMobile,a=wn(t),s=a.processing,i=a.analyzing,n=a.preparing,r=a.completed;this.processingTimeout=I()(this.setProcessing,s),this.analyzingTimeout=I()(this.setAnalyzing,i),this.preparingTimeout=I()(this.setPreparing,n),this.completedTimeout=I()(this.props.setLoadingStatus,r)}componentDidMount(){this.processingTimeout(),this.analyzingTimeout()}componentDidUpdate(e){const t=this.props.isSubmittingFinished;t&&e.isSubmittingFinished!==t&&(this.preparingTimeout(),this.completedTimeout())}componentWllUnmount(){this.analyzingTimeout.cancel(),this.processingTimeout.cancel(),this.completedTimeout.cancel(),this.completedTimeout.cancel()}render(){const e=this.props.className;return V.a.createElement("div",{className:Re()("epo-processing mx-auto",e)},V.a.createElement("div",{className:"mb-3"},V.a.createElement("div",{className:"instant-offer-animated-cash mx-auto",style:{background:`url(${Object(He.q)("/img/eva/appraisal-cash-icon-animated.svg")}) no-repeat center`}})),V.a.createElement("ul",{className:"p-0"},kn.map(e=>{let t=e.successStateKey,a=e.copy;return V.a.createElement(A.Fragment,{key:a},V.a.createElement("li",{className:"d-flex mb-1"},V.a.createElement("i",{className:Re()("icon icon-checkmark-circle size-20",{"text-success":this.state[t]})}),V.a.createElement("div",{className:"ml-0_75"},a)))})))}}Rn.propTypes={className:k.a.string,isSubmittingFinished:k.a.bool.isRequired,setLoadingStatus:k.a.func.isRequired,isMobile:k.a.bool},Rn.defaultProps={className:"",isSubmittingAppraisal:!0,isMobile:!1};var Mn=a("../node_modules/reactstrap/lib/InputGroupAddon.js"),jn=a.n(Mn);const Dn={GREAT:"Great",GOOD:"Good",FAIR:"Fair",BAD:"Bad"},Ln="great-deal",Fn="good-deal",Un="regular",qn=(e,t,a)=>{const s=a>e.outstanding;return s?Ln:a>t&&!s?Fn:Un},zn=(e,t)=>{const a=((e,t)=>{let a="Fair";return Ln===e?a="Great":Fn===e?a="Good":t&&(a="Bad"),a})(e.displayType,e.isBadDeal);return{event_type:X.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:X.b.ACTION_RECEIVE_EPO,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:X.b.OFFER_STRENGTH,creative_id:t,value:a}}},Bn=(e,t,a)=>{const s=e||{},i=a>s.outstanding,n=a>t&&!i;return a<s.rough||!a||!t||y()(e)?Dn.BAD:i?Dn.GREAT:n?Dn.GOOD:Dn.FAIR},$n={PRINT:"Print Offer",EMAIL:"Email Offer",SEND_TO_PHONE:"Send To Phone",SCHEDULE_APPOINTMENT:"Schedule Appointment"};class Yn extends A.PureComponent{static getDerivedStateFromProps(e,t){const a=e.condition,s=e.conditionPricing,i=e.valuation,n=e.emailReportStatus,r=t.offerRangeDisplayType,l=t.isSubmitting,o=t.isSubmitted,c=s[a],d=qn(s,c,i);return d!==r?{offerRangeDisplayType:d}:n===Z.u.SENT?{isSubmitting:!1,isSubmitted:o||l}:null}constructor(e){super(e),this.onEmailFormFieldFocus=(()=>{const e=this.props,t=e.emailReportStatus,a=e.resetEmailReportStatus;this.state.isSubmitted&&(t===Z.u.SENT&&a(),this.setState({isSubmitted:!1}))}),this.getIsBadDeal=(()=>{const e=this.props;return e.valuation<e.conditionPricing.rough}),this.getInlineEmailForm=(()=>{const e=this.props,t=e.validationErrors.email,a=e.validate,s=e.userEmail,i=this.state,n=i.isSubmitting,r=i.isSubmitted,l=r?"Sent!":"SEND";return V.a.createElement(A.Fragment,null,V.a.createElement(Kt.a,{id:`offer-card-email-${this.uniqInputId}`,"data-tracking-id":"provide_email","data-tracking-ignore-value":!0,maxLength:255,name:"email",type:"email",inputClassName:"border-right-0 pr-0 pl-0_5 text-gray-darker size-16 py-0_5 email-input","aria-label":"Enter Your Email",ref:this.inputRef,isValid:!t,required:!0,defaultValue:s,placeholder:"Email \u2020",onFocus:this.onEmailFormFieldFocus,onBlur:a,className:Re()("input-group",{"mb-0_25":t,"mb-0":!t}),readOnly:n,addon:V.a.createElement(jn.a,{addonType:"append",className:"p-0"},V.a.createElement(ot.a,{"data-tracking-id":"submit_sign_up_email",size:"sm",color:"success",type:"submit",className:"px-0_5 rounded-right border-left-0 addon-btn text-transform-none",disabled:r},n?V.a.createElement(ht.a,{size:14,thickness:1,color:"white"}):V.a.createElement("span",{className:"size-16"},l)))}),t&&V.a.createElement("div",{id:`error-email-${this.uniqInputId}`,className:"size-12 text-danger text-left"},t))}),this.getEmailButton=(()=>V.a.createElement(mt.a,{noValidate:!0,onSubmit:this.handleSubmitEmail,className:"mb-1"},V.a.createElement("div",{className:"size-16 font-weight-bold mb-0_5 text-gray-darker mt-1 text-left"},"Save this offer."),this.getInlineEmailForm())),this.getPrintLink=(()=>{const e=this.props.redemptionCertificateUri;return V.a.createElement(ot.a,{color:"link",target:"_blank",className:"text-capitalize size-16 offer-cta-secondary font-weight-normal mt-0 p-0 text-left mb-1_5",href:e,"data-tracking-id":"partner_schedule_dropoff","data-tracking-value":`${this.ctaTextsTracking.PRINT} - MAIN`},V.a.createElement("i",{className:"icon-printer3 pr-0_5"}),$n.PRINT)}),this.getDisclaimer=((e,t)=>V.a.createElement("div",{className:Re()("size-10",t)},"\u2020 By clicking ",e,", I accept the terms of the"," ",V.a.createElement(Ba.a,{target:"_blank",rel:"noopener noreferrer",to:"/about/visitor-agreement.html",className:"text-gray-darker disclaimer"},V.a.createElement("u",null,"Edmunds Visitor Agreement")),"."," ",V.a.createElement(Ba.a,{target:"_blank",rel:"noopener noreferrer",to:"/about/privacy.html",className:"text-gray-darker disclaimer"},V.a.createElement("u",null,"Our collection and use of your personal information")),".")),this.getCtas=(()=>{const e=this.props.appointmentUri;return V.a.createElement("div",{className:"offer-footer-cta-wrapper d-flex flex-column"},V.a.createElement(ot.a,{color:"link",target:"_blank",className:"text-decoration-none size-16 font-weight-normal p-0 mt-0 text-left mb-0_5",href:e,"data-tracking-id":"instant_offer_dealer_site_clickout","data-tracking-value":`${this.ctaTextsTracking.SCHEDULE_APPOINTMENT} - OFFER CARD`},V.a.createElement("i",{className:"icon-calendar4 pr-0_5"}),V.a.createElement("u",null,$n.SCHEDULE_APPOINTMENT)),this.getPrintLink())}),this.uniqInputId=Object(zt.c)(),this.handleSubmitEmail=(async e=>{const t=this.props,a=t.validate,s=t.resetEmailReportStatus;e.preventDefault(),e.stopPropagation();const i=a();i&&s(),this.setState({isSubmitting:i},async()=>{const e=this.props,t=e.isAuthenticated,a=e.doesNotHaveEmail,s=e.updateIdmData,n=e.validateEmailAsync,r=e.fields;await nt({isAuthenticated:t,doesNotHaveEmail:a,isValid:i,emailField:r.email,updateIdmData:s,validateEmailAsync:n,fetchSignInMethodsForEmail:ni.e,fireValidExistingEmailCustomEvent:se.g}),i&&J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:X.b.ACTION_SIGN_UP,subaction_name:X.b.SUCCESS_EMAIL_ONLY_SIGN_UP,action_cause:X.b.ACTION_CAUSE_BUTTON_CLICK,creative_id:Z.W}})})}),this.inputRef=(e=>{if(e)return this.props.fieldRef(e.props.name,e)});const t=this.props,a=t.condition,s=t.conditionPricing,i=t.valuation,n=s[a],r=qn(s,n,i);this.state={appraisalValue:n,offerRangeDisplayType:r,isSubmitting:!1,isSubmitted:!1,isEmailModalOpened:!1},this.ctaTextsTracking=this.props.isSecondary?wi()({},$n,(e,t)=>`${t}2`):Di()($n)}componentDidMount(){const e=this.props.isSecondary,t=this.state.offerRangeDisplayType;if(!e){const e=this.getIsBadDeal();J.a.fireTrackAction(zn({displayType:t,isBadDeal:e},Z.W))}}render(){const e=this.props,t=e.getVehicleData,a=e.code,s=e.expiresDateUtc,i=e.vin,n=e.valuation,r=t(),l=r.makeName,o=r.modelName,c=r.year;return V.a.createElement(A.Fragment,null,V.a.createElement("div",{className:"instant-offer-partner-offer-card rounded px-md-0_5","data-tracking-parent":Z.W},V.a.createElement(L.a,{className:"flex-md-row-reverse"},V.a.createElement(U.a,{xs:12,className:"instant-offer-partner-offer-card-wrapper d-flex align-items-center flex-column text-center px-1_5 px-md-1 bg-gray-extra-light py-1_5"},V.a.createElement(hi.a,{className:"carmax-logo mb-0_5"}),V.a.createElement("div",{className:Re()("text-primary mb-0_25")},V.a.createElement("div",{className:"valuation font-weight-bold"},Object(Ge.a)(n),"*")),V.a.createElement("div",{className:"vehicle-detail text-gray-darker size-14 text-center"},V.a.createElement("div",{className:"font-weight-bold"},c," ",l," ",o),V.a.createElement("div",{className:"text-uppercase"},"VIN: ",i)),V.a.createElement("div",{className:"buttons-container"}," ",V.a.createElement(A.Fragment,null,this.getEmailButton(),this.getCtas())),V.a.createElement("div",{className:"text-gray-darker size-12 d-flex offer-details"},V.a.createElement("div",null,"Offer Code: ",a),V.a.createElement("div",{className:"ml-0_5 pl-0_5"},"Valid until ",Ye()(s,"UTC:mm/dd/yyyy")))))),this.getDisclaimer("Send","mt-1_25"))}}Yn.propTypes={getVehicleData:k.a.func.isRequired,conditionPricing:k.a.shape({outstanding:k.a.number,rough:k.a.number}).isRequired,valuation:k.a.number.isRequired,code:k.a.string.isRequired,redemptionCertificateUri:k.a.string.isRequired,expiresDateUtc:k.a.string.isRequired,vin:k.a.string.isRequired,emailReportStatus:k.a.string,resetEmailReportStatus:k.a.func,condition:k.a.string,isSecondary:k.a.bool,fields:k.a.shape({}),userEmail:k.a.string,validationErrors:k.a.objectOf(k.a.string),fieldRef:k.a.func.isRequired,validate:k.a.func.isRequired,appointmentUri:k.a.string,validateEmailAsync:k.a.func.isRequired},Yn.defaultProps={emailReportStatus:"",resetEmailReportStatus:b.a,condition:Z.n.AVERAGE,isMobile:!1,isSecondary:!1,fields:{},userEmail:"",validationErrors:{},appointmentUri:""};const Hn=Object(Y.a)(Yn),Zn=Object(q.c)(e=>({userEmail:S()(e,"profile.data.idm.identifiers.email[0]"),isAuthenticated:e.profile.isAuthenticated,doesNotHaveEmail:!S()(e,"profile.data.idm.identifiers.email[0]")}))(Object(Jt.a)(Hn,it));a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/instant-offer-partner-offer/instant-offer-partner-offer.scss");class Gn extends A.PureComponent{constructor(){super(...arguments),this.state={offerStrength:Bn(this.props.conditionPricing,this.props.conditionPricing[this.props.condition],this.props.valuation)},this.getRangeText=(()=>{let e="",t="",a="";switch(this.state.offerStrength){case Dn.GREAT:e="is offering you",t=V.a.createElement("span",{className:"text-primary"},"well above"),a=V.a.createElement(A.Fragment,null,"Edmunds True Market Value\xae for your car");break;case Dn.GOOD:e="is offering you",t=V.a.createElement("span",{className:"text-primary"},"above"),a=V.a.createElement(A.Fragment,null,"Edmunds True Market Value\xae for your car");break;case Dn.FAIR:case Dn.BAD:default:e="has made a",t=V.a.createElement("span",{className:"text-primary"},"no-obligation"),a="offer for your car"}return V.a.createElement(A.Fragment,null,"CarMax ",e," ",V.a.createElement("div",null,t," ",a))})}render(){const e=this.props,t=e.getVehicleData,a=e.code,s=e.redemptionCertificateUri,i=e.expiresDateUtc,n=e.conditionPricing,r=e.valuation,l=e.vin,o=e.emailReportStatus,c=e.className,d=e.isMobile,p=e.isSecondary,m=e.condition,u=e.appointmentUri,h=e.resetEmailReportStatus;return V.a.createElement("div",{className:Re()("instant-offer-partner-offer",c)},V.a.createElement("div",{className:"instant-offer-partner-offer-message text-center mb-1_5"},V.a.createElement("div",null,V.a.createElement("i",{className:"icon-edmunds-car text-primary size-30 mr-0_5"})),V.a.createElement("div",{className:d?"heading-4":"heading-3"},this.getRangeText())),V.a.createElement(L.a,{className:"justify-content-center"},V.a.createElement(U.a,{className:"w-100 instant-offer-partner-offer-card-container"},V.a.createElement(Zn,{getVehicleData:t,conditionPricing:n,valuation:r,code:a,redemptionCertificateUri:s,expiresDateUtc:i,vin:l,emailReportStatus:o,resetEmailReportStatus:h,isMobile:d,isSecondary:p,condition:m,appointmentUri:u}))))}}Gn.propTypes={getVehicleData:k.a.func.isRequired,conditionPricing:k.a.shape({outstanding:k.a.number,rough:k.a.number}).isRequired,valuation:k.a.number.isRequired,code:k.a.string.isRequired,redemptionCertificateUri:k.a.string.isRequired,expiresDateUtc:k.a.string.isRequired,vin:k.a.string.isRequired,emailReportStatus:k.a.string,resetEmailReportStatus:k.a.func,className:k.a.string,condition:k.a.string,isMobile:k.a.bool,isSecondary:k.a.bool,appointmentUri:k.a.string},Gn.defaultProps={emailReportStatus:"",resetEmailReportStatus:b.a,className:"",condition:"",isMobile:!1,isSecondary:!1,appointmentUri:""};var Wn=a("../node_modules/reactstrap/lib/Container.js"),Qn=a.n(Wn),Kn=a("./site-modules/shared/components/drawer/drawer-close-button/drawer-close-button.jsx"),Xn=a("./site-modules/shared/components/calendar/calendar.jsx"),Jn=a("./site-modules/shared/components/time-selector/time-selector.jsx"),er=a("./site-modules/shared/utils/date-utils.js");const tr=0,ar=()=>Object(er.a)(1),sr=()=>{const e=Object(er.a)(1),t=new Date(new Date(e).setDate(e.getDate()+30));return[{before:e},{after:t},{daysOfWeek:[tr]}]},ir=()=>{const e=[];for(let t=11;t<=20;t+=.5){const a=Math.floor(t),s=60*(t-a),i=`${`${a>12?a-12:a}:${s>0?s:"00"}`} ${a>=12?"PM":"AM"}`;e.push({title:i,value:i,start:t,end:t+.5})}return e};a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/schedule-appointment-drawer/schedule-appointment.scss");const nr={email:{test:Xe.a.validateEmail,errorText:"Please enter your correct email address."},firstName:{test:Xe.a.validateFirstName,errorText:"Please correct your name. Special characters cannot be included."},lastName:{test:Xe.a.validateName,errorText:"Please correct your name. Special characters cannot be included."}};class rr extends A.Component{constructor(){super(...arguments),this.state={selectedAppointmentDate:ar(),selectedAppointmentTime:ir()[0].value,isSubmitted:!1,uniqId:Object(zt.c)()},this.onDateChange=(e=>this.setState({selectedAppointmentDate:e})),this.onTimeChange=((e,t)=>this.setState({selectedAppointmentTime:t})),this.handleSubmit=(e=>{e.preventDefault();const t=this.props,a=t.validate,s=t.vin,i=this.state,n=i.selectedAppointmentDate,r=i.selectedAppointmentTime;a()&&(this.fireTracking(X.b.SCHEDULE_APPOINTMENT,"success"),this.fireTracking(X.b.APPOINTMENT_DATE,n),this.fireTracking(X.b.APPOINTMENT_TIME,r),this.fireTracking(X.b.APPOINTMENT_VIN,s),this.setState({isSubmitted:!0}))}),this.fireTracking=((e,t)=>{J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_PROGRESS,event_data:{action_name:X.b.ACTION_RECEIVE_EPO,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:e,creative_id:this.props.trackingCreativeId,value:t}})}),this.inputRef=(e=>{if(e)return this.props.fieldRef(e.props.name,e)})}render(){const e=this.props,t=e.toggleDrawer,a=e.validationErrors,s=e.valuation,i=e.storeInfo,n=e.getVehicleData,r=e.isMobile;if(!i)return null;const l=i.name,o=i.addressLine1,c=i.addressLine2,d=this.state,p=d.selectedAppointmentDate,m=d.selectedAppointmentTime,u=d.isSubmitted,h=d.uniqId,g=a.firstName,b=a.lastName,f=a.email,E=n(),v=E.makeName,y=E.modelName,C=E.year;return V.a.createElement("div",{className:"instant-offer-schedule-appointment text-gray-darker"},(s||u)&&V.a.createElement("div",{className:"heading-2 mb-2"},u?"You're all set!":V.a.createElement(A.Fragment,null,"Redeem Your ",V.a.createElement("span",{className:"text-primary"},Object(Ge.c)(s),"*")," Cash Offer")),V.a.createElement("div",{className:"heading-4 mb-1_5"},u?`Your appointment has been scheduled on ${Ye()(p,"mmmm dS, yyyy")} at ${m} with:`:"Schedule your appointment with:"),V.a.createElement(hi.a,{className:"partner-logo mb-0_75"}),V.a.createElement("div",null,"CarMax ",l),V.a.createElement("div",null,o),V.a.createElement("div",null,c),V.a.createElement("a",{href:`tel:${Object(Ui.a)(Z.k)}`,"data-tracking-id":"instant_offer_call_dealer","data-tracking-value":Object(Ui.b)(Z.k),className:"d-block text-primary-darker"},Object(Ui.c)(Z.k)),u?V.a.createElement(ot.a,{type:"submit",color:"success",size:"lg",className:"text-transform-none mt-2",block:!0,"data-tracking-id":"schedule_appointment_drawer_close",onClick:t},"Got it"):V.a.createElement(A.Fragment,null,V.a.createElement(L.a,{className:"my-2"},V.a.createElement(U.a,{md:6,className:"mb-1 mb-md-0"},V.a.createElement(Xn.a,{selectedDate:p,onChange:this.onDateChange,disabledDays:sr(),deliveryDateClassName:Re()("py-0_5",{"size-16":r,medium:!r})})),V.a.createElement(U.a,{md:6},V.a.createElement(Jn.a,{onChange:this.onTimeChange,deliveryTime:m,timeIntervals:ir(),deliveryTimeClassName:Re()("py-0_5",{"size-16":r,medium:!r})}))),V.a.createElement(mt.a,{noValidate:!0,onSubmit:this.handleSubmit},V.a.createElement(L.a,null,V.a.createElement(U.a,{md:6},V.a.createElement(Kt.a,{id:`first-name-${h}`,maxLength:255,name:`first-name-${h}`,type:"text",label:"First Name",labelClassName:"small pl-0_25",inputClassName:Re()({"size-16":r}),ref:this.inputRef,isValid:!g,required:!0}),V.a.createElement(Yt.a,{id:`first-name-${h}-error`,error:g,classes:"mb-1"})),V.a.createElement(U.a,{md:6},V.a.createElement(Kt.a,{id:`last-name-${h}`,maxLength:255,name:`last-name-${h}`,type:"text",label:"Last Name",labelClassName:"small pl-0_25",inputClassName:Re()({"size-16":r}),ref:this.inputRef,isValid:!b,required:!0}),V.a.createElement(Yt.a,{id:`last-name-${h}-error`,error:b,classes:"mb-1"}))),V.a.createElement(Kt.a,{id:`email-${h}`,maxLength:255,name:`email-${h}`,type:"text",label:"Email",labelClassName:"small pl-0_25",inputClassName:Re()({"size-16":r}),ref:this.inputRef,isValid:!f,required:!0}),V.a.createElement(Yt.a,{id:`email-${h}-error`,error:f,classes:"mb-1"}),V.a.createElement(ot.a,{type:"submit",color:"success",className:"text-transform-none px-0",block:!0,size:"lg","data-tracking-id":"submit_schedule_appointment"},"Schedule Appointment")),V.a.createElement("div",{className:"size-12 text-gray mt-1"},V.a.createElement("div",{className:"mb-1"},"*By clicking Submit, you agree to provide your information to CarMax for the purpose of scheduling an appointment to redeem the offer for your ",C," ",v," ",y,"."),V.a.createElement("div",null,"*The offer from CarMax is contingent on your providing accurate information on Edmunds.com. CarMax will conduct an in-person verification of your vehicle and evaluate other vehicle use and history information prior to finalizing the offer. Any differences between the information you provide about your vehicle and the vehicle's actual condition, use, and history may impact the offer you receive from CarMax."))))}}rr.propTypes={toggleDrawer:k.a.func.isRequired,getVehicleData:k.a.func.isRequired,fieldRef:k.a.func.isRequired,validate:k.a.func.isRequired,validationErrors:k.a.objectOf(k.a.string),fields:k.a.shape({phoneNumber:k.a.shape({value:k.a.func})}),valuation:k.a.number,storeInfo:k.a.shape({name:k.a.string,addressLine1:k.a.string,addressLine2:k.a.string}),vin:k.a.string,trackingCreativeId:k.a.string,isMobile:k.a.bool},rr.defaultProps={validationErrors:{},fields:{phoneNumber:{value:b.a}},valuation:0,storeInfo:{},vin:"",trackingCreativeId:"",isMobile:!1};const lr=Object(Jt.a)(rr,nr),or="epo-appointment-drawer";class cr extends A.Component{constructor(){super(...arguments),this.state={isDrawerComponentLoaded:!1}}static getDerivedStateFromProps(e,t){return e.isOpen&&!t.isDrawerComponentLoaded?{isDrawerComponentLoaded:!0}:null}render(){const e=this.props,t=e.isOpen,a=e.onToggle,s=e.drawerClassNames,i=e.valuation,n=e.storeInfo,r=e.vin,l=e.getVehicleData,o=e.isMobile,c=this.state.isDrawerComponentLoaded;return V.a.createElement(ia.a,{side:"right",size:"small","data-tracking-parent":or,classNames:{drawerContent:"px-0_5",drawer:s},toggle:a,isOpen:t},c&&V.a.createElement(Qn.a,{className:"mx-auto px-md-0 instant-offer-schedule-appointment-container"},V.a.createElement(Kn.a,{onClick:a,className:"mb-0 mb-md-2 d-block schedule-appointment-close mx-auto",lgBtnClass:"pl-0",smBtnClass:"d-inline-block",trackingId:"schedule_appointment_drawer_close",trackingValue:"x"}),V.a.createElement(lr,{getVehicleData:l,valuation:i,storeInfo:n,vin:r,toggleDrawer:a,trackingCreativeId:or,isMobile:o})))}}cr.propTypes={isOpen:k.a.bool.isRequired,onToggle:k.a.func.isRequired,getVehicleData:k.a.func.isRequired,drawerClassNames:k.a.string,valuation:k.a.number,storeInfo:k.a.shape({name:k.a.string,addressLine1:k.a.string,addressLine2:k.a.string,city:k.a.string,state:k.a.string}),vin:k.a.string,isMobile:k.a.bool},cr.defaultProps={drawerClassNames:null,valuation:0,storeInfo:{},vin:"",isMobile:!1};const dr={OFFER:"offer",NO_OFFER:"no-offer",INELIGIBLE:"ineligible",NO_TMV:"no-tmv"},pr={[dr.OFFER]:{header:"We have something special for you!",subheader:"CarMax wants to buy your car and has made you an offer! See how your offer compares to your Edmunds appraisal and decide if it's the right time to sell.",ctaText:"See my car's value"},[dr.NO_OFFER]:{header:"We have something special for you!",subheader:"CarMax is interested in seeing your car to make an offer! Schedule an appointment to visit your local CarMax and use your Edmunds appraisal to evaluate the CarMax offer.",ctaText:"See my car's value"},[dr.INELIGIBLE]:{header:"Your appraisal report is ready!",subheader:"We couldn't find a local offer on your vehicle. Use your appraisal to evaluate a dealership's trade-in offer or as a starting point when selling private party.",ctaText:"See my car's value"},[dr.NO_TMV]:{header:"We couldn't generate an appraisal report for you",subheader:"Your vehicle is either too new, rare or old to generate an appraisal report. Schedule an appointment with CarMax if you're interested in selling your car.",ctaText:"Got it"}};var mr=a("./images/inline-svgs/edmunds-logo.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/offer-overlay/offer-overlay.scss");function ur(e){let t=e.overlayType,a=e.shouldOpen,s=e.isMobile,i=e.onClosed;const n=Object(A.useState)(!1),r=Object(qe.a)(n,2),l=r[0],o=r[1],c=t===dr.OFFER?"edm-entry-overlay-offer":"edm-entry-overlay-no-offer";function d(e){if(l){const t=e.currentTarget.dataset.trackingValue,a=void 0===t?"":t;J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:X.b.ACTION_VIEW_CONTENT,subaction_name:X.b.ACTION_VIEW_CONTENT,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_BUTTON_CLICK,creative_id:c,value:a}})}o(!l)}Object(A.useEffect)(()=>{a&&o(!0)},[a]);const p=pr[t],m=p.header,u=p.subheader,h=p.ctaText;return V.a.createElement(ua.a,{className:"instant-offer-overlay mx-auto pt-3 pt-md-3_5",contentClassName:"mt-3_5",onOpened:function(){J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_WIDGET_VIEW,event_data:{action_name:X.b.ACTION_WIDGET_VIEW,action_cause:X.b.ACTION_CAUSE_BUTTON_CLICK,creative_id:c}})},onClosed:i,isOpen:l,toggle:d,"data-tracking-parent":c},V.a.createElement(ga.a,{className:"text-center px-0 py-3_5 mt-2_5 mb-0_75 mt-md-3_5 mb-md-1_5"},V.a.createElement("figure",{className:"mb-1_5 mx-auto pt-1_5 pos-a rounded-circle"},Object(mr.a)()),V.a.createElement("section",{className:"details px-md-0 mx-md-auto px-1_5"},V.a.createElement("header",{className:"header mx-md-auto heading-2 text-black-0_9 mb-1"},m),V.a.createElement("article",{className:"text-gray-darker mb-2_5"},u),V.a.createElement(ot.a,{className:"text-transform-none instant-offer-overlay-button size-16 py-md-1",block:s,color:"success",onClick:d,"data-tracking-value":h},h))))}ur.propTypes={overlayType:k.a.string,shouldOpen:k.a.bool,isMobile:k.a.bool,onClosed:k.a.func},ur.defaultProps={overlayType:dr.NO_OFFER,shouldOpen:!1,isMobile:!1,onClosed:b.a};var hr=a("./data/models/dealerships.js"),gr=a("./site-modules/shared/utils/dealer-details-utils.js");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/dealer-locator/dealer-locator.scss");const br="edm-entry-dealer-locator";class fr extends A.Component{constructor(){super(...arguments),this.getDealerCards=(()=>{const e=this.props,t=e.dealers,a=e.mileOneDealer,s=void 0===a?{}:a,n=S()(t,"results",[]);if(!n.length)return null;if(y()(s))return n.slice(0,3);const r=n.filter(e=>s.rooftopId!==e.rooftopId).slice(0,2);return[Object(i.a)({},s,{isMileOneDealer:!0}),...r.map(e=>S()(e,"parentDealershipName","").includes("MileOne")?Object(i.a)({},e,{isMileOneDealer:!0}):e)]}),this.trackMileOneDealerExists=(e=>{J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:X.b.ACTION_RECEIVE_EPO,subaction_name:X.b.MILE_ONE_DISPLAYED,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_LINK_CLICK,creative_id:br,value:e}})}),this.trackRooftopId=((e,t)=>()=>{J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:X.b.ACTION_DEALER_ENGAGEMENT,subaction_name:e,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_LINK_CLICK,creative_id:br,value:t}})}),this.buildDealerCard=(e=>{const t=e.phoneNumbers,a=e.productFeatures,s=e.id,i=e.name,n=e.salesRating,r=e.address,l=e.showroomPage,o=e.isMileOneDealer,c=e.sellYourCarUrl,d=e.rooftopId,p=r.street,m=r.city,u=r.stateCode,h=r.zip,g=Object(gr.a)({phoneNumbers:t,isDirectDealer:a.directDealer}),b=S()(e,"salesReviewCount",0),f=o&&c?c:l;return V.a.createElement(U.a,{xs:12,lg:4,key:s},V.a.createElement("div",{className:"dealer-card text-gray-darker rounded mb-1 mb-md-0"},V.a.createElement("div",{className:"p-1"},V.a.createElement("div",{className:"dealer-name font-weight-bold mb-0_25"},i),V.a.createElement("div",{className:"mb-0_5"},V.a.createElement(Ae.a,{rating:n,starClass:"size-12 mr-0_25"}),V.a.createElement("span",{className:"size-12 ml-0_25"},b," Reviews")),V.a.createElement("div",{className:"contact-info"},!y()(r)&&V.a.createElement("div",{className:"address size-14 mb-0_25 mb-md-0 d-flex align-items-baseline"},V.a.createElement("span",{className:"icon-location size-12 text-primary-darker d-block mr-0_5"}),V.a.createElement("div",null,V.a.createElement("span",{className:"d-lg-block mr-0_25 mr-lg-0"},p,","),V.a.createElement("span",{className:"d-lg-block"},m,", ",u," ",h))),g&&V.a.createElement("div",null,V.a.createElement("span",{className:"mr-1_5"},V.a.createElement("span",{className:"icon-phone2 size-12 text-primary-darker"}),V.a.createElement("a",{href:`tel:${Object(Ui.a)(g)}`,"data-tracking-id":"call_dealer",onClick:this.trackRooftopId(X.b.CALL_DEALER_ROOFTOP_ID,d),className:"size-14 text-gray-darker"},V.a.createElement("span",{className:"pl-0_5"},Object(Ui.c)(g))))))),V.a.createElement("div",{className:"text-center py-0_5 pt-md-0_5 pb-md-1 dealer-card-footer"},V.a.createElement(Ba.a,{to:f,onClick:this.trackRooftopId(X.b.VIEW_DEALER_DETAILS_ROOFTOP_ID,d),target:"_blank",className:"text-primary-darker","data-tracking-id":"click_view_dealer_page"},"Visit Dealer Page"))))})}componentDidUpdate(e){const t=this.props,a=t.dealers,s=t.mileOneDealer;y()(a)||m()(e.dealers,a)||J.a.fireCustomEvent(X.a),s&&!m()(e.mileOneDealer,s)&&this.trackMileOneDealerExists(!y()(s))}render(){const e=this.getDealerCards();return null===e?null:V.a.createElement("div",{"data-tracking-parent":br},V.a.createElement("hr",{className:"my-2"}),V.a.createElement("div",{className:"font-weight-bold size-24 text-md-center text-gray-darker mb-1_5"},V.a.createElement("span",{className:"d-block"},"Get the most for your car"),"See if these ",V.a.createElement("span",{className:"text-primary"},"local dealers")," will beat the CarMax offer"),V.a.createElement(L.a,null,e.map(this.buildDealerCard)),V.a.createElement("div",{className:"text-center mt-1_5"},V.a.createElement(qi.a,{to:"/dealerships/",target:"_blank",className:"text-primary-darker","data-tracking-id":"view_more_dealer_locations"},"View More Locations")))}}fr.propTypes={dealers:k.a.shape({results:k.a.arrayOf(hr.a.Dealer)}),mileOneDealer:hr.a.Dealer},fr.defaultProps={dealers:{},mileOneDealer:void 0};const Er={mileOneDealer:Object(B.a)(()=>Object(hr.f)({}),hr.b),dealers:Object(B.a)(e=>Object(hr.e)({make:e.makeSlug,directDealer:!0}),hr.b)},vr=Object(B.b)(fr,Er);a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/multi-offer-cards/multi-offer-cards.scss");const yr="edm-entry-unlock-offers",Cr=[{offerCode:"ODJWID",distanceToNearestStore:1.8},{offerCode:"CNEJVU",distanceToNearestStore:.2}];class Sr extends A.Component{constructor(){super(...arguments),this.buildOfferCard=((e,t)=>{const a=this.props,s=a.isMobile,i=a.eval3573Recipe,n=e.offerPrice,r=e.distanceToNearestStore,l=e.offerCode,o=e.offerExpDate,c=e.url,d=e.dataTrackingId,p=e.dataTrackingValue;return V.a.createElement(U.a,{xs:12,lg:4,key:`${l}-${t}`},V.a.createElement(Ba.a,{className:"offer-card-link",target:"_blank",to:c,"data-tracking-id":d,"data-tracking-value":p},V.a.createElement("div",{className:Re()("offer-card text-center text-gray-darker rounded mb-1 mb-md-0 mx-0 py-0_75 py-md-1",{"bg-gray-extra-light":"chal1"===i})},n?V.a.createElement("div",{className:"offer-price size-30 font-weight-bold text-primary mt-0_25 mt-md-0_5 mb-0_5"},Object(Ge.a)(n),"*"):V.a.createElement(ks.a,{imageId:"chal1"===i?"img/eva/unlock-offer-blur.svg":"img/eva/unlock-offer-sticker.svg",source:He.d.STATIC,alt:"Offer Reveal",className:"price-reveal"}),r&&V.a.createElement("div",{className:"mt-0_25 mb-0_25 my-md-0_5 size-12 text-gray"},r," miles away"),V.a.createElement("div",{className:Re()("font-weight-bold size-14 mb-0_5 mb-md-0",{"mt-2":n&&!r})},n?V.a.createElement(A.Fragment,null,V.a.createElement("span",{className:"d-md-block"},"Your offer from "),V.a.createElement(hi.a,{className:"carmax-logo"})):V.a.createElement(A.Fragment,null,V.a.createElement("span",{className:"d-md-block"},"Your ",1===t?"2nd":"3rd"," offer from a "),"trusted partner")),V.a.createElement("div",{className:Re()("offer-code size-12 mt-0_75",{"d-inline":s})},"Offer Code: ",l),V.a.createElement("span",{className:"size-12 mx-0_5 hidden-md-up"},"|"),V.a.createElement("div",{className:Re()("offer-exp-date size-12",{"d-inline":s})},"Valid until ",Ye()(o,"UTC:mm/dd/yyyy")))))})}componentDidMount(){J.a.fireCustomEvent(X.a)}render(){const e=this.props,t=e.offerPrice,a=e.distanceToNearestStore,s=e.offerCode,n=e.offerExpDate,r=e.make,l=e.model,o=e.year,c=e.zipCode,d=e.vin,p=e.redemptionCertificateUri,m=e.isMobile,u=`https://tier3.wufoo.com/forms/z6dgkto1lz3tv5/def/field43=${d}&field40=${c}&field49=${r}&field50=${l}&field51=${o}`,h=[{offerPrice:t,offerCode:s,distanceToNearestStore:a,offerExpDate:n,url:p,dataTrackingId:"partner_schedule_dropoff",dataTrackingValue:"carmax_card"},Object(i.a)({},Cr[0],{offerExpDate:n,url:u,dataTrackingId:"unlock_offers",dataTrackingValue:"second_card"}),Object(i.a)({},Cr[1],{offerExpDate:n,url:u,dataTrackingId:"unlock_offers",dataTrackingValue:"third_card"})];return V.a.createElement("div",{"data-tracking-parent":yr},V.a.createElement("hr",{className:"my-2"}),V.a.createElement("div",{className:"font-weight-bold size-24 text-center text-gray-darker mb-1_5"},V.a.createElement("span",{className:"d-block"},"Unlock ",V.a.createElement("span",{className:"text-primary"},"2 more real offers")," to compare to CarMax"),"for your ",o," ",r),V.a.createElement(L.a,null,h.map(this.buildOfferCard)),V.a.createElement("div",{className:"text-center mt-0_5 mt-md-1_5"},V.a.createElement(ot.a,{color:"success",target:"_blank",block:m,className:"text-uppercase py-0_5 py-md-0_75 px-1 size-16",href:u,"data-tracking-id":"unlock_offers","data-tracking-value":"Unlock Your Offers"},"Unlock your offers")))}}Sr.propTypes={offerPrice:k.a.number,distanceToNearestStore:k.a.number,offerCode:k.a.string,offerExpDate:k.a.string,make:k.a.string,model:k.a.string,year:k.a.number,zipCode:k.a.string,vin:k.a.string,redemptionCertificateUri:k.a.string,isMobile:k.a.bool,eval3573Recipe:k.a.string},Sr.defaultProps={offerPrice:null,distanceToNearestStore:null,offerCode:"",offerExpDate:"",make:"",model:"",year:null,zipCode:"",vin:"",redemptionCertificateUri:"",isMobile:!1,eval3573Recipe:"chal1"};var Tr=a("./site-modules/shared/components/animated-sticky/animated-sticky.jsx"),Ir=a("./site-modules/shared/components/form-field-mask/form-field-mask.jsx");a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/instant-offer-send-to-phone/instant-offer-send-to-phone.scss");const Nr={phoneNumber:{test:Xe.a.validatePhoneNumber,errorText:"Please enter a valid phone number."}},_r={pattern:"999.999.9999",toValue:!0},Or={SEND:"Send",SENDING:"Sending"},Pr={IS_ERROR:"is-error",IS_SENT:"is-sent",DEFAULT:"default"},Ar={[Pr.DEFAULT]:{header:"Send your CarMax offer to your phone!",subHeader:"We'll text you a link to your offer so you can access it anytime."},[Pr.IS_ERROR]:{header:"Something went wrong",subHeader:"We're sorry, we couldn\u2019t text you your offer at this time. Please try again."},[Pr.IS_SENT]:{header:"Sent!",subHeader:"Check your phone for your CarMax offer. Hurry, it expires in 7 days!"}};class Vr extends A.Component{constructor(){super(...arguments),this.state={sentTypeKey:Pr.DEFAULT,isSending:!1},this.handleSubmit=(e=>{e.preventDefault();const t=(0,this.props.validate)();this.firePhoneValidationTracking(t),t&&this.setState({isSending:!0,sentTypeKey:Pr.DEFAULT},this.handleSendSms)}),this.handleBlur=(()=>{(0,this.props.validate)()}),this.handleSendSms=(async()=>{const e=this.props,t=e.redemptionCertificateUri,a=e.fields.phoneNumber,s=e.location;try{await Object(kt.i)(Object(Ui.a)(a.value()),`${t}&print=false`,s),this.setState({isSending:!1,sentTypeKey:Pr.IS_SENT})}catch(e){this.setState({isSending:!1,sentTypeKey:Pr.IS_ERROR})}}),this.firePhoneValidationTracking=(e=>{J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:X.b.ACTION_RECEIVE_EPO,action_category:X.b.USER_ACTION_CATEGORY,subaction_name:e?X.b.PHONE_INPUT_SUCCESS:X.b.PHONE_INPUT_FAIL,creative_id:Z.W}})}),this.phoneNumberRef=(e=>this.props.fieldRef("phoneNumber",e))}render(){const e=this.props,t=e.toggleModal,a=e.validationErrors,s=e.isSecondary,i=this.state,n=i.isSending,r=i.sentTypeKey,l=i.errorMessage,o=a.phoneNumber||l;return V.a.createElement("div",{className:"instant-offer-send-to-phone text-gray-darker p-0_5","data-tracking-parent":Z.W},V.a.createElement("div",{className:"pos-r heading-5 mb-0_75 pr-1_75"},V.a.createElement("span",null,Ar[r].header),V.a.createElement(ot.a,{color:"link",size:"lg",className:"close-btn p-0_25 text-decoration-none text-gray","aria-label":"Close",onClick:t},V.a.createElement("i",{className:"icon-cross2 size-16"}))),V.a.createElement("p",{className:"size-14 mb-1_25"},Ar[r].subHeader),r!==Pr.IS_ERROR&&V.a.createElement(A.Fragment,null,r===Pr.IS_SENT?V.a.createElement("div",{className:"d-flex justify-content-center text-offer-message"},V.a.createElement(ks.a,{imageId:"img/eva/your-offer.svg",source:He.d.STATIC,alt:"See your offer",className:"see-your-offer-image"})):V.a.createElement(A.Fragment,null,V.a.createElement(mt.a,{noValidate:!0,onSubmit:this.handleSubmit},V.a.createElement("div",{className:"phone-field-wrapper"},V.a.createElement(Ir.a,{id:"phoneNumber",name:"phoneNumber",type:"tel",placeholder:_r.pattern,label:"Phone",isValid:!o,mask:_r,ref:this.phoneNumberRef,className:"phone-form-group",inputClassName:"phone-number-input pr-1",onBlur:this.handleBlur}),V.a.createElement(ot.a,{type:"submit",color:"success",className:"send-btn text-transform-none px-0","data-tracking-id":"partner_send_to_phone","data-tracking-value":s?`${Or.SEND}2`:Or.SEND,disabled:n},V.a.createElement("div",{className:"d-flex justify-content-center align-items-center"},V.a.createElement("span",{className:Re()({"pr-0_25":n})},n?Or.SENDING:Or.SEND),n&&V.a.createElement(ht.a,{size:14,thickness:1,color:"white"})))),o&&V.a.createElement("p",{className:"small text-danger"},o)),V.a.createElement("div",{className:"size-10"},"Your phone number will only be used to send you this message, nothing else."))))}}Vr.propTypes={toggleModal:k.a.func.isRequired,redemptionCertificateUri:k.a.string.isRequired,fieldRef:k.a.func.isRequired,validate:k.a.func.isRequired,validationErrors:k.a.objectOf(k.a.string),fields:k.a.shape({phoneNumber:k.a.shape({value:k.a.func})}),isSecondary:k.a.bool,location:k.a.shape({})},Vr.defaultProps={validationErrors:{},fields:{phoneNumber:{value:b.a}},isSecondary:!1,location:{}};const xr=Object(q.c)(e=>({location:S()(e,"pageContext.location")}))(Object(Jt.a)(Vr,Nr));a("./site-modules/shared/components/appraisal/trade-in-appraiser-steps/instant-offer-step/instant-offer-step.scss");function kr(e){return{partnerOfferData:{},conditionQuestionResponses:{},conditionPricing:{},submitPartnerError:!1,isSubmittingAppraisal:!1,isAppraisalSubmitComplete:!1,isSubmittingFinished:!1,isScheduleAppointmentModalOpen:!1,store:e.partnerOfferEligibilityResponse.store,noAppraisalReport:!1,disableSticky:!1,isSendToPhoneModalOpen:!1}}const wr=/storeid=\d+&/g;class Rr extends A.Component{constructor(){var e;e=super(...arguments),this.state=kr(this.props),this.onStickyStateChange=(e=>{this.stickyState=e,this.state.isSendToPhoneModalOpen||(this.setState({disableSticky:this.checkDisableStickyState()}),this.stickyState.position===Tr.b.UNDER&&this.stickyState.status===Tr.c.STICKY&&J.a.fireTrackAction({event_type:X.b.ACTION_WIDGET_VIEW,event_data:{action_name:X.b.ACTION_WIDGET_VIEW,action_cause:X.b.ACTION_CAUSE_SCROLL,creative_id:"edm-entry-docked-offer-bar"}}))}),this.getPartnerAppraisalMetadataPayload=(()=>{const e=this.props,t=e.clientIp,a=e.getVehicleData,s=e.eval2657Recipe,i=a().styleId,n=[`EVAL-2657:${s}`];return{metadata:{remote_host_request_id:"EVAL-1950",remote_host_client_id:t?this.hashPartnerAppraisalData(t):"",ab_test:n.join(","),edmunds_style_id:String(i),sem_campaign:`${Ei.a.isSemCampaignAppraisals}`}}}),this.getOfferOverlayType=((e,t,a)=>a?dr.NO_TMV:t?dr.INELIGIBLE:e?dr.OFFER:dr.NO_OFFER),this.setLoadingStatus=(()=>{this.setState({isAppraisalSubmitComplete:!0})}),this.checkDisableStickyState=(()=>this.stickyState.position!==Tr.b.UNDER),this.stickyState={},this.openSendToPhoneModal=(()=>this.setState(()=>({isSendToPhoneModalOpen:!0,disableSticky:!0}))),this.closeSendToPhoneModal=(()=>{this.setState(()=>({isSendToPhoneModalOpen:!1,disableSticky:this.checkDisableStickyState()}))}),this.updateStore=(e=>{if(!e)return;const t=this.state.partnerOfferData,a=t.appointmentUri,s=t.redemptionCertificateUri.replace(wr,`storeid=${e.id}&`),n=a.replace(wr,`storeid=${e.id}&`);this.setState({store:e,partnerOfferData:Object(i.a)({},t,{appointmentUri:n,redemptionCertificateUri:s})},()=>{this.props.updateStepsState("partnerOfferEmailData",Object(i.a)({},this.state.partnerOfferData))})}),this.toggleScheduleAppointDrawerFromOnClick=(e=>{e.preventDefault(),this.toggleScheduleAppointmentDrawer()}),this.toggleScheduleAppointmentDrawer=(()=>this.setState(e=>({isScheduleAppointmentModalOpen:!e.isScheduleAppointmentModalOpen}))),this.initialize=(()=>{this.setState(kr(this.props)),J.a.fireTrackAction(Object(Z.z)(Z.y)),y()(this.props.tmvConditions)?(this.triggerError(),this.fireNoOfferWidgetViewTracking(),this.fireNoOfferVinTracking()):this.submitPartnerAppraisal()}),this.fireNoOfferWidgetViewTracking=(()=>this.state.noAppraisalReport?J.a.fireTrackAction(Z.V):J.a.fireTrackAction(this.isNoOfferNoAppointment()?Z.Q:Z.S)),this.fireNoOfferVinTracking=(()=>J.a.fireTrackAction(Object(Z.T)(this.props.vin))),this.fireOfferWidgetViewTracking=(e=>{J.a.fireTrackAction(xi()({},Z.P,{vin:this.props.vin,event_data:{value:e}})),this.props.fireFbSignal&&J.a.fireTrackAction(Z.w)}),this.scrollTo=(e=>{const t=document.querySelector(e);t&&t.scrollIntoView({behavior:"smooth",block:"start"})}),this.scrollToPartnerOffer=(()=>{this.scrollTo(`.${Z.ib}.${Z.x}`)}),this.submitPartnerAppraisal=(()=>{const e=this.props,t=e.getPartnerAppraisalPayload,a=e.fireMinMaxRangeTracking,s=e.mechanicalStyle,n=e.saveInstantOfferDataToIdm,r=e.tmvConditions;this.setState({isSubmittingAppraisal:!0,isSubmittingFinished:!1},async()=>{const e=String(S()(s,"attributeGroups.PARTNER_MAPPING.properties.CHROME_ID",null)),l="null"!==e?e.split(",").length:0,o=Ce(r),c=s.engineCylinder,d=void 0===c?"":c,p=s.engineSize,m=void 0===p?"":p,u=s.engineType,h=void 0===u?"":u,g=s.engineCompressorType,b=void 0===g?"":g,f=s.transmissionType,E=void 0===f?"":f,v=Object(i.a)({},t(),{conditionPricing:o,bodyStyleCategory:S()(s,"attributeGroups.STYLE_INFO.properties.VEHICLE_STYLE",""),numberOfDoors:S()(s,"attributeGroups.DOORS.properties.NUMBER_OF_DOORS",""),cylinders:String(d),engineSize:String(m),engineType:h,engineCompressorType:b,transmissionType:E,chromeStyleId:e,driveTrain:S()(s,"attributeGroups.DRIVE_TYPE.properties.DRIVEN_WHEELS","")},this.getPartnerAppraisalMetadataPayload()),C=await Object(kt.j)(v);let T=!1;if(y()(C))this.triggerError(),this.fireNoOfferWidgetViewTracking(),this.fireNoOfferVinTracking();else{const e=C.valuation,t=C.expiresDateUtc,s=C.conditionQuestionResponses,i=C.appointmentUri,r=C.code,l=C.redemptionCertificateUri,c=C.vin,d=C.expiresDisplayDate,p=this.state.store||{},m={offerValuation:e,offerVin:c,offerCode:r,offerExpiredDate:d,offerStoreName:p.name,offerStoreAddressLine1:p.addressLine1,offerStoreAddressLine2:p.addressLine2,offerExpiredTs:t,appointmentUri:i,redemptionCertificateUri:l};this.setState({conditionQuestionResponses:s,conditionPricing:o,partnerOfferData:m,submitPartnerError:!1,isSubmittingAppraisal:!1,isSubmittingFinished:!0}),this.updatePartnerOfferEmailDataState(m),a(o),e?(T=!0,this.fireOfferWidgetViewTracking(e)):(this.fireNoOfferWidgetViewTracking(),this.fireNoOfferVinTracking()),n(this.generateIdmInstantOfferData(C))}J.a.fireTrackAction(Object(Z.M)(l,T))})}),this.triggerError=(()=>this.setState({submitPartnerError:!0,isSubmittingAppraisal:!1,isSubmittingFinished:!0})),this.updatePartnerOfferEmailDataState=(e=>{const t=this.props.updateStepsState,a=e.offerValuation,s=e.redemptionCertificateUri,n=e.appointmentUri;t("partnerOfferEmailData",Object(i.a)({},e,{redemptionCertificateUri:a?s:"",appointmentUri:a?n:""}))}),this.hashPartnerAppraisalData=(e=>xn()("sha256",Q.a.get("appraiser").partnerAppraisalKey).update(e).digest("base64")),this.generateIdmInstantOfferData=(e=>{const t=e.sourceId,a=e.vin,s=e.code,i=e.valuation,n=e.createdDateUtc,r=e.expiresDateUtc,l=e.appointmentUri,o=e.redemptionCertificateUri,c=this.state.store||{},d=c.name,p=c.addressLine1,m=c.addressLine2;return{sourceId:t,vin:a,createdTs:new Date(n).toISOString(),expireTs:new Date(r).toISOString(),offerPrice:i,offerCode:s,appointmentUrl:l,redemptionCertificateUrl:o,storeName:d,storeAddressLine1:p,storeAddressLine2:m}}),this.resetState=(()=>{this.setState({isSubmittingAppraisal:!1,isAppraisalSubmitComplete:!1,isSubmittingFinished:!1})}),this.isNoOfferNoAppointment=(()=>{const e=this.props,t=e.isPartnerOfferEligibleVin,a=e.partnerOfferEligibilityResponse,s=a.isEligible,i=a.reason;return!t||!s||i===Z.vb}),this.renderNoOfferMessage=(e=>{const t=this.props,a=t.isMobile,s=t.eval2657Recipe,i=t.getVehicleData;if(e)return null;if(this.isNoOfferNoAppointment()){const e=i(),t=e.makeName,a=e.modelName,s=e.year;return V.a.createElement("div",{className:"no-offer-message"},V.a.createElement("div",{className:"heading-3 mb-1"},"We were unable to find a local offer for your ",s," ",t," ",a),V.a.createElement("div",null,"Use your estimated appraisal as a reference point to see if a dealership's trade-in offer is in the ballpark, or as a starting point when selling private party."))}const n=this.state,r=n.conditionPricing,l=n.partnerOfferData.appointmentUri,o=n.store;return V.a.createElement("div",{"data-tracking-parent":Z.R,className:"offer-retarget-card text-gray-darker text-center pt-2_5 pb-1_5 px-2 mb-2"},V.a.createElement("span",{className:"icon-edmunds-car text-primary size-30"}),V.a.createElement("h2",{className:"size-24"},"We weren't able to make an online offer"),V.a.createElement("p",{className:"size-16 mb-2"},"Online offers are based on recent appraisals of cars like yours and we haven't seen many like yours lately. Schedule an appointment to complete your appraisal at your local CarMax."),V.a.createElement(Qi,{conditionPricing:r,isMobile:a,store:o,eval2657Recipe:s,appointmentUri:l,renderNoOffer:!0,toggleScheduleAppointmentDrawer:this.toggleScheduleAppointDrawerFromOnClick}))}),this.renderNoAppraisalReportMessage=(e=>{this.setState({noAppraisalReport:e})}),this.renderDockerBarContainer=((e,t)=>V.a.createElement(Tr.a,{className:"docked-bar",stickyClassName:"px-0",stickyWrapperClassName:Re()("w-100 bg-white bottom",{hidden:this.state.disableSticky}),onStateChange:this.onStickyStateChange},V.a.createElement("div",{className:"docked-bar-container d-flex justify-content-between align-items-center px-1_5","data-tracking-parent":"edm-entry-docked-offer-bar"},V.a.createElement("div",null,V.a.createElement(hi.a,null),V.a.createElement("div",{className:"text-gray-darker"},V.a.createElement("span",{className:"size-24 font-weight-bold mr-0_25"},Object(Ge.a)(t),"*"),V.a.createElement("span",{className:"size-14"},"Offer"))),V.a.createElement("div",null,e)))),this.renderOffer=function(t){let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const s=e.props,i=s.getVehicleData,n=s.isPartnerOfferEligibleVin,r=s.vin,l=s.partnerOfferEligibilityResponse.nearestStores,o=s.isMobile,c=s.handleEmailReportClick,d=s.emailReportStatus,p=s.resetEmailReportStatus,m=s.condition,u=s.eval2657Recipe,h=e.state,g=h.submitPartnerError,f=h.partnerOfferData,E=f.offerValuation,v=f.offerCode,C=f.appointmentUri,S=f.redemptionCertificateUri,T=f.offerExpiredTs,I=h.conditionPricing,N=h.isSubmittingFinished,_=h.noAppraisalReport,O=h.store,P=h.isSendToPhoneModalOpen,A=!(n&&!g&&!!E&&!y()(I)),x=_?null:e.renderNoOfferMessage(a),k=A?x:V.a.createElement(xt.a,null,a&&V.a.createElement("hr",{className:"my-2"}),V.a.createElement(Gn,{getVehicleData:i,conditionPricing:I,valuation:E,code:v,redemptionCertificateUri:S,expiresDateUtc:T,vin:r,emailReportStatus:d,resetEmailReportStatus:p,isSecondary:a,isMobile:o,condition:m.toLowerCase(),appointmentUri:C}),o&&!a&&V.a.createElement(Oe.a,{name:"EVAL-3528",showDefault:!0},V.a.createElement(Oe.c,{name:"ctrl",isDefault:!0}),V.a.createElement(Oe.c,{name:"chal0"}),V.a.createElement(Oe.c,{name:"chal1"},e.renderDockerBarContainer(V.a.createElement(ot.a,{color:"success",className:"py-0_5 view-offer-btn","data-tracking-id":"view_offer",onClick:e.scrollToPartnerOffer},V.a.createElement("span",{className:"size-16 text-capitalize text-white"},"View Offer")),E)),V.a.createElement(Oe.c,{name:"chal2"},e.renderDockerBarContainer(V.a.createElement(ot.a,{color:"success",className:"py-0_5 view-offer-btn","data-tracking-id":"partner_send_to_phone",onClick:e.openSendToPhoneModal},V.a.createElement("span",{className:"size-16 text-capitalize text-white"},"Text Offer")),E))),V.a.createElement(Wi,{appointmentUri:C,redemptionCertificateUri:S,nearestStores:l,store:O,isMobile:o,handleEmailReportClick:c,emailReportStatus:d,isSecondary:a,handleOpenSendToPhoneModal:e.openSendToPhoneModal,updateStore:e.updateStore,toggleScheduleAppointmentDrawer:"chal"!==u||y()(O)?void 0:e.toggleScheduleAppointDrawerFromOnClick}),!a&&V.a.createElement(ua.a,{className:"instant-offer-send-to-phone-modal",isOpen:P,toggle:e.closeSendToPhoneModal},V.a.createElement(ga.a,null,V.a.createElement(xr,{toggleModal:e.closeSendToPhoneModal,redemptionCertificateUri:S,isSecondary:a}))));return V.a.createElement("div",{className:Re()({"pb-2":a&&A})},t?V.a.createElement(Rn,{className:"pb-1",setLoadingStatus:b.a,isSubmittingFinished:N,isMobile:o}):k)}}static getDerivedStateFromProps(e,t){return{isAppraisalSubmitComplete:e.isStepActive&&t.isSubmittingFinished&&t.isAppraisalSubmitComplete||!1===e.isStepActive}}componentDidMount(){this.props.isStepActive&&this.initialize()}componentDidUpdate(e,t){const a=this.props,s=a.isStepActive,i=a.isPartnerOfferEligibleVin,n=a.addOfferTagToRecorder,r=a.setAppraiseFinished,l=a.isStepFinal,o=this.state,c=o.submitPartnerError,d=o.partnerOfferData.offerValuation,p=o.isAppraisalSubmitComplete,m=s!==e.isStepActive,u=!s&&m;s&&m?this.initialize():u&&this.resetState();const h=i&&!c&&!!d;t.partnerOfferData.offerValuation!==d&&h&&n(),l&&s&&r(p)}render(){const e=this.props,t=e.isPartnerOfferEligibleVin,a=e.hideDelightedSurvey,i=e.handleDelightedSurveyClick,n=e.appraisalReportProps,r=e.isStepActive,l=e.vin,o=e.eval2657Recipe,c=e.getVehicleData,d=e.isMobile,p=e.partnerOfferEligibilityResponse,m=p.isEligible,u=p.reason,h=p.nearestStores,g=e.vehicle,b=e.zipCode,f=this.state,E=f.submitPartnerError,v=f.partnerOfferData,C=v.offerValuation,T=v.offerCode,I=v.redemptionCertificateUri,N=v.offerExpiredTs,_=f.isSubmittingFinished,O=f.isAppraisalSubmitComplete,P=f.conditionPricing,x=f.isScheduleAppointmentModalOpen,k=f.store,w=f.noAppraisalReport,R=t&&!E&&!!C&&!y()(P),M=!R,j=r&&!O,D=!m||u===Z.vb||!t,F=M&&!j&&D,q=c(),z=q.makeName,B=q.modelName,$=q.year,Y=this.getOfferOverlayType(R,D,w),H=S()(g,"make.slug");return V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,className:"instant-offer-step"},this.renderOffer(j),V.a.createElement("div",{className:Re()({"d-none":j})},!w&&!M&&V.a.createElement(Oe.a,{name:"EVAL-3573",showDefault:!0},V.a.createElement(Oe.c,{name:"ctrl",isDefault:!0},V.a.createElement(vr,{makeSlug:H})),V.a.createElement(Oe.c,{name:"chal1"},V.a.createElement(Sr,{offerPrice:C,distanceToNearestStore:h&&h.length&&h[0].distance,offerCode:T,offerExpDate:N,make:z,model:B,year:$,zipCode:b,vin:l,redemptionCertificateUri:I,isMobile:d,eval3573Recipe:"chal1"})),V.a.createElement(Oe.c,{name:"chal2"},V.a.createElement(Sr,{offerPrice:C,distanceToNearestStore:h&&h.length&&h[0].distance,offerCode:T,offerExpDate:N,make:z,model:B,year:$,zipCode:b,vin:l,redemptionCertificateUri:I,isMobile:d,eval3573Recipe:"chal2"}))),!y()(n)&&V.a.createElement(xt.a,null,!w&&V.a.createElement("hr",{className:"my-2"}),V.a.createElement(ln,Object(s.a)({},n,{showReportExtendedPriceOnly:!0,renderNoAppraisalReportMessage:this.renderNoAppraisalReportMessage,toggleScheduleAppointmentDrawer:this.toggleScheduleAppointDrawerFromOnClick}))),this.renderOffer(j,!0),!M&&!a&&V.a.createElement(A.Fragment,null,V.a.createElement("hr",null),V.a.createElement(Pi,{onClick:i,isEpo:!0})))),!w&&F&&V.a.createElement(U.a,{xs:12,className:"px-0"},V.a.createElement(L.a,null,V.a.createElement(U.a,{xs:12,className:"px-0"},V.a.createElement("hr",null),V.a.createElement(an,{getVehicleData:c})))),"chal"===o&&!y()(k)&&V.a.createElement(cr,{getVehicleData:c,onToggle:this.toggleScheduleAppointmentDrawer,isOpen:x,storeInfo:k,valuation:C,vin:l,isMobile:d}),V.a.createElement(ur,{overlayType:Y,shouldOpen:r&&_,isMobile:d,onClosed:this.setLoadingStatus}))}}Rr.propTypes={getPartnerAppraisalPayload:k.a.func.isRequired,getVehicleData:k.a.func.isRequired,condition:k.a.string,options:k.a.arrayOf(k.a.shape({})),color:k.a.shape({name:k.a.string}),isMobile:k.a.bool,isStepActive:k.a.bool,isPartnerOfferEligibleVin:k.a.bool,vin:k.a.string,zipCode:k.a.string,mileage:k.a.string,partnerOfferEligibilityResponse:kt.a.Eligibility,hideDelightedSurvey:k.a.bool,handleDelightedSurveyClick:k.a.func,appraisalReportProps:k.a.shape({}),fireMinMaxRangeTracking:k.a.func,updateStepsState:k.a.func,addOfferTagToRecorder:k.a.func,mechanicalStyle:ee.b.MechanicalStyleEntity,handleEmailReportClick:k.a.func.isRequired,saveInstantOfferDataToIdm:k.a.func.isRequired,emailReportStatus:k.a.string,resetEmailReportStatus:k.a.func,clientIp:k.a.string,tmvConditions:k.a.shape({}),eval2657Recipe:k.a.string,fireFbSignal:k.a.bool,vehicle:k.a.shape({}),setAppraiseFinished:k.a.func,isStepFinal:k.a.bool},Rr.defaultProps={isStepActive:!1,condition:"",color:{},isMobile:!1,isPartnerOfferEligibleVin:!1,partnerOfferMileage:null,mileage:null,vin:null,zipCode:null,options:[],partnerOfferEligibilityResponse:{store:{},isEligible:{},reason:null,nearestStores:[]},hideDelightedSurvey:!1,handleDelightedSurveyClick:null,appraisalReportProps:{},fireMinMaxRangeTracking:b.a,updateStepsState:b.a,addOfferTagToRecorder:b.a,mechanicalStyle:{},emailReportStatus:"",resetEmailReportStatus:b.a,clientIp:"",tmvConditions:null,eval2657Recipe:"ctrl",fireFbSignal:!1,vehicle:{},setAppraiseFinished:b.a,isStepFinal:!1};const Mr=Object(q.c)((e,t)=>{const a=t.getVehicleData().styleId;return{clientIp:S()(e,"visitor.clientIp"),tmvConditions:S()(e.vehicle,Object(ee.C)(a))}})(Rr);class jr extends A.Component{componentDidUpdate(e){const t=this.props,a=t.isStepFinal,s=t.isStepActive,i=t.setAppraiseFinished,n=s!==e.isStepActive;a&&(s&&n)&&i(!0)}render(){const e=this.props,t=e.isMobile,a=e.appraisalReportProps,i=e.stepId,n=e.trackingCreativeId;return V.a.createElement(ln,Object(s.a)({},a,{isMobile:t,stepId:i,trackingCreativeId:n}))}}function Dr(e){let t=e.stepId,a=e.locationAndStyleProps,i=e.optionsAndColorsProps,n=e.conditionAndMileageProps,r=e.appraisalReportProps,l=e.licensePlateAndVinProps,o=e.offerConditionsProps,c=e.instantOfferProps,d=e.escapeHatchProps,p=e.isMobile,m=e.isExtendedReport;switch(t){case Z.F:{const e=a.isQueryPredefinedVin,t=a.hasOneOrLessStyleId;return!m||e&&t?V.a.createElement(St,a):V.a.createElement(es,a)}case Z.m:return V.a.createElement(Ns,Object(s.a)({},i,{isMobile:p}));case Z.p:return V.a.createElement(Vs,n);case Z.ab:return V.a.createElement(ln,r);case Z.A:return V.a.createElement(Oe.a,{name:"EVAL-3463",showDefault:!0},V.a.createElement(Oe.c,{name:"ctrl",isDefault:!0},V.a.createElement(Ii,Object(s.a)({},l,{isMobile:p,isLicencePlateAndVinStep:!0}))),V.a.createElement(Oe.c,{name:"chal0"},V.a.createElement(Ii,Object(s.a)({},l,{isMobile:p,isLicencePlateAndVinStep:!0}))),V.a.createElement(Oe.c,{name:"chal1"},V.a.createElement(Ii,Object(s.a)({},l,{isMobile:p,isLicencePlateAndVinStep:!0,eval3463Recipe:"chal1"}))),V.a.createElement(Oe.c,{name:"chal2"},V.a.createElement(Ii,Object(s.a)({},l,{isMobile:p,isLicencePlateAndVinStep:!0,eval3463Recipe:"chal2"}))));case Z.N:return V.a.createElement(An,o);case Z.x:return d.vin?V.a.createElement(Mr,Object(s.a)({},c,{isMobile:p,fireFbSignal:!0})):V.a.createElement(jr,Object(s.a)({},d,{isMobile:p,stepId:t,trackingCreativeId:Z.C}));default:return null}}jr.propTypes={stepId:k.a.string,trackingCreativeId:k.a.string,appraisalReportProps:k.a.shape({isEscapeHatch:k.a.bool,licensePlateAndVinProps:k.a.shape({})}),isStepActive:k.a.bool,isMobile:k.a.bool,setAppraiseFinished:k.a.func,isStepFinal:k.a.bool},jr.defaultProps={stepId:"",trackingCreativeId:"",appraisalReportProps:{},isStepActive:!1,isMobile:!1,setAppraiseFinished:b.a,isStepFinal:!1},Dr.propTypes={stepId:k.a.string.isRequired,locationAndStyleProps:k.a.shape({}).isRequired,optionsAndColorsProps:k.a.shape({}).isRequired,conditionAndMileageProps:k.a.shape({}).isRequired,appraisalReportProps:k.a.shape({}).isRequired,licensePlateAndVinProps:k.a.shape({}).isRequired,offerConditionsProps:k.a.shape({}).isRequired,instantOfferProps:k.a.shape({}).isRequired,escapeHatchProps:k.a.shape({}).isRequired,isMobile:k.a.bool,isExtendedReport:k.a.bool},Dr.defaultProps={isMobile:!1,isExtendedReport:!1};a("./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser.scss");a.d(t,"TradeInAppraiserUI",function(){return Zr}),a.d(t,"stateToPropsConfig",function(){return Gr}),a.d(t,"mapDispatchToProps",function(){return Wr}),a.d(t,"mapStateToProps",function(){return Qr}),a.d(t,"TradeInAppraiserIdmWrapper",function(){return Kr}),a.d(t,"TradeInAppraiser",function(){return Xr});const Lr={BUTTON_CLICK:{action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_BUTTON_CLICK},USER_INPUT:{action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_USER_INPUT}},Fr=[Z.F,Z.m,Z.p],Ur="edm-entry-appraisal-estimate",qr=!0,zr={DRAWER:Z.h,EXTENDED:Z.L};function Br(e){let t=e.zipCode,a=e.isZipCodeValid,s=e.selectedStyle,n=e.errorMap,r=void 0===n?new Map:n,l=e.isPartnerOfferEligible,o=void 0!==l&&l,c=e.location,d=e.isPrepopulatedQueryParams,p=void 0!==d&&d,m=e.showStepBaseTitle,u=void 0!==m&&m,h=e.isExtendedReport,g=e.hasVinMismatchError,b=void 0!==g&&g,f=e.isVinFromDrawer,E=void 0!==f&&f,v=e.isEscapeHatch,y=void 0===v?qr:v,C=e.predefinedVin,S=void 0===C?{}:C;const T=Object(be.a)(c),I=T.zip,N=T.colorId,_=T.mileage,O=T.condition,P=void 0===O?"":O,A=T.styleIds,V=p?{mileage:_||"",condition:Z.n[P.toUpperCase()]||Z.n.AVERAGE,color:N?{id:N}:{}}:{mileage:"",condition:Z.n.AVERAGE,color:{}},x=h?zr.EXTENDED:zr.DRAWER;return Object(i.a)({steps:x,zipCode:I||t,vehicle:{style:s},isZipCodeValid:a,isPartnerOfferEligible:o},V,{options:[],style:"",styleIds:A,isMileageValid:!0,allConditionTotalPrices:{},appraisalEmailData:{},partnerOfferEmailData:{redemptionCertificateUri:"",appointmentUri:""},emailReportStatus:"",payoffAmount:0,errorMap:r,isPartnerOfferEligibleVin:null,isActiveInventory:null,isVinValid:!0,showStepBaseTitle:u,areQuestionnaireResponsesValid:!0,partnerEquipment:[],partnerConditionPricing:{},partnerOfferEligibilityResponse:{},partnerQuestionnaireResponses:{},vin:S.vin||"",hideVACDelightedSurvey:!1,hideEPODelightedSurvey:!1,hasVinMismatchError:b,isVinFromDrawer:E,isRecordingStarted:!1,appraisalReason:"",selectedReportType:Z.kb,showAddEquipment:!0,isEscapeHatch:y,isLoadingColorsAndOptions:!1,isAllowedToPredefineVin:!0})}const $r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.isEval3460Enabled,a=e.profileOfferVin,s=e.location,i=Object(be.a)(s).vin;return{vin:i||t&&a||"",isQueryPredefinedVin:!!i}},Yr=null,Hr={VAC:"vacDelightedSurveyViewed",EPO:"epoDelightedSurveyViewed"};class Zr extends A.Component{constructor(){var e;e=super(...arguments),this.state=Br({zipCode:this.props.isUnknownVisitorZip?"":this.props.zipCode,selectedStyle:this.props.selectStyle?this.props.estimatedVehicle:{},location:this.props.location,isUnknownVisitorZip:this.props.isUnknownVisitorZip,isZipCodeValid:!0,isPrepopulatedQueryParams:!0,isExtendedReport:this.props.isExtendedReport,predefinedVin:$r(this.props)}),this.onVehicleOverride=(async(e,t)=>{const a=e.make,s=e.model,i=e.year,n=e.style;await this.setGeneralVehicleData(a,s,i,n,!0);const r=this.getActiveStep().nextId;this.changeStep({stepId:r,creativeId:t||Ur})}),this.onPropsZipCodeChange=(e=>this.setState({zipCode:e},()=>this.setValidatedZipStatus(!0))),this.onMileageBlur=(()=>{this.setState(e=>({mileage:Object(le.p)(e.mileage),isMileageValid:Object(le.o)(Z.p,le.g,e.mileage,{styleYear:S()(e.vehicle,"style.year")})}),()=>{const e=this.state,t=e.mileage;if(e.isMileageValid){const e=this.props.isExtendedReport;he.a.fireEvent("update_mileage",{event_data:Object(i.a)({},Lr.USER_INPUT,{creative_id:e?Z.c:Z.t,value:t})})}})}),this.setValidatedZipStatus=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.a;e.setState({isZipCodeValid:t},()=>{a(),e.toggleStepDone(e.isLocationAndStyleStepValid(),Z.F)})},this.setVehicleDataForExtendedReport=(()=>{const e=this.props,t=e.isExtendedReport,a=e.estimatedVehicle,s=S()(this.state,"vehicle.style"),i=y()(s)?null:s;t&&a&&this.setGeneralVehicleData(a.make,a.model,{year:a.year.toString()},i,!0)}),this.setGeneralVehicleData=((e,t,a,s,i)=>{const n=this.state.vehicle;e&&n.make&&!i&&this.clearStepsData();const r={make:e,model:t,year:a,style:s};s&&!m()(n.style,s)&&this.setLoadingColorsAndOptions(!0),this.setState({vehicle:r},()=>this.toggleStepDone(this.isLocationAndStyleStepValid(),Z.F))}),this.setAdditionalStepsData=((e,t)=>this.setState(()=>({[e]:t}))),this.setPartnerOfferEligibility=(e=>this.setState({isPartnerOfferEligible:e})),this.setPartnerOfferVinEligibility=(e=>this.setState({isPartnerOfferEligibleVin:e},()=>{e||this.state.hasVinMismatchError||(this.fireSavingAppraisalDataToIdm(),he.a.fireEvent("partner_submit_vin",{event_data:{creative_id:Z.B,value:Z.gb.vin_ineligible}}))})),this.setActiveInventory=(e=>this.setState({isActiveInventory:e},()=>{this.fireSavingAppraisalDataToIdm()})),this.getLocationAndStyleData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.state,s=a.zipCode,i=a.isZipCodeValid,n=a.errorMap,r=a.styleIds,l=a.vehicle,o=a.partnerOfferEligibilityResponse,c=a.isPartnerOfferEligibleVin,d=a.vin,p=a.hasVinMismatchError,m=a.isAllowedToPredefineVin,u=a.isLoadingColorsAndOptions,h=e.props,g=h.estimatedVehicle,b=h.selectStyle,f=h.isExtendedReport,E=h.isMobile,v=h.isEval3460Enabled,y=$r(e.props),C=y.vin,T=y.isQueryPredefinedVin;return{zipCode:s,estimatedVehicle:g,vehicle:l,selectStyle:b,isZipCodeValid:i,onZipCodeChange:e.changeZipCode,onDropdownsSelect:e.setGeneralVehicleData,errorMap:n,isExtendedReport:f,isMobile:E,updateStepsState:e.setAdditionalStepsData,hasOneOrLessStyleId:!r||1===r.split(",").length,changeStep:e.changeStep,vin:d,isQueryPredefinedVin:T,clearVin:()=>e.changeVin(""),updateVinAndContinue:async t=>{await e.changeVin(t)},isStepActive:t.isActive,isPartnerOfferEligibleVin:c,isEligibleHardcodeYmmBypass:S()(o,"reason")===Z.vb,onPartnerOfferVinEligibilityUpdate:e.setPartnerOfferVinEligibility,onActiveInventoryCheck:e.setActiveInventory,updateErrorMapAndScrollToInvalid:e.updateErrorMapAndScrollToInvalid,isProfileOfferVinPrepopulationEnabled:v&&!T,hasVinMismatchError:p,queryVin:C,isAllowedToPredefineVin:m,checkVinMismatchError:e.checkVinMismatchError,isLoadingColorsAndOptions:u}},this.getOptionsAndColorsData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.state,s=a.vehicle,i=a.errorMap,n=a.isZipCodeValid,r=a.color,l=e.props,o=l.isExtendedReport,c=l.drawerCreativeId;return{onOptionsSelect:e.selectOptions,onColorSelect:e.selectColors,updateStepsState:e.setAdditionalStepsData,isStepActive:t.isActive,vehicle:s,errorMap:i,onPartnerOfferEligibilityUpdate:e.setPartnerOfferEligibility,isExtendedReport:o,isZipCodeValid:n,preSelectedColor:r,setLoadingColorsAndOptions:e.setLoadingColorsAndOptions,drawerCreativeId:c}},this.getConditionAndMileageData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.state,s=a.mileage,i=a.condition,n=a.isMileageValid,r=a.errorMap,l=a.vehicle.style||{},o=l.makeName,c=l.modelName,d=l.year;return{mileage:s,condition:i,isMileageValid:n,onMileageChange:e.changeMileage,onConditionChange:e.selectCondition,getMileageRef:e.getMileageRef,onMileageBlur:e.onMileageBlur,errorMap:r,isStepActive:t.isActive,make:o,model:c,year:d}},this.getAppraisalReportData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.state,s=a.mileage,i=a.color,n=a.condition,r=a.options,l=a.partnerEquipment,o=a.zipCode,c=a.isZipCodeValid,d=a.isMileageValid,p=a.emailReportStatus,m=a.isPartnerOfferEligible,u=a.hideVACDelightedSurvey,h=a.selectedReportType,g=a.partnerOfferEligibilityResponse,b=a.vin,f=a.showAddEquipment,E=e.props,v=E.isMobile,y=E.isExtendedReport,C=E.sellYourCarConfig,S=E.sellingPrice,T=E.msrp,I=E.residualValue,N=E.isPurchase,_=E.isUsed,O=E.onDone,P=E.mechanicalStyle,A=$r(e.props).vin,V=l.length>0;return{getVehicleData:e.getVehicleData.bind(e),changeStep:e.changeStep,options:r,showAddEquipment:f,hasPartnerEquipment:V,color:i,mileage:s,condition:n,zipCode:o,isExtendedReport:y,isMobile:v,isZipCodeValid:c,isMileageValid:d,isAllStepsCompleted:e.checkStepsCompleteness(),onReportFormed:e.toggleStepDone,updateStepsState:e.setAdditionalStepsData,handleEmailReportClick:e.handleEmailReportClick,emailReportStatus:p,resetEmailReportStatus:e.resetEmailReportStatus,sellYourCarConfig:C,isReportActive:t.isActive&&t.id===Z.ab,stepNextId:t.nextId,isPartnerOfferEligible:m,hideDelightedSurvey:u,handleDelightedSurveyClick:e.handleVACDelightedSurveyClick,onPayoffChange:e.handlePayoffChange,sellingPrice:S,msrp:T,residualValue:I,isPurchase:N,queryVin:A,isUsed:_,selectedReportType:h,partnerOfferEligibilityResponse:g,vin:b,toggleAppraiserDrawer:O,getPartnerAppraisalPayload:e.getPartnerAppraisalPayload.bind(e),mechanicalStyle:P}},this.getLicensePlateAndVinData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=t.nextId,s=t.trackingParentId,i=t.isDone,n=e.state,r=n.vin,l=n.vehicle,o=n.partnerOfferEligibilityResponse,c=n.isVinFromDrawer,d=n.hasVinMismatchError,p=n.isPartnerOfferEligibleVin,m=n.isAllowedToPredefineVin,u=e.props,h=u.isExtendedReport,g=u.isMobile,b=$r(e.props),f=b.vin,E=b.isQueryPredefinedVin;return{vehicle:l,isStepActive:t.isActive&&t.id===Z.A,stepNextId:a,updateVinAndContinue:async function(t){let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];await e.changeVin(t),i||e.changeStep({stepId:a,creativeId:s})},clearVin:()=>e.changeVin(""),changeStep:e.changeStep,onPartnerOfferVinEligibilityUpdate:e.setPartnerOfferVinEligibility,onActiveInventoryCheck:e.setActiveInventory,updateErrorMapAndScrollToInvalid:e.updateErrorMapAndScrollToInvalid,onValueChange:e.toggleLicensePlateAndVinStepDone,vin:r,isExtendedReport:h,isEligibleHardcodeYmmBypass:S()(o,"reason")===Z.vb,queryVin:f,isQueryPredefinedVin:E,isVinFromDrawer:c,hasVinMismatchError:d,isStepDone:i,isPartnerOfferEligibleVin:p,updateStepsState:e.setAdditionalStepsData,isMobile:g,isAllowedToPredefineVin:m}},this.getOfferConditionsData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.state,s=a.errorMap,i=a.vin,n=a.vehicle,r=a.partnerOfferEligibilityResponse,l=a.isVinFromDrawer,o=$r(e.props).vin;return{isStepActive:t.isActive&&t.id===Z.N,updateQuestionnaireResponses:e.updateQuestionnaireResponses,onPartnerOfferVinEligibilityUpdate:e.setPartnerOfferVinEligibility,vehicle:n,vin:i,errorMap:s,isVinFromDrawer:l,isEligibleHardcodeYmmBypass:S()(r,"reason")===Z.vb,predefinedVin:o}},this.getPartnerAppraisalPayload=(()=>{const e=this.state,t=e.vehicle.style,a=e.zipCode,s=e.vin,i=e.condition,n=e.options,l=e.mileage,o=e.partnerEquipment,c=e.partnerQuestionnaireResponses,d=e.color,p=t.makeName,m=t.modelName,u=t.year,h=t.name,g=t.trimName,b={},f={};o.forEach(e=>{const t=!!n.find(t=>t.name===e);b[e]=t}),Object.keys(c).forEach(e=>{const t=c[e],a=me[e];if(a)if("object"==typeof t){if(!y()(t)){const e=a;Object.keys(r()(t,e=>e)).forEach(t=>{const a=parseInt(t,10)-1,s=S()(e,[a,"v1Key"]);s&&(f[s]="true")})}}else{const e=a.v1Key,s=a.v1ValueByV2AnswerId;f[e]=s[t]}});const E=parseInt(l,10),v=(new Date).toISOString();return{sourceId:j()(`${E}|${s}|${v}`,Z.v),vin:s,mileage:E,make:p,model:m,year:u,color:d.name||null,style:h,trim:g,condition:i,zipCode:a,createdDateUtc:v,equipment:b,conditionQuestionResponses:f}}),this.getInstantOfferData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.props,s=a.isExtendedReport,n=a.mechanicalStyle,r=a.isMobile,l=a.setAppraiseFinished;if(!s)return{};const o=e.state,c=o.color,d=o.condition,p=o.isPartnerOfferEligibleVin,m=o.vin,u=o.partnerOfferMileage,h=o.partnerOfferEligibilityResponse,g=o.mileage,f=o.options,E=o.zipCode,v=o.hideEPODelightedSurvey,y=o.emailReportStatus,C=o.vehicle,S=t.isActive&&t.id===Z.x,T=Object(i.a)({},e.getAppraisalReportData(t),{onReportFormed:b.a,stepId:Z.x,creativeId:Z.f,isReportActive:S});return{getVehicleData:e.getVehicleData.bind(e),getPartnerAppraisalPayload:e.getPartnerAppraisalPayload.bind(e),condition:d,color:c,partnerOfferMileage:u,partnerOfferEligibilityResponse:h,mileage:g,vin:m,options:f,zipCode:E,isStepActive:S,isPartnerOfferEligibleVin:p,hideDelightedSurvey:v,handleDelightedSurveyClick:e.handleEPODelightedSurveyClick,updateStepsState:e.setAdditionalStepsData,fireMinMaxRangeTracking:e.fireMinMaxRangeTracking,addOfferTagToRecorder:e.addOfferTagToRecorder,handleEmailReportClick:e.handleEmailReportClick,saveInstantOfferDataToIdm:e.saveInstantOfferDataToIdm,emailReportStatus:y,resetEmailReportStatus:e.resetEmailReportStatus,mechanicalStyle:n,appraisalReportProps:T,vehicle:C,isMobile:r,setAppraiseFinished:l,isStepFinal:t.isFinal}},this.getEscapeHatchData=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=e.props,s=a.isExtendedReport,n=a.setAppraiseFinished;if(!s)return{};const r=t.isActive&&t.id===Z.x,l=e.state.vin,o=e.getLicensePlateAndVinData(t);return{isStepActive:r,vin:l,appraisalReportProps:Object(i.a)({},e.getAppraisalReportData(t),{onReportFormed:b.a,isEscapeHatch:qr,isReportActive:r,licensePlateAndVinProps:Object(i.a)({},o,{trackingCreativeId:Z.C,updateVinAndContinue:async t=>{await e.changeVin(t,qr),e.scrollToNextStep()},clearVin:()=>e.changeVin("",qr),onValueChange:b.a,isStepActive:r,stepId:t.id})}),setAppraiseFinished:n,isStepFinal:t.isFinal}},this.setVehicleId=(()=>{const e=S()(this.state.vehicle,"style.id");e&&this.lastSavedStyleId!==e&&(this.lastSavedStyleId=e,this.vehicleId=R()())}),this.getMileageRef=(e=>{this.mileage=e}),this.getActiveStep=(()=>this.state.steps.find(e=>e.isActive)),this.getValidationErrors=(e=>{const t=this.state,a=t.zipCode,s=t.vehicle,i=t.color,n=t.mileage,r=t.condition,l=t.isZipCodeValid,o=t.partnerQuestionnaireResponses,c=S()(s,"make"),d=S()(s,"model"),p=S()(s,"year"),m=S()(s,"style"),u={make:c,model:d,year:p,zipCode:a,style:m,color:S()(i,"id"),mileage:n,condition:r,[le.b]:o},h={styleYear:S()(m,"year")},g=new Map;return le.k[e]&&le.k[e].forEach(t=>{let a=t.fieldName;const s="zipCode"===a&&!l;if(E()(u,a)&&!Object(le.o)(e,a,u[a],h)||s){const t=s?"":u[a];g.set(a,Object(le.n)(e,a,t,h))}}),g}),this.getVehicleData=(()=>{const e=this.state.vehicle,t=S()(e,"make.name",""),a=S()(e,"model.name",""),s=S()(e,"style.makeSlug",""),i=S()(e,"style.modelSlug",""),n=S()(e,"style.name",""),r=S()(e,"style.id",""),l=S()(e,"style.submodels.name","");return{makeName:t,modelName:a,makeSlug:s,modelSlug:i,styleName:n,year:S()(e,"style.year",null),type:l,styleId:r,publicationState:S()(e,"style.publicationState","")}}),this.getVehicleStyle=(()=>this.state.vehicle&&this.state.vehicle.style&&this.state.vehicle.style.slug||null),this.getVehicleYear=(()=>this.state.vehicle&&this.state.vehicle.year&&this.state.vehicle.year.year||null),this.getVehicleColorManufactureCode=(()=>this.state.color&&this.state.color.manufactureOptionCode||null),this.getVehicleOptionsCount=(()=>this.state.optionsCount),this.getSelectedOptionsCount=(()=>this.state.options.length),this.getTotalPrices=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.state.allConditionTotalPrices;const a=e.state.condition;return a&&t&&t[a.toLowerCase()]||{}},this.setLocalStorage=(e=>{let t=e.tradeIn;const a=this.getVehicleMMY();this.storage.set(G.y.LEASE_PREFERENCES,Object(i.a)({},this.storage.get(G.y.LEASE_PREFERENCES),a,{tradeIn:t})),this.storage.set(G.y.LOAN_PREFERENCES,Object(i.a)({},this.storage.get(G.y.LOAN_PREFERENCES),a,{tradeIn:t}))}),this.getVehicleMMY=(()=>{const e=this.state.vehicle;return{make:e.make.name,model:e.model.name,year:e.year.year}}),this.setComputedEvalExperimentsTags=(()=>{const e=H.a.getComputedExperiments(),t=Object.keys(e).filter(e=>/EVAL/gim.test(e)).map(t=>({[t.toLowerCase()]:e[t].recipe.value}));fe.a.addTag(t),t.some(e=>"ctrl"!==Object.values(e)[0])&&fe.a.addTag("hasABTestEVALChallenger")}),this.setLoadingColorsAndOptions=(e=>{this.setState({isLoadingColorsAndOptions:e})}),this.fireRetargetTracking=(()=>{J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:X.b.ACTION_APPRAISE_VEHICLE,action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_BUTTON_CLICK,subaction_name:X.b.FLOW_VARIANT,creative_id:Z.c,value:X.b.USE_SAVED_INFO}})}),this.fireSavingAppraisalDataToIdm=(()=>{const e=this.props,t=e.tmvConditions,a=e.isExtendedReport,s=this.state,i=s.options,n=s.vehicle;if(a&&!h()(t)&&!y()(n.style)){const e=!0,a=Ie(t,i),s=Ne(a);this.saveAppraiserDataToIdm(s,e)}}),this.resetEmailReportStatus=(()=>this.setState({emailReportStatus:""})),this.addOfferTagToRecorder=(()=>{this.props.isSessionRecorderActive&&fe.a.addTag("offer")}),this.activateSessionRecorder=(()=>{const e=this.props,t=e.visitorId,a=e.isSessionRecorderActive,s=e.isExtendedReport,i=this.state.isRecordingStarted;if(!s||!a||i)return;const n=Q.a.get("appraiser").sessionRecorder,r=n.debug,l=n.wid;fe.a.track(l,{tag:["Appraisal Partner Offer session",{visitorId:t}],debug:r}),this.setComputedEvalExperimentsTags(),this.setState({isRecordingStarted:!0})}),this.generateIdmDataToSave=function(t,a){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=e.props.isAuthenticated,r=e.state.payoffAmount,l=void 0===r?0:r,o=e.getTotalPrices(t),c=y()(o)?{}:Object(ue.a)({tradeIn:o[Z.kb],tradeInOwedAmount:l}),d=Object(i.a)({},tt(e.state,e.vehicleId,o,t,s),n?{}:{isAnonymous:!0},c);return a&&(d.pii=function(e,t){const a=e.vehicle.style,s=a.year,i=a.name,n=a.makeNiceName,r=a.modelNiceName,l=a.submodels.slug;return{vehicles:{[t]:{savedTs:Je(),niceMake:n,niceModel:r,niceSubModel:l,styleName:i,year:String(s),appraisalRef:et(t),currentVehicle:!0}}}}(e.state,e.vehicleId)),d},this.saveEstimatedPayments=(()=>{const e=this.state,t=e.allConditionTotalPrices,a=e.payoffAmount,s=e.appliedTradeIn,i=e.vehicle,n=this.props,r=n.onTradeInUpdate,l=n.onDone,o=n.onVehicleUpdate,c=n.isAuthenticated,d=this.getTotalPrices()[Z.kb],p=d+a;this.setVehicleId();const m=this.generateIdmDataToSave(t,!0);if(this.setLocalStorage({tradeIn:p}),null!==c){(c?this.updateIdmDataWrapper:this.authenticate)(m),Object(se.c)(p)}r&&r(K.yb,p,Yr,this.getVehicleMMY(),{[K.c]:d,[K.kb]:Math.abs(a),[K.b]:s}),o&&o(i),Z.db.event_data.value=p,J.a.fireTrackAction(Z.db),l&&l()}),this.authenticate=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{await e.props.signInAnonymousAndSaveProfile(t,Z.c)}catch(e){Object(z.a)("warn","Appraisal wasn't saved properly",e)}},this.saveAppraiserDataToIdm=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.setVehicleId();const s=e.props.isAuthenticated,i=e.getTotalPrices(t);if(!y()(i)&&(a&&e.setLocalStorage({tradeIn:i[Z.kb]}),null!==s)){const a=e.generateIdmDataToSave(t,!1);(s?e.updateIdmDataWrapper:e.authenticate)(a),Object(se.c)(i[Z.kb])}},this.saveInstantOfferDataToIdm=(e=>{const t=this.props,a=t.isAuthenticated,s=t.isExtendedReport,n=t.tmvConditions,r=this.vehicleId,l=this.state.options;if(null!==a&&s){const t=et(r),s=Object(i.a)({},e,{appraisalRef:t});let o={};if(!h()(n)){const t=e.offerPrice,a=Ie(n,l),s=Ne(a);o=this.generateIdmDataToSave(s,!1,t)}const c=Object(i.a)({},o,function(e){return{appraisalOffersHistory:[e]}}(s),{appraisalOffers:s,leads:{[r]:{type:"Appraisal",submittedTs:(new Date).toISOString(),appraisalRef:t}}});(a?this.updateIdmDataWrapper:this.authenticate)(c)}}),this.emailReport=(async e=>{try{this.setState(()=>({emailReportStatus:Z.u.IN_PROGRESS}));const t=st(this.state);await Object(ne.a)({data:t,campaignName:t.redemptionCertificateUri?"offer_email":"appraisal_email",email:e||this.props.userEmail}),this.setState(()=>({emailReportStatus:Z.u.SENT}))}catch(e){this.setState(()=>({emailReportStatus:Z.u.SENT})),Object(z.a)("warn","Appraisal email wasn't sent properly",e)}}),this.customEventEmailReport=(e=>{let t=e.detail;this.emailReport(t.email)}),this.handleEmailReportClick=(()=>{const e=this.props,t=e.toggleAuthenticatedModal,a=e.userEmail;this.setState(()=>({emailReportStatus:Z.u.SUBMITTED})),t({isAppraisalEmailCTA:!0,email:a})}),this.toggleStepDone=function(t,a){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=e.state.steps,n=P()(i,{id:a}),r=n+1,l=i.length;i[n].isDone=t,i[n].skipStep=s;for(let e=r;e<l;e+=1)i[e].isDone=!1;e.setState({steps:i}),e.updateErrors(a)},this.checkStepsCompleteness=(()=>{const e=this.state.steps,t=e.length;return e.slice(0,t-1).every(e=>e.isDone)}),this.checkReportActive=(()=>{const e=this.state.steps;return e[e.length-1].isActive}),this.scrollTo=((e,t)=>{if(document){const a=document.querySelector(e);a&&a.scrollIntoView(Object(i.a)({behavior:"smooth",block:"start"},t))}}),this.scrollToNextStep=(()=>{const e=this.getActiveStep();this.scrollTo(`.${Z.jb} .${e.id}`)}),this.scrollToReportStep=(()=>{setTimeout(()=>{this.scrollTo(`.${Z.jb} .${Z.ab}`)},1e3)}),this.scrollToTradeInTitle=(()=>{this.props.isMobile&&this.scrollTo(`[name="${Z.hb}"]`)}),this.scrollToInvalid=(()=>{const e=this.state.errorMap;for(let t=0;t<le.i.length;t+=1){const a=le.i[t];if(e.has(a.input))return void this.scrollToElement(`.${Z.jb} ${a.selector}`,a.options)}}),this.scrollToElement=((e,t)=>{this.scrollTo(e,t)}),this.debouncedScroll=I()(this.scrollToNextStep,500),this.updateErrors=(e=>{this.state.errorMap.size&&this.setState({errorMap:this.getValidationErrors(e)})}),this.fireActiveStepEvents=(e=>{e===Z.N&&J.a.fireTrackAction(Z.O)}),this.fireActiveStepEndEvents=((e,t)=>{let a=t.style,s=t.colorManufactureCode,n=t.selectedOptionsCount,r=t.condition,l=t.mileage,o=t.creativeId,c=t.userSelectedPreviousStep,d=t.zipCode,p=t.vehicleYear;e===Z.p&&(he.a.fireEvent("submit_mileage",{event_data:Object(i.a)({},Lr.BUTTON_CLICK,{creative_id:o,value:l})}),he.a.fireEvent("submit_condition",{event_data:Object(i.a)({},Lr.BUTTON_CLICK,{creative_id:o,value:r})})),e===Z.F&&(he.a.fireEvent("submit_style",{event_data:Object(i.a)({},Lr.BUTTON_CLICK,{creative_id:o,value:a})}),he.a.fireEvent("submit_year",{event_data:Object(i.a)({},Lr.BUTTON_CLICK,{creative_id:o,value:p})}),d&&!c&&he.a.fireEvent("submit_zipcode",{event_data:Object(i.a)({},Lr.BUTTON_CLICK,{creative_id:o,value:d})})),e===Z.m&&(he.a.fireEvent("submit_color",{event_data:Object(i.a)({},Lr.BUTTON_CLICK,{creative_id:o,value:s?`manufactureOptionCode: "${s}"`:"none"})}),he.a.fireEvent("submit_options",{event_data:Object(i.a)({},Lr.BUTTON_CLICK,{creative_id:o,value:n})})),e===Z.N&&he.a.fireEvent("partner_condition_questions_validation",{event_data:Object(i.a)({},Lr.BUTTON_CLICK,{creative_id:o,value:"success"})})}),this.fireActiveStepEndInvalidatedEvents=((e,t)=>{let a=t.creativeId;e===Z.N&&he.a.fireEvent("partner_condition_questions_validation",{event_data:Object(i.a)({},Lr.BUTTON_CLICK,{creative_id:a,value:"failure"})})}),this.fireMinMaxRangeTracking=(e=>{let t=e.rough,a=e.clean;const s={action_category:X.b.USER_ACTION_CATEGORY,action_cause:X.b.ACTION_CAUSE_BUTTON_CLICK,creative_id:Z.W};he.a.fireEvent("partner_appraisal_range_min",{event_data:Object(i.a)({},s,{value:t})}),he.a.fireEvent("partner_appraisal_range_max",{event_data:Object(i.a)({},s,{value:a})})}),this.checkVinMismatchError=(e=>{const t=this.state.vehicle,a=S()(t,"make.slug",""),s=S()(t,"model.slug",""),i=S()(t,"year.year",""),n=S()(e,"[0]",{}),r=n.makeNiceId,l=n.modelNiceId,o=n.year;this.setState({hasVinMismatchError:3!==d()([a,r,s,l,i,`${o}`]).length})}),this.checkVinStylesMismatchError=(()=>{const e=this.props,t=e.estimatedVehicle,a=t.make,s=t.model,i=t.year,n=e.vinStyles,r=S()(n,"[0]",{}),l=r.makeNiceId,o=r.modelNiceId,c=r.year;this.setState({hasVinMismatchError:3!==d()([l,a.slug,o,s.slug,c,i]).length})}),this.processStepsUpdate=((e,t,a,s)=>{const n=this.state,r=n.hasVinMismatchError,l=n.isVinFromDrawer,c=$r(this.props).vin,d=(c||l)&&!r;let p;return e.map(e=>{const n=Object(i.a)({},e,{isDone:e.isDone||!s&&e.id===t,isActive:e.id===a});if(p=e.skipToStepObj||p,!d||y()(p)||s)return n;const r=e.id===t,m=p,u=m.shouldSkipHappen,h=m.skipToStepId,g=m.markCompleteId,b=m.hasBeenSkipped,f=u({queryVin:c,isVinFromDrawer:l,hasBeenSkipped:b})&&a===g,E=f&&e.id===h;return n.isDone=e.isDone||r||f,n.isActive=e.id===a&&!f||E,o()(n.skipToStepObj)||(n.skipToStepObj=Object(i.a)({},p,{hasBeenSkipped:r})),n})}),this.changeStep=(e=>{let t=e.currentTarget,a=e.stepId,s=e.creativeId;const i=this.props,n=i.onEstimatedValuesWidgetHide,r=i.isExtendedReport,l=i.isMobile,o=i.onPartnerFaqQuestionsShow,c=i.onLinkWidgetHide,d=this.state,p=d.condition,m=d.mileage,u=d.vin,h=d.zipCode,g=d.isPartnerOfferEligible,b=this.getVehicleStyle(),f=this.getVehicleYear(),E=this.getVehicleColorManufactureCode(),v=this.getSelectedOptionsCount(),y=this.getVehicleOptionsCount(),C=this.getActiveStep(),S=C.id;let T=a;t&&(T=t.getAttribute("data-index"));const I=!!C.skipStep,N=C.prevIds.includes(T),O=this.getValidationErrors(S),P=t?Object(ge.c)(t):s;if(I||N||!O.size){const e=T;S===Z.F&&(this.updateLocationStyleTitle(),n&&n(),c()),S!==Z.p||N||this.updateAllTmvParams(),this.fireActiveStepEvents(e),this.fireActiveStepEndEvents(S,{style:b,colorManufactureCode:E,selectedOptionsCount:v,optionsCount:y,condition:p,mileage:m,creativeId:P,vin:u,userSelectedPreviousStep:N,zipCode:h,vehicleYear:f}),this.setState(t=>{const a=t.steps;return{steps:this.processStepsUpdate(a,S,e,N),errorMap:new Map}},()=>{const e=this.getActiveStep().id;r?this.debouncedScroll():l&&e===Z.ab?this.scrollToReportStep():this.scrollToTradeInTitle(),o&&o(r&&g&&_()(Z.J,e))})}else this.updateErrorMapAndScrollToInvalid(O),this.fireActiveStepEndInvalidatedEvents(S,{creativeId:P})}),this.updateErrorMapAndScrollToInvalid=(e=>this.setState({errorMap:e},this.scrollToInvalid)),this.clearStepsData=(()=>{const e=this.props,t=e.isExtendedReport,a=e.location,s=this.state,n=s.zipCode,r=s.errorMap,l=s.vehicle.style,o=s.isZipCodeValid,c=s.isPartnerOfferEligible,d=s.showStepBaseTitle,p=s.partnerQuestionnaireResponses,m=s.areQuestionnaireResponsesValid,u=s.vin,h=s.isPartnerOfferEligibleVin,g=s.isVinFromDrawer,b=s.isEscapeHatch,f=s.isAllowedToPredefineVin,E=Br({zipCode:n,isZipCodeValid:o,selectedStyle:l,errorMap:r,location:a,isExtendedReport:t,showStepBaseTitle:d,isVinFromDrawer:g,predefinedVin:$r(this.props)});this.mileage.reset(),this.setState(t?Object(i.a)({},E,{isPartnerOfferEligible:c,isPartnerOfferEligibleVin:h,partnerQuestionnaireResponses:p,areQuestionnaireResponsesValid:m,vin:u,isEscapeHatch:b,isAllowedToPredefineVin:f}):E)}),this.updateLocationZip=(e=>this.props.setModelValue("location",$.c,{zipCode:e})),this.updateLocationAddressZip=(e=>this.props.setModelValue("location.address",$.c,{zipCode:e})),this.updateAllTmvParams=(async()=>{const e=this.state,t=e.vehicle.style.id,a=e.mileage,s=e.color.id,i=e.condition,n=e.options,r=e.zipCode,l=n.map(e=>e.id).join(",");this.props.setModelValue("allTmvParams",ee.c,{styleId:t,condition:i,mileage:a,zipCode:r,optionIds:l,colorId:s})}),this.updateLocationStyleTitle=(()=>{this.setState({showStepBaseTitle:!0})}),this.changeZipCode=(e=>{let t=e.target.value;this.setState(()=>({zipCode:t})),Object(le.t)(t)?this.updateLocationZip(t).then(()=>this.setValidatedZipStatus(!0)).catch(()=>this.setValidatedZipStatus(!1)):this.setValidatedZipStatus(!1)}),this.isLocationAndStyleStepValid=(()=>this.state.isZipCodeValid&&!y()(this.state.vehicle.make)&&!y()(this.state.vehicle.style)),this.isConditionAndMileageStepValid=(()=>!(!(this.state.mileage&&this.state.isMileageValid&&this.state.condition)||_()(Z.H,this.state.condition))),this.changeMileage=(e=>{let t=e.target.value;this.setState(e=>{let a=e.errorMap,s=e.vehicle;const i={styleYear:S()(s,"style.year")},n=Object(le.o)(Z.p,le.g,t,i);return n||a.set(le.g,Object(le.n)(Z.p,le.g,t,i)),{mileage:t,isMileageValid:n,errorMap:a}},()=>{const e=this.isConditionAndMileageStepValid();this.toggleStepDone(e,Z.p)})}),this.selectCondition=(e=>{let t=e.target.value;this.setState({condition:t},()=>{const e=this.isConditionAndMileageStepValid();this.toggleStepDone(e,Z.p)})}),this.selectOptions=((e,t)=>this.setState({options:e,optionsCount:t},()=>{this.toggleStepDone(!0,Z.m)})),this.selectColors=(e=>this.setState({color:e},()=>{this.toggleStepDone(!0,Z.m)})),this.changeVin=((e,t)=>this.setState(a=>{let s=a.errorMap;return!y()(s)&&s.has(le.d)&&s.delete(le.d),{vin:e,isVinValid:Object(le.s)(e),errorMap:s,isEscapeHatch:!!t}},()=>{t||this.toggleLicensePlateAndVinStepDone()})),this.updateQuestionnaireResponses=(e=>{this.setState({partnerQuestionnaireResponses:e,areQuestionnaireResponsesValid:Object(le.r)(e)},()=>{const e=this.isPartnerOfferConditionsStepValid();this.toggleStepDone(e,Z.N)})}),this.isLicensePlateAndVinStepValid=(()=>{const e=this.state,t=e.vin,a=e.isVinValid,s=e.hasVinMismatchError;return!(!t||!a||s)}),this.isPartnerOfferConditionsStepValid=(()=>this.state.areQuestionnaireResponsesValid),this.toggleLicensePlateAndVinStepDone=(()=>{const e=this.getActiveStep().id;if(![Z.N,Z.A].includes(e))return!1;const t=this.isLicensePlateAndVinStepValid();return this.toggleStepDone(t,Z.A)}),this.updateIdmDataWrapper=(async e=>{try{await this.props.updateIdmData(e)}catch(e){Object(z.a)("warn","Profile data wasn't saved properly",e)}}),this.handlePayoffChange=((e,t)=>{this.setState(()=>({payoffAmount:e,appliedTradeIn:t}))}),this.checkDelightedSurvey=(()=>{this.setState({hideVACDelightedSurvey:!!this.sessionStorage.get(Hr.VAC),hideEPODelightedSurvey:!!this.sessionStorage.get(Hr.EPO)})}),this.handleDelightedSurveyClick=(e=>{const t=e?Hr.EPO:Hr.VAC,a=e?"hideEPODelightedSurvey":"hideVACDelightedSurvey";this.sessionStorage.set(t,!0),this.setState({[a]:!0})}),this.handleVACDelightedSurveyClick=(()=>{this.handleDelightedSurveyClick()}),this.handleEPODelightedSurveyClick=(()=>{this.handleDelightedSurveyClick(!0)}),this.renderTradeInAppraiserItem=((e,t)=>{const a=this.props,i=a.onDone,n=a.isMobile,r=a.isExtendedReport,l=this.state,o=l.isPartnerOfferEligibleVin,c=l.isVinValid,d=l.appliedTradeIn,p=l.isEscapeHatch,m=l.isVinFromDrawer,u=l.styleIds,h=l.vin,g=l.isLoadingColorsAndOptions,b=this.getTotalPrices(),f=$r(this.props),E=f.vin,v=f.isQueryPredefinedVin;return V.a.createElement(ft,Object(s.a)({id:e.id,stepCounter:t+1,onDone:i,onContinue:this.changeStep,onSave:this.saveEstimatedPayments,hasTotalPayment:!!b[Z.kb],key:e.id,isExtendedReport:r,isPartnerOfferEligibleVin:o,isVinValid:c,appliedTradeIn:d,predefinedVin:E,isQueryPredefinedVin:v,isVinFromDrawer:m,styleIds:u,isEscapeHatch:p&&!h,isMobile:n,isLoadingColorsAndOptions:g},e),V.a.createElement(Dr,{stepId:e.id,isMobile:n,isExtendedReport:r,locationAndStyleProps:this.getLocationAndStyleData(e),optionsAndColorsProps:this.getOptionsAndColorsData(e),conditionAndMileageProps:this.getConditionAndMileageData(e),appraisalReportProps:this.getAppraisalReportData(e),licensePlateAndVinProps:this.getLicensePlateAndVinData(e),offerConditionsProps:this.getOfferConditionsData(e),instantOfferProps:this.getInstantOfferData(e),escapeHatchProps:this.getEscapeHatchData(e)}))})}componentDidMount(){const e=this.props,t=e.location,a=e.vinStyles,s=e.estimatedVehicle,i=this.state.zipCode;this.storage=new W.a("localStorage"),this.sessionStorage=new W.a("sessionStorage"),this.checkDelightedSurvey();const n=Object(be.a)(t),r=n.zip,l=n.styleIds,o=n.colorId,c=n.condition,d=n.mileage;r&&l&&o&&c&&d&&this.fireRetargetTracking(),this.setValidatedZipStatus(Object(le.t)(i),this.setVehicleDataForExtendedReport),a.length&&s&&this.checkVinStylesMismatchError(),J.a.on(_e.d,this.customEventEmailReport),this.activateSessionRecorder()}componentDidUpdate(e,t){const a=this.props,s=a.userEmail,i=a.tmvConditions,n=a.zipCode,r=a.vehicleOverride,l=a.setMMY,o=a.setAppraiseFinished,c=a.creativeIdOverride,d=a.profileOfferVin,p=a.isEval3460Enabled,u=a.vinStyles,h=a.estimatedVehicle,g=this.state,b=g.emailReportStatus,f=g.zipCode,E=g.vehicle,v=g.isAllowedToPredefineVin;if(!e.userEmail&&s&&b===Z.u.SUBMITTED&&this.emailReport(),m()(i,e.tmvConditions)||this.fireSavingAppraisalDataToIdm(),e.zipCode!==n&&f!==n&&this.onPropsZipCodeChange(n),pe(t.vehicle,E)||l(E),y()(r)||pe(e.vehicleOverride,r)||this.onVehicleOverride(r,c),o){const e=this.getActiveStep();if(!S()(e,"isFinal")){const a=(t.steps||[]).find(e=>e.isActive)||{};e.id!==a.id&&o(!1)}}const C=!$r(this.props).isQueryPredefinedVin&&p&&d;v&&C&&!m()(e.profileOfferVin,d)&&(this.changeVin(d),J.a.fireTrackAction({event_type:X.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{action_name:X.b.ACTION_APPRAISE_VEHICLE,subaction_name:X.b.VIN_AUTOFILL,creative_id:Z.c,action_category:X.b.USER_ACTION_CATEGORY}})),v&&C&&u&&u.length&&h&&!m()(e.vinStyles,u)&&this.checkVinStylesMismatchError()}render(){const e=this.props,t=e.isMobile,a=e.className,s=e.columnsSize,i=e.headerText,n=e.subHeaderText,r=e.isExtendedReport,l=this.state,o=l.steps,c=l.isPartnerOfferEligible,d=l.isPartnerOfferEligibleVin,p=l.partnerOfferEligibilityResponse,m=this.getActiveStep().id,u=p.isEligible,h=p.reason,g=!u&&h||h===Z.vb;return V.a.createElement("div",{className:a},V.a.createElement(rt,{subHeaderText:n,headerText:i,isExtendedReport:r}),V.a.createElement(L.a,null,V.a.createElement(U.a,s,V.a.createElement("div",{className:"trade-in-appraiser pos-r","data-partner-offer-eligible":c},o.map((e,t)=>V.a.createElement(A.Fragment,{key:`tia-item-${e.id}`},this.renderTradeInAppraiserItem(e,t))),r&&!Fr.includes(m)&&V.a.createElement(A.Fragment,null,m!==Z.x?V.a.createElement(Ue,{isMobile:t,className:"my-2"}):V.a.createElement(A.Fragment,null,!g&&d&&V.a.createElement(Ue,{isMobile:t,className:"mb-2"})))))),V.a.createElement(Oe.a,{name:"EVAL-3460",showDefault:!0},V.a.createElement(Oe.c,{name:"ctrl",isDefault:!0}),V.a.createElement(Oe.c,{name:"chal0"}),V.a.createElement(Oe.c,{name:"chal1"})))}}Zr.propTypes={setModelValue:k.a.func.isRequired,updateIdmData:k.a.func.isRequired,signInAnonymousAndSaveProfile:k.a.func.isRequired,toggleAuthenticatedModal:k.a.func.isRequired,setMMY:k.a.func,className:k.a.string,zipCode:k.a.string,isAuthenticated:k.a.bool,isMobile:k.a.bool,selectStyle:k.a.bool,onDone:k.a.func,onTradeInUpdate:k.a.func,onVehicleUpdate:k.a.func,columnsSize:k.a.shape({xs:k.a.number,md:k.a.number,lg:k.a.number,xl:k.a.number}),isExtendedReport:k.a.bool,tmvConditions:k.a.shape({}),estimatedVehicle:ee.b.StyleWithoutSubmodels,mechanicalStyle:ee.b.MechanicalStyleEntity,headerText:k.a.string,subHeaderText:k.a.string,onEstimatedValuesWidgetHide:k.a.func,onPartnerFaqQuestionsShow:k.a.func,setAppraiseFinished:k.a.func,userEmail:k.a.string,sellYourCarConfig:re.e,anonymousSignInCreativeId:k.a.string,location:k.a.shape({search:k.a.string}).isRequired,isSessionRecorderActive:k.a.bool,visitorId:k.a.string,isUnknownVisitorZip:k.a.bool,isUsed:k.a.bool,vehicleOverride:k.a.shape({make:k.a.shape({}),model:k.a.shape({}),year:k.a.shape({}),style:k.a.shape({})}),onLinkWidgetHide:k.a.func,vinStyles:k.a.arrayOf(k.a.shape({id:k.a.number,year:k.a.number,makeName:k.a.string,makeNiceId:k.a.string,modelName:k.a.string,modelNiceId:k.a.string})),drawerCreativeId:k.a.string,profileOfferVin:k.a.string},Zr.defaultProps={zipCode:"",className:"",onDone:null,onTradeInUpdate:null,onVehicleUpdate:null,isAuthenticated:!1,isMobile:!1,selectStyle:!1,columnsSize:{xs:12,md:11,lg:9,xl:8},isExtendedReport:!1,tmvConditions:null,mechanicalStyle:{},estimatedVehicle:null,headerText:"How much is your car worth?",subHeaderText:"Complete the form to generate an appraisal report",onEstimatedValuesWidgetHide:null,onPartnerFaqQuestionsShow:null,setAppraiseFinished:null,userEmail:"",sellYourCarConfig:{},anonymousSignInCreativeId:Z.c,isSessionRecorderActive:!1,visitorId:"",isUnknownVisitorZip:!1,isUsed:!1,vehicleOverride:null,setMMY:b.a,onLinkWidgetHide:b.a,vinStyles:[],drawerCreativeId:null,profileOfferVin:""};const Gr={zipCode:Object(B.a)("location.zipCode",$.c),visitorId:Object(B.a)("id",$.c),tmvConditions:Object(B.a)(e=>{let t=e.allTmvParams;return t?Object(ee.C)(t.styleId):""},ee.c),mechanicalStyle:Object(B.a)(e=>{let t=e.allTmvParams;return e.isExtendedReport&&t?Object(ee.o)(t.styleId):""},ee.c),vinStyles:Object(B.a)(e=>{let t=e.location,a=e.isEval3460Enabled,s=e.profileOfferVin;const i=$r({location:t,isEval3460Enabled:a,profileOfferVin:s}).vin;return Object(te.d)({vin:i})},te.b)},Wr=e=>({toggleAuthenticatedModal:t=>e(Object(ie.d)(ae.a.SIGN_UP_MODAL,t))}),Qr=e=>{const t=S()(e,"pageContext.location");return{profileOfferVin:S()(e,"profile.data.idm.appraisalOffersHistory[0].vin"),allTmvParams:S()(e,"vehicle.allTmvParams"),isMobile:e.mobile,userEmail:S()(e,"profile.data.idm.identifiers.email[0]",""),location:t,isUnknownVisitorZip:Object(Ee.b)(S()(e,"visitor.location")),isSessionRecorderActive:fe.a.isActive(t,"appraiser"),isEval3460Enabled:"chal1"===H.a.getForcedOrAssignedRecipeName({state:e,campaignName:"EVAL-3460",defaultVal:"ctrl"})}},Kr=Object(Y.a)(Zr),Xr=Object(q.c)(Qr,Wr)(Object(B.b)(Kr,Gr))},"./site-modules/shared/components/appraisal/transaction-type-select/transaction-type-select.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return p});var s=a("../node_modules/react/index.js"),i=a.n(s),n=a("../node_modules/prop-types/index.js"),r=a.n(n),l=a("../node_modules/classnames/index.js"),o=a.n(l),c=a("./site-modules/shared/components/styled-select/styled-select.jsx"),d=a("./site-modules/shared/constants/appraisal/appraisal.js");a("./site-modules/shared/components/appraisal/transaction-type-select/transaction-type-select.scss");function p(e){let t=e.onChange,a=e.className,s=e.selected,n=e.labelText,r=e.labelClassName,l=e.isLabelHidden;return i.a.createElement("div",{className:o()("transaction-type-select form-group",a)},i.a.createElement(c.a,{name:"transactionType",labelText:n,onChange:t,options:d.mb,value:s,className:"select form-control text-gray-darker pr-2",labelClassName:r,isLabelHidden:l}))}p.propTypes={onChange:r.a.func.isRequired,className:r.a.string,selected:r.a.string,labelText:r.a.string,labelClassName:r.a.string,isLabelHidden:r.a.bool},p.defaultProps={className:"",selected:"",labelText:"Transaction type",labelClassName:"mb-0 small text-gray-darker",isLabelHidden:!1}},"./site-modules/shared/components/appraisal/zip-field/zip-field.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return h});var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/react/index.js"),n=a.n(i),r=a("../node_modules/prop-types/index.js"),l=a.n(r),o=a("./site-modules/shared/components/form-field/form-field.jsx"),c=a("./site-modules/shared/components/field-error/field-error.jsx"),d=a("./site-modules/shared/utils/appraiser/appraiser-validation-helper.js"),p=a("./utils/seed-randomizers.js"),m=a("../node_modules/classnames/index.js"),u=a.n(m);a("./site-modules/shared/components/appraisal/zip-field/zip-field.scss");class h extends i.Component{constructor(){super(...arguments),this.state={isEmptyZipCode:!this.props.zipCode,touched:!1},this.onZipCodeBlur=(()=>{this.setState(()=>({touched:!0}))})}render(){const e=this.props,t=e.zipCode,a=e.isZipCodeValid,i=e.onZipCodeChange,r=e.errorMap,l=e.zipClassName,m=e.labelClassName,h=e.disabled,g=e.isMobile,b=e.inputClassName,f=e.zipWrapperClassName,E=this.state,v=E.isEmptyZipCode,y=E.touched,C=r.get(d.m),S=`${d.m}-error-${Object(p.c)()}`,T=`zip-${Object(p.c)()}`;return g?n.a.createElement("div",{className:u()(f)},n.a.createElement(o.a,Object(s.a)({type:"number",inputMode:"numeric",pattern:"[0-9]*",id:T,name:"zip",label:" ","aria-label":"zip code",className:`appraiser-zip-field ${l}`,inputClassName:u()("value-zip-input",b),labelClassName:m,value:t,placeholder:"Enter Zip Code",isValid:!C&&(a||!a&&v&&!y),onChange:i,onBlur:this.onZipCodeBlur,disabled:h},C?{ariaDescribedBy:S,ariaInvalid:!0}:{})),n.a.createElement(c.a,{id:S,error:C,classes:"mt-0_5"})):n.a.createElement("div",{className:u()(f)},n.a.createElement(o.a,Object(s.a)({type:"number",inputMode:"numeric",pattern:"[0-9]*",id:T,name:"zip",label:"Zip",className:`appraiser-zip-field ${l}`,inputClassName:"value-zip-input",labelClassName:m,value:t,placeholder:"Enter Zip Code",isValid:!C&&(a||!a&&v&&!y),onChange:i,onBlur:this.onZipCodeBlur,disabled:h},C?{ariaDescribedBy:S,ariaInvalid:!0}:{})),n.a.createElement(c.a,{id:S,error:C,classes:"mt-0_5 zip-error-message-desktop"}))}}h.propTypes={isZipCodeValid:l.a.bool.isRequired,onZipCodeChange:l.a.func.isRequired,zipCode:l.a.string,errorMap:l.a.objectOf(l.a.string),zipClassName:l.a.string,labelClassName:l.a.string,disabled:l.a.bool,isMobile:l.a.bool,inputClassName:l.a.string,zipWrapperClassName:l.a.string},h.defaultProps={zipCode:"",errorMap:new Map,zipClassName:"",labelClassName:"small mb-0_25",disabled:!1,isMobile:!1,inputClassName:"",zipWrapperClassName:""}},"./site-modules/shared/components/arrow-link/arrow-link.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return m});var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),n=a("../node_modules/react/index.js"),r=a.n(n),l=a("../node_modules/prop-types/index.js"),o=a.n(l),c=a("../node_modules/classnames/index.js"),d=a.n(c),p=a("./site-modules/shared/components/link/link.jsx");a("./site-modules/shared/components/arrow-link/arrow-link.scss");function m(e){let t=e.to,a=e.children,l=e.className,o=e.isArrowLeft,c=Object(i.a)(e,["to","children","className","isArrowLeft"]);return r.a.createElement("span",{className:d()("arrow-link text-primary-darker d-block text-nowrap size-16",l)},o&&r.a.createElement(n.Fragment,null,r.a.createElement("i",{className:"icon-arrow-left4 size-10"}),"\xa0"),r.a.createElement(p.a,Object(s.a)({className:"text-wrap",to:t},c),a),!o&&r.a.createElement(n.Fragment,null,"\xa0",r.a.createElement("i",{className:"icon-arrow-right4 size-10"})))}m.propTypes={to:o.a.string,children:o.a.node,className:o.a.string,isArrowLeft:o.a.bool},m.defaultProps={to:"",children:"",className:"",isArrowLeft:!1}},"./site-modules/shared/components/calculator/credit-score/credit-score.jsx":function(e,t,a){"use strict";var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/react/index.js"),n=a.n(i),r=a("../node_modules/classnames/index.js"),l=a.n(r),o=a("../node_modules/prop-types/index.js"),c=a.n(o),d=a("../node_modules/lodash/isEqual.js"),p=a.n(d),m=a("../node_modules/reactstrap/lib/ButtonGroup.js"),u=a.n(m),h=a("../node_modules/reactstrap/lib/Button.js"),g=a.n(h);a("./site-modules/shared/components/calculator/checkbox-group/checkbox-group.scss");function b(e){let t=e.onClick,a=e.onKeyPress,s=e.selected,i=e.values,r=e.id,o=e.disabled,c=e.trackingId,d=e.classes;return n.a.createElement(u.a,{className:l()("d-flex justify-content-between checkbox-group",d),"data-toggle":"buttons","aria-label":r},i.map(e=>{let i=e.rate,d=e.name,m=e.disabled;const u=(e=>p()(s,e))(d),h=!u&&o||m;return n.a.createElement(g.a,{disabled:h,key:d,name:r,value:d,outline:!u,size:"md",tabIndex:0,onClick:t,onKeyPress:a,color:u?"primary":"secondary",className:l()("checkbox-group-tab px-0_25 d-flex flex-column align-items-center w-100",{active:u,"bg-white":!u}),"data-tracking-id":h?"":c,"data-tracking-value":h?"":`${d} ${i}`},n.a.createElement("span",{className:l()("medium",{"text-gray-darker":!u})},d),n.a.createElement("span",{className:l()("small font-weight-normal",{"text-gray-darker":!u})},i))}))}b.propTypes={onClick:c.a.func,onKeyPress:c.a.func,values:c.a.arrayOf(c.a.shape({name:c.a.string,rate:c.a.string})).isRequired,selected:c.a.string,id:c.a.string.isRequired,disabled:c.a.bool,trackingId:c.a.string,classes:c.a.string},b.defaultProps={onClick:null,onKeyPress:null,selected:"",disabled:!1,trackingId:null,classes:""};var f=a("../node_modules/reactstrap/lib/Label.js"),E=a.n(f),v=a("./site-modules/shared/components/tooltip-item/tooltip-item.jsx");a("./site-modules/shared/components/calculator/credit-score/credit-score.scss");function y(e){const t=e.titleClasses,a=e.title,i=e.id,r=e.tooltip,o=e.tooltipClass,c=e.tooltipIconClass;return n.a.createElement("div",{className:"credit-score"},n.a.createElement(E.a,{className:"mb-1"},n.a.createElement("span",{className:t},a),n.a.createElement(v.a,{id:i,item:r,className:l()("tooltip-text",o),iconClassName:c})),n.a.createElement(b,Object(s.a)({},e,{trackingId:"input_credit_score"})))}a.d(t,"a",function(){return y}),y.propTypes={onClick:c.a.func,onKeyPress:c.a.func,values:c.a.arrayOf(c.a.shape({name:c.a.string,rate:c.a.string})).isRequired,selected:c.a.string.isRequired,id:c.a.string.isRequired,title:c.a.string.isRequired,tooltip:c.a.shape({text:c.a.string.isRequired,placement:c.a.string.isRequired}).isRequired,disabled:c.a.bool,titleClasses:c.a.string,tooltipClass:c.a.string,tooltipIconClass:c.a.string},y.defaultProps={onClick:null,onKeyPress:null,disabled:!1,titleClasses:"mr-0_5",tooltipClass:"",tooltipIconClass:""}},"./site-modules/shared/components/calculator/payment-calculator/payment-calculator.jsx":function(e,t,a){"use strict";var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/@babel/runtime/helpers/esm/objectSpread.js"),n=a("../node_modules/lodash/noop.js"),r=a.n(n),l=a("../node_modules/lodash/isNumber.js"),o=a.n(l),c=a("../node_modules/lodash/isNull.js"),d=a.n(c),p=a("../node_modules/lodash/get.js"),m=a.n(p),u=a("../node_modules/lodash/omit.js"),h=a.n(u),g=a("../node_modules/lodash/debounce.js"),b=a.n(g),f=a("../node_modules/react/index.js"),E=a.n(f),v=a("../node_modules/prop-types/index.js"),y=a.n(v),C=a("../node_modules/reactstrap/lib/Row.js"),S=a.n(C),T=a("../node_modules/reactstrap/lib/Col.js"),I=a.n(T),N=a("../node_modules/classnames/index.js"),_=a.n(N),O=a("../node_modules/react-scroll/lib/modules/index.js"),P=a("./data/models/incentives.js"),A=a("./data/models/inventory.js"),V=a("./tracking/constant.js"),x=a("./engagement-handlers/inventory-engagement-handler/inventory-engagement-handler.js"),k=a("../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),w=a("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),R=a("../node_modules/lodash/isNil.js"),M=a.n(R),j=a("../node_modules/lodash/isFinite.js"),D=a.n(j),L=a("../node_modules/lodash/every.js"),F=a.n(L),U=a("../node_modules/lodash/pickBy.js"),q=a.n(U),z=a("../node_modules/lodash/pick.js"),B=a.n(z),$=a("../node_modules/lodash/isEqual.js"),Y=a.n($),H=a("./data/api/api-client.js"),Z=a("./utils/event-toolbox.js"),G=a("./utils/isomorphic-logger.js"),W=a("./site-modules/shared/utils/storage.js"),Q=a("./utils/metrics-header.js"),K=a("./site-modules/shared/utils/calculator/calculator-helper.js"),X=a("./site-modules/shared/utils/calculator/form-helper.js"),J=a("./site-modules/shared/utils/inventory-utils/is-new.js"),ee=a("./site-modules/shared/utils/inventory-utils/get-vehicle-age.js"),te=a("./site-modules/shared/utils/car-buying/calculator-util.js"),ae=a("./site-modules/shared/components/profile/insider-methods.jsx"),se=a("./data/luckdragon/redux/react-binding.jsx"),ie=a("./data/models/version.js"),ne=a("./data/models/page.js"),re=a("./data/models/car-buying.js"),le=a("./site-modules/shared/constants/inventory/price-analysis.js"),oe=a("./site-modules/shared/constants/calculator/calculator.js"),ce=a("./site-modules/shared/constants/car-buying/index.js"),de=a("./site-modules/shared/constants/calculator/events.js"),pe=a("./site-modules/shared/constants/car-buying/models.js"),me=a("./site-modules/shared/utils/car-buying/digital-retail-payment-service.js");const ue=["apr","numberOfMonths","downPayment","tradeIn","creditScore"];let he="",ge="";class be extends f.Component{constructor(e){super(e),this.getSharedSelections=(()=>{const e=this.props.selections,t=o()(e.tradeIn)?e.tradeIn:this.tradeInFromStorage,a=o()(t)?t:oe.I,s=o()(e.downPayment)?e.downPayment:this.downPaymentFromStorage;return{tradeIn:a,downPayment:o()(s)?s:oe.C,customVehiclePrice:o()(e.customVehiclePrice)?e.customVehiclePrice:""}}),this.getAPR=(()=>{const e=this.state.loanPayments,t=e.apr,a=e.creditScore,s=this.props.baseAPR;return o()(s)?s:a?m()(this.aprValues,`${this.state.loanPayments.numberOfMonths}[0].apr`,0):t||0}),this.getAPRs=(async()=>{const e=this.props,t=e.offer,a=t.taxesAndFeesZipCode,s=t.styleId,i=t.year,n=t.mileage,r=t.type,l=e.pageName,o=e.venomVersion,c=this.state.loanPayments.creditScore,d=Object(J.a)(r),p=await H.c.fetchJson(`/${d?"newaprs":"usedaprs"}/v1/?styleId=${s||oe.G}&zipCode=${a}&vehicleAge=${Object(ee.a)(i)}&creditScore=${c}&vehicleMileage=${n}`,{headers:Object(Q.a)(`${d?"loanAPRsNew":"loanAPRsUsed"}`,l,o)});return p&&p.terms}),this.getUrl=(e=>{let t=e.customVehiclePrice,a=e.price,s=e.primaryIncentiveAmountValue,i=e.params,n=e.additionalParams,r=void 0===n?"":n;const l="/calculators/v2/loanpayment/?";return t?s?[`${l}salesPrice=${t}&primaryIncentiveAmount=0${i}${r}`,`${l}salesPrice=${a}&primaryIncentiveAmount=${s}${i}${r}`]:`/car-buying/v1/aggregation/calculate/loanpayment?salesPrices=${t},${a}&primaryIncentiveAmount=${s}${i}${r}`:`${l}salesPrice=${a}&primaryIncentiveAmount=${s}${i}${r}`}),this.getLoanPaymentsApiUrl=(()=>{const e=this.state.loanPayments.numberOfMonths,t=this.props.offer,a=t.taxesAndFeesZipCode,s=t.styleId,i=t.marketValue,n=t.docFee,r=t.price,l=t.type,o=this.props,c=o.isTaxesAndFeesEnabled,d=o.selectedLoanIncentives,p=o.msrp,m=this.getSharedSelections(),u=m.tradeIn,h=m.downPayment,g=m.customVehiclePrice,b=d?d.filter(e=>{return e.primary}):[],f=d?d.filter(e=>{return!e.primary}):[],E=Object(te.h)(b),v=Object(te.h)(f),y=Object(J.a)(l)?"New":"Used",C=`&msrp=${p}&numberOfMonths=${e}&downPayment=${h}&tradeIn=${u}&financeRate=${this.getAPR()}&conditionalIncentiveAmount=${v}&titleFees=0&applyLimits=true&calculatorType=${y}`;if(c){if(!a)return"";const e=`&zipCode=${a}${s?`&styleId=${s}`:"&withTaxesAndFees=false"}&marketValue=${i}&docFee=${Object(te.k)(n)}${C}`;return this.getUrl({customVehiclePrice:g,price:r,primaryIncentiveAmountValue:E,params:e})}return this.getUrl({customVehiclePrice:g,price:r,primaryIncentiveAmountValue:E,params:C,additionalParams:"&withTaxesAndFees=false"})}),this.getPayments=(async e=>{const t=this.props,a=t.venomVersion,s=t.pageName,i=await Promise.all(e.map(e=>H.c.fetchJson(e,{headers:Object(Q.a)("loanPayments",s,a)}).catch(e=>(this.updateSelection({loanMonthlyPayment:null,downPayment:null,tradeIn:null,numberOfMonths:null,financeRate:null,widgetLoanMonthlyPayment:null,calculatedOffer:null}),Object(G.a)("error",`Get loan payments error - ${e}`),null)))),n=Object(w.a)(i,2);return{customPayment:n[0],payment:n[1]}}),this.getLoanPayments=(async()=>{const e=this.getLoanPaymentsApiUrl();if(!e)return null;const t=this.props,a=t.pageName,s=t.venomVersion,n=t.onMonthlyPaymentUpdate,r=t.offer,l=t.usePaymentWithTaxesAndFeesForTabs;if(this.updateSelection({}),Array.isArray(e)){const t=await this.getPayments(e),a=t.customPayment,s=t.payment,o=a.calculationCriteria,c=a.loanAmount,d=a.loanMonthlyPayment,p=a.limitCriteria,u=a.loanMonthlyPaymentWithTaxes,h=a.totalTaxesAndFees,g=a.taxes,b=a.fees,f=this.state.limitCriteria,E=o.financeRate,v=o.numberOfMonths,y=o.downPayment,C=o.tradeIn;this.limitMessages=Object(X.c)(p,r.type),Object(K.k)({cur:{limitCriteria:p},prev:{limitCriteria:f}},[oe.ab,oe.Z],oe.h),this.updateSelection({loanMonthlyPayment:d,downPayment:y,tradeIn:C,numberOfMonths:v,financeRate:E,widgetLoanMonthlyPayment:m()(s,"loanMonthlyPayment"),calculatedOffer:s});const S=u||d;return n(l?S:d,"loan"),this.setState(e=>{let t=e.loanPayments;return{loanPayments:Object(i.a)({},t,{loan:c,monthly:d,monthlyWithTaxes:S,totalTaxesAndFees:h,taxes:g,fees:Object(i.a)({},b,{docFee:this.props.offer.docFee})}),limitCriteria:p,drawerOffer:Object(i.a)({},s)}},()=>this.fireCalculatorPaymentsChangeEvent(o,p))}return H.c.fetchJson(e,{headers:Object(Q.a)("loanPayments",a,s)}).then(e=>{const t=Object(K.f)(e),a=t.calculationCriteria,s=t.loanAmount,o=t.loanMonthlyPayment,c=t.limitCriteria,d=t.loanMonthlyPaymentWithTaxes,p=t.totalTaxesAndFees,u=t.taxes,h=t.fees,g=this.state.limitCriteria,b=a.financeRate,f=a.numberOfMonths,E=a.downPayment,v=a.tradeIn;this.limitMessages=Object(X.c)(c,r.type),Object(K.k)({cur:{limitCriteria:c},prev:{limitCriteria:g}},[oe.ab,oe.Z],oe.h),this.updateSelection({loanMonthlyPayment:o,downPayment:E,tradeIn:v,numberOfMonths:f,financeRate:b,widgetLoanMonthlyPayment:m()(Object(K.f)(e,!0),"loanMonthlyPayment"),calculatedOffer:Object(K.f)(e,!0)});const y=d||o;return n(l?y:o,"loan"),this.setState(t=>{let a=t.loanPayments;return{loanPayments:Object(i.a)({},a,{loan:s,monthly:o,monthlyWithTaxes:y,totalTaxesAndFees:p,taxes:u,fees:Object(i.a)({},h,{docFee:this.props.offer.docFee})}),limitCriteria:c,drawerOffer:Object(i.a)({},Object(K.f)(e,!0))}},()=>this.fireCalculatorPaymentsChangeEvent(a,c))}).catch(e=>{this.updateSelection({loanMonthlyPayment:null,downPayment:null,tradeIn:null,numberOfMonths:null,financeRate:null,widgetLoanMonthlyPayment:null,calculatedOffer:null}),Object(G.a)("error",`Get loan payments error - ${e}`)})}),this.limitMessages={},this.updateIdmDataWrapper=(async e=>{try{await this.props.updateIdmData(e)}catch(e){Object(G.a)("warn","Profile data wasn't saved properly",e)}}),this.authenticate=(async e=>{try{await this.props.signInAnonymousAndSaveProfile(e,"edm-entry-payment-calculator")}catch(e){Object(G.a)("warn","Appraisal wasn't saved properly",e)}}),this.saveTradeInDataToIdm=(()=>{const e=this.props.isAuthenticated,t=Object(i.a)({},e?{}:{isAnonymous:!0});null!==e&&(e?this.updateIdmDataWrapper:this.authenticate)(t)}),this.updateSelection=(e=>{let t=e.loanMonthlyPayment,a=e.downPayment,s=e.tradeIn,n=e.numberOfMonths,r=e.financeRate,l=e.widgetLoanMonthlyPayment,o=e.calculatedOffer;const c=this.props,d=c.onSelectionUpdate,p=c.selections,u=this.state.loanPayments.creditScore,h={monthlyPayment:t,downPayment:Number(a),tradeIn:Number(s),numberOfMonths:Number(n),financeRate:Number(r),customVehiclePrice:m()(p,"customVehiclePrice",""),widgetMonthlyPayment:Number(l),calculatedOffer:o,apr:this.getAPR(),creditScore:u,storedSelections:this.storage.get(ce.y.LOAN_PREFERENCES)||{}};d({loan:Object(i.a)({},h,{isCustomized:function(e,t,a){const s=e.numberOfMonths;return F()(e,e=>D()(e))&&!(a===oe.C&&s===oe.H&&t===oe.I)}(h,s,a)})}),d.flush()}),this.fireCalculatorPaymentsChangeEvent=((e,t)=>{const a=this.props,s=a.offer.vin,n=a.creativeId;Z.a.fireCustomEvent(de.a.CALCULATE_PAYMENT,{vin:s,type:oe.h,creativeId:n,payments:Object(i.a)({},this.state.loanPayments,e),limitCriteria:t})}),this.resetAppliedIncentives=(()=>{const e=this.props,t=e.vin,a=e.setModelValue,s=e.selectedLoanIncentives,i=e.selectedLeaseIncentives,n=e.updateGetThisDealBtn;if(s){const e=s.filter(e=>{return e.primary})||[];a(re.b.SELECTED_LOAN_INCENTIVES({vin:t}),re.a,{vin:t,incentives:e})}if(i){const e=i.filter(e=>{return!e.conditionCategory})||[];a(re.b.SELECTED_LEASE_INCENTIVES({vin:t}),re.a,{vin:t,incentives:e})}a(re.b.RESET_CUSTOM_VEHICLE_PRICE({vin:t}),re.a,!1),n(!0)}),this.changeState=(e=>{let t=e.value,a=e.name,s=e.additionalValue;const n=this.props,r=n.onSharedInputUpdate,l=n.unselectFinancingPromotions,o=n.baseTermMonths,c=n.updateGetThisDealBtn;if(!(this.state.loanPayments[a]!==t))return null;const d=Object(i.a)({[a]:t},s),p=Object(K.j)(a);return o&&!p&&l&&l(le.d.CHECKBOX),a===oe.t&&(t?this.resetAppliedIncentives(t):c(!1)),p?(r(a,t,oe.g),a===oe.yb&&this.saveTradeInDataToIdm(),null):this.setState(e=>({loanPayments:Object(i.a)({},e.loanPayments,d)}),()=>{(0,this.props.clearMMYFromStorage)(),this.storage.set(ce.y.LOAN_PREFERENCES,q()(Object(i.a)({},this.storage.get(ce.y.LOAN_PREFERENCES),d,{isUsed:!1}),e=>!M()(e)))})});const t=e.baseAPR,a=e.baseTermMonths,s=e.offer,n=e.useDefaults;this.storage=new W.a("localStorage"),he=`${t}_${a}`;const r=!n&&this.storage.get(ce.y.LOAN_PREFERENCES)||{},l=r.numberOfMonths,c=r.apr,d=r.creditScore,p=r.tradeIn,u=r.downPayment;this.tradeInFromStorage=p,this.downPaymentFromStorage=u;const h=!d&&c?c:null,g=s.type,b=Object(J.a)(g)?oe.q[oe.l].value:oe.q[oe.n].value;this.state={loanPayments:{apr:t||h,numberOfMonths:a||l||oe.H,loan:null,monthly:null,creditScore:Object(me.a)(d)||(c?null:b)},limitCriteria:{},drawerOffer:{}},this.isAprReqInProgress=!1}static getDerivedStateFromProps(e,t){let a=e.baseAPR,s=e.baseTermMonths,n=t.loanPayments;return(ge=`${a}_${s}`)!==he?{loanPayments:Object(i.a)({},n,{numberOfMonths:s||n.numberOfMonths})}:null}async componentDidMount(){const e=this.props.offer.taxesAndFeesZipCode,t=this.state.loanPayments.creditScore;e&&(t&&(this.isAprReqInProgress=!0,this.aprValues=await this.getAPRs(),this.isAprReqInProgress=!1),this.getLoanPayments())}async componentDidUpdate(e,t){let a=t.loanPayments;const s=this.props,i=s.offer,n=s.isTaxesAndFeesEnabled,r=s.selectedLoanIncentives,l=s.updateGetThisDealBtn,o=s.resetCustomVehiclePrice,c=s.onSharedInputUpdate,d=s.vin,p=this.state.loanPayments,u=p.creditScore,h=e.vin&&d!==e.vin;i.taxesAndFeesZipCode&&u&&(a.creditScore!==u||!e.offer.taxesAndFeesZipCode||h)&&(this.aprValues=await this.getAPRs());const g=m()(e,"selectedLoanIncentives"),b=!Y()(r,g),f=B()(a,ue),E=B()(p,ue),v=!Y()(f,E),y=oe.tb.some(t=>e.selections[t]!==this.props.selections[t]),C=n&&e.offer.taxesAndFeesZipCode!==i.taxesAndFeesZipCode,S=e.offer.conditionalIncentiveAmount!==i.conditionalIncentiveAmount;e.resetCustomVehiclePrice!==o&&o&&(l(!1),c(oe.t,"")),(v||C||S||ge!==he||y||b||h)&&!this.isAprReqInProgress&&(he=ge,this.getLoanPayments())}render(){const e=this.state,t=e.loanPayments,a=t.creditScore,s=(t.apr,Object(k.a)(t,["creditScore","apr"])),n=e.limitCriteria,r=e.drawerOffer,l=this.getSharedSelections(),o=l.tradeIn,c=l.downPayment,d=l.customVehiclePrice;return E.a.createElement("div",null,E.a.cloneElement(this.props.children,{payments:Object(i.a)({},s,this.props.offer,{apr:this.getAPR(),tradeIn:o,downPayment:c,customVehiclePrice:d}),baseCreditScore:Object(K.e)(a),limitMessages:this.limitMessages,onChange:this.changeState,limitCriteria:n,drawerOffer:r}))}}be.propTypes={setModelValue:y.a.func.isRequired,vin:y.a.string.isRequired,offer:y.a.shape({price:y.a.oneOfType([y.a.string,y.a.number]).isRequired,type:y.a.string.isRequired,year:y.a.oneOfType([y.a.string,y.a.number]),taxesAndFeesZipCode:y.a.string,styleId:y.a.string,marketValue:y.a.number,conditionalIncentiveAmount:y.a.number,primaryIncentiveAmount:y.a.number,docFee:y.a.number,mileage:y.a.number}).isRequired,selections:y.a.shape({apr:y.a.oneOfType([y.a.string,y.a.number]),numberOfMonths:y.a.oneOfType([y.a.string,y.a.number]),downPayment:y.a.oneOfType([y.a.string,y.a.number]),tradeIn:y.a.oneOfType([y.a.string,y.a.number]),customVehiclePrice:y.a.oneOfType([y.a.string,y.a.number])}),onMonthlyPaymentUpdate:y.a.func.isRequired,onSelectionUpdate:y.a.func.isRequired,onSharedInputUpdate:y.a.func.isRequired,children:y.a.node.isRequired,venomVersion:y.a.string.isRequired,pageName:y.a.string.isRequired,creativeId:y.a.string.isRequired,baseAPR:y.a.number,baseTermMonths:y.a.number,msrp:y.a.number.isRequired,isTaxesAndFeesEnabled:y.a.bool,isAuthenticated:y.a.bool,updateIdmData:y.a.func.isRequired,signInAnonymousAndSaveProfile:y.a.func.isRequired,unselectFinancingPromotions:y.a.func,clearMMYFromStorage:y.a.func,selectedLoanIncentives:y.a.arrayOf(pe.j),selectedLeaseIncentives:y.a.arrayOf(pe.j),updateGetThisDealBtn:y.a.func,resetCustomVehiclePrice:y.a.bool,usePaymentWithTaxesAndFeesForTabs:y.a.bool,useDefaults:y.a.bool},be.defaultProps={payments:{year:"",taxesAndFeesZipCode:"",styleId:"",marketValue:0,conditionalIncentiveAmount:0,primaryIncentiveAmount:0,docFee:null},selections:{apr:"",numberOfMonths:"",downPayment:"",tradeIn:"",customVehiclePrice:""},onInputChange:null,onRecalculationCall:null,baseAPR:null,baseTermMonths:null,shouldRecalculate:!1,isTaxesAndFeesEnabled:!1,isAuthenticated:null,unselectFinancingPromotions:null,clearMMYFromStorage:r.a,selectedLoanIncentives:[],selectedLeaseIncentives:[],updateGetThisDealBtn:null,resetCustomVehiclePrice:!1,usePaymentWithTaxesAndFeesForTabs:!1,useDefaults:!1};const fe={pageName:Object(se.a)("page.name",ne.a),venomVersion:Object(se.a)("version",ie.a),selectedLoanIncentives:Object(se.a)(re.b.SELECTED_LOAN_INCENTIVES,re.a),selectedLeaseIncentives:Object(se.a)(re.b.SELECTED_LEASE_INCENTIVES,re.a),resetCustomVehiclePrice:Object(se.a)(e=>{let t=e.vin;return!!t&&re.b.RESET_CUSTOM_VEHICLE_PRICE({vin:t})},re.a)},Ee=Object(ae.a)(be),ve=Object(se.b)(Ee,fe);var ye=a("../node_modules/lodash/findKey.js"),Ce=a.n(ye);const Se=["numberOfMonths","downPayment","tradeIn","creditScore"];class Te extends f.Component{constructor(e){super(e),this.getLoanPaymentsApiUrl=(()=>{const e=this.state.loanPayments,t=e.numberOfMonths,a=e.creditScore,s=this.props.dealerZipCode,i=this.props.offer,n=i.taxesAndFeesZipCode,r=i.styleId,l=i.marketValue,o=i.docFee,c=i.price,d=this.props,p=d.isTaxesAndFeesEnabled,m=d.selectedLoanIncentives,u=this.getSharedSelections,h=u.tradeIn,g=u.downPayment,b=u.customVehiclePrice,f=(m?m.filter(e=>{return!e.primary}):[]).map(e=>e.id&&e.id).join(",");return n?`/loan/v2/lowestmonthlypayment/?salesPrice=${b||c}&customerZipCode=${n}&dealerZipCode=${s}&styleId=${r}&marketValue=${l}&conditionalIncentives=${f}&numberOfMonths=${t}&downPayment=${g}&tradeIn=${h}&creditScore=${a}${p?`&docFee=${Object(te.k)(o)}`:""}`:""}),this.getLoanPayments=(()=>{const e=this.getLoanPaymentsApiUrl();if(!e)return null;const t=this.props,a=t.pageName,s=t.venomVersion,n=t.onMonthlyPaymentUpdate,r=t.offer,l=t.usePaymentWithTaxesAndFeesForTabs;return this.updateSelection({}),H.c.fetchJson(e,{headers:Object(Q.a)("loanPayments",a,s)}).then(e=>{const t=e.calculationCriteria,a=e.loanAmount,s=e.loanMonthlyPayment,o=e.limitCriteria,c=e.loanMonthlyPaymentWithTaxes,d=e.totalTaxesAndFees,p=e.taxes,m=e.fees,u=this.state.limitCriteria,h=t.financeRate,g=t.numberOfMonths,b=t.downPayment,f=t.tradeIn,E=t.incentives,v=E?E.map(e=>({id:e})):[];this.limitMessages=Object(X.c)(o,r.type),Object(K.k)({cur:{limitCriteria:o},prev:{limitCriteria:u}},[oe.ab,oe.Z],oe.h),this.updateSelection({loanMonthlyPayment:s,downPayment:b,tradeIn:f,numberOfMonths:g,financeRate:h,widgetLoanMonthlyPayment:s,calculatedOffer:e});const y=c||s;return n(l?y:s,"loan"),this.setState(e=>{let t=e.loanPayments;return{loanPayments:Object(i.a)({},t,{loan:a,monthly:s,monthlyWithTaxes:y,totalTaxesAndFees:d,taxes:p,fees:Object(i.a)({},m,{docFee:this.props.offer.docFee})}),limitCriteria:o,appliedPrimayLoanIncentives:v}},()=>this.fireCalculatorPaymentsChangeEvent(t,o))}).catch(e=>{this.updateSelection({loanMonthlyPayment:null,downPayment:null,tradeIn:null,numberOfMonths:null,financeRate:null,widgetLoanMonthlyPayment:null,calculatedOffer:null}),Object(G.a)("error",`Get loan payments error - ${e}`)})}),this.limitMessages={},this.updateIdmDataWrapper=(async e=>{try{await this.props.updateIdmData(e)}catch(e){Object(G.a)("warn","Profile data wasn't saved properly",e)}}),this.authenticate=(async e=>{try{await this.props.signInAnonymousAndSaveProfile(e,"edm-entry-payment-calculator")}catch(e){Object(G.a)("warn","Appraisal wasn't saved properly",e)}}),this.saveTradeInDataToIdm=(()=>{const e=this.props.isAuthenticated,t=Object(i.a)({},e?{}:{isAnonymous:!0});null!==e&&(e?this.updateIdmDataWrapper:this.authenticate)(t)}),this.updateSelection=(e=>{let t=e.loanMonthlyPayment,a=e.downPayment,s=e.tradeIn,n=e.numberOfMonths,r=e.financeRate,l=e.widgetLoanMonthlyPayment,o=e.calculatedOffer;const c=this.props,d=c.onSelectionUpdate,p=c.selections,u=this.state.loanPayments.creditScore,h={monthlyPayment:t,downPayment:Number(a),tradeIn:Number(s),numberOfMonths:Number(n),financeRate:Number(r),customVehiclePrice:m()(p,"customVehiclePrice",""),widgetMonthlyPayment:Number(l),calculatedOffer:o,creditScore:u,storedSelections:this.storage.get(ce.y.LOAN_PREFERENCES)};d({loan:Object(i.a)({},h,{isCustomized:function(e,t,a){const s=e.numberOfMonths;return F()(e,e=>D()(e))&&!(a===oe.C&&s===oe.H&&t===oe.I)}(h,s,a)})}),d.flush()}),this.fireCalculatorPaymentsChangeEvent=((e,t)=>{const a=this.props,s=a.offer.vin,n=a.creativeId;Z.a.fireCustomEvent(de.a.CALCULATE_PAYMENT,{vin:s,type:oe.h,creativeId:n,payments:Object(i.a)({},this.state.loanPayments,e),limitCriteria:t})}),this.resetAppliedIncentives=(()=>{const e=this.props,t=e.vin,a=e.setModelValue,s=e.selectedLoanIncentives,i=e.selectedLeaseIncentives,n=e.updateGetThisDealBtn;if(s){const e=s.filter(e=>{return e.primary})||[];a(re.b.SELECTED_LOAN_INCENTIVES({vin:t}),re.a,{vin:t,incentives:e})}if(i){const e=i.filter(e=>{return!e.conditionCategory})||[];a(re.b.SELECTED_LEASE_INCENTIVES({vin:t}),re.a,{vin:t,incentives:e})}a(re.b.RESET_CUSTOM_VEHICLE_PRICE({vin:t}),re.a,!1),n(!0)}),this.changeState=(e=>{let t=e.value,a=e.name,s=e.additionalValue;const n=this.props,r=n.onSharedInputUpdate,l=n.updateGetThisDealBtn;if(!(this.state.loanPayments[a]!==t))return null;const o=Object(i.a)({[a]:t},s),c=Object(K.j)(a);return a===oe.t&&(t?this.resetAppliedIncentives(t):l(!1)),c?(r(a,t,oe.g),a===oe.yb&&this.saveTradeInDataToIdm(),null):this.setState(e=>({loanPayments:Object(i.a)({},e.loanPayments,o)}),()=>{(0,this.props.clearMMYFromStorage)(),this.storage.set(ce.y.LOAN_PREFERENCES,q()(Object(i.a)({},this.storage.get(ce.y.LOAN_PREFERENCES),o,{isUsed:!1}),e=>!M()(e)))})});const t=e.offer,a=e.useDefaults;this.storage=new W.a("localStorage");const s=!a&&this.storage.get(ce.y.LOAN_PREFERENCES)||{},n=s.numberOfMonths,r=s.creditScore,l=s.tradeIn,o=s.downPayment;this.tradeInFromStorage=l,this.downPaymentFromStorage=o;const c=t.type,d=Object(J.a)(c)?oe.q[oe.l].value:oe.q[oe.n].value;this.state={loanPayments:{numberOfMonths:n||oe.H,loan:null,monthly:null,creditScore:r||d},limitCriteria:{}}}async componentDidMount(){this.props.offer.taxesAndFeesZipCode&&this.getLoanPayments()}async componentDidUpdate(e,t){let a=t.loanPayments;const s=this.props,i=s.offer,n=s.isTaxesAndFeesEnabled,r=s.selectedLoanIncentives,l=s.updateGetThisDealBtn,o=s.resetCustomVehiclePrice,c=s.onSharedInputUpdate,d=this.state.loanPayments,p=m()(e,"selectedLoanIncentives"),u=!Y()(r,p),h=B()(a,Se),g=B()(d,Se),b=!Y()(h,g),f=oe.tb.some(t=>e.selections[t]!==this.props.selections[t]),E=n&&e.offer.taxesAndFeesZipCode!==i.taxesAndFeesZipCode,v=e.offer.conditionalIncentiveAmount!==i.conditionalIncentiveAmount;e.resetCustomVehiclePrice!==o&&o&&(l(!1),c(oe.t,"")),(b||E||v||f||u)&&this.getLoanPayments()}get getSharedSelections(){const e=this.props.selections,t=o()(e.tradeIn)?e.tradeIn:this.tradeInFromStorage,a=o()(t)?t:oe.I,s=o()(e.downPayment)?e.downPayment:this.downPaymentFromStorage;return{tradeIn:a,downPayment:o()(s)?s:oe.C,customVehiclePrice:o()(e.customVehiclePrice)?e.customVehiclePrice:""}}get storedCreditScore(){const e=this.state.loanPayments.creditScore;return o()(e)?Ce()(oe.q,t=>e<=t.max&&e>=t.min):"Unknown"}render(){const e=this.state,t=e.loanPayments,a=(t.creditScore,Object(k.a)(t,["creditScore"])),s=e.limitCriteria,n=e.appliedPrimayLoanIncentives,r=this.getSharedSelections,l=r.tradeIn,o=r.downPayment,c=r.customVehiclePrice;return E.a.createElement("div",null,E.a.cloneElement(this.props.children,{payments:Object(i.a)({},a,this.props.offer,{tradeIn:l,downPayment:o,customVehiclePrice:c}),baseCreditScore:this.storedCreditScore,limitMessages:this.limitMessages,onChange:this.changeState,limitCriteria:s,appliedPrimayLoanIncentives:n}))}}Te.propTypes={setModelValue:y.a.func.isRequired,vin:y.a.string.isRequired,offer:y.a.shape({price:y.a.oneOfType([y.a.string,y.a.number]).isRequired,type:y.a.string.isRequired,year:y.a.oneOfType([y.a.string,y.a.number]),taxesAndFeesZipCode:y.a.string,styleId:y.a.string,marketValue:y.a.number,conditionalIncentiveAmount:y.a.number,primaryIncentiveAmount:y.a.number,docFee:y.a.number,mileage:y.a.number}).isRequired,creativeId:y.a.string.isRequired,selections:y.a.shape({numberOfMonths:y.a.oneOfType([y.a.string,y.a.number]),downPayment:y.a.oneOfType([y.a.string,y.a.number]),tradeIn:y.a.oneOfType([y.a.string,y.a.number]),customVehiclePrice:y.a.oneOfType([y.a.string,y.a.number])}),dealerZipCode:y.a.string.isRequired,onMonthlyPaymentUpdate:y.a.func.isRequired,onSelectionUpdate:y.a.func.isRequired,onSharedInputUpdate:y.a.func.isRequired,children:y.a.node.isRequired,venomVersion:y.a.string.isRequired,pageName:y.a.string.isRequired,isTaxesAndFeesEnabled:y.a.bool,isAuthenticated:y.a.bool,updateIdmData:y.a.func.isRequired,signInAnonymousAndSaveProfile:y.a.func.isRequired,clearMMYFromStorage:y.a.func,selectedLoanIncentives:y.a.arrayOf(pe.j),selectedLeaseIncentives:y.a.arrayOf(pe.j),updateGetThisDealBtn:y.a.func,resetCustomVehiclePrice:y.a.bool,useDefaults:y.a.bool,usePaymentWithTaxesAndFeesForTabs:y.a.bool},Te.defaultProps={payments:{year:"",taxesAndFeesZipCode:"",styleId:"",marketValue:0,conditionalIncentiveAmount:0,primaryIncentiveAmount:0,docFee:null},selections:{numberOfMonths:"",downPayment:"",tradeIn:"",customVehiclePrice:""},onInputChange:null,shouldRecalculate:!1,isTaxesAndFeesEnabled:!1,isAuthenticated:null,clearMMYFromStorage:r.a,selectedLoanIncentives:[],selectedLeaseIncentives:[],updateGetThisDealBtn:null,resetCustomVehiclePrice:!1,usePaymentWithTaxesAndFeesForTabs:!1,useDefaults:!1};const Ie={pageName:Object(se.a)("page.name",ne.a),venomVersion:Object(se.a)("version",ie.a),selectedLoanIncentives:Object(se.a)(re.b.SELECTED_LOAN_INCENTIVES,re.a),selectedLeaseIncentives:Object(se.a)(re.b.SELECTED_LEASE_INCENTIVES,re.a),resetCustomVehiclePrice:Object(se.a)(e=>{let t=e.vin;return t?re.b.RESET_CUSTOM_VEHICLE_PRICE({vin:t}):null},re.a)},Ne=Object(ae.a)(Te),_e=Object(se.b)(Ne,Ie);var Oe=a("../node_modules/reactstrap/lib/Form.js"),Pe=a.n(Oe),Ae=a("../node_modules/reactstrap/lib/FormGroup.js"),Ve=a.n(Ae),xe=a("./site-modules/shared/components/calculator/payment-input/payment-input.jsx"),ke=a("./site-modules/shared/components/calculator/radio-group/radio-group.jsx"),we=a("./site-modules/shared/components/calculator/credit-score/credit-score.jsx"),Re=a("./site-modules/shared/components/calculator/vehicle-price/vehicle-price.jsx"),Me=a("./constants/inventory-types.js"),je=a("../node_modules/lodash/isEmpty.js"),De=a.n(je),Le=a("../node_modules/lodash/isUndefined.js"),Fe=a.n(Le),Ue=a("./site-modules/shared/utils/price-utils.js"),qe=a("./site-modules/shared/components/content-collapse/content-collapse.jsx"),ze=a("./site-modules/shared/components/tooltip-item/tooltip-item.jsx"),Be=a("./site-modules/shared/constants/index.js"),$e=a("./site-modules/shared/components/odometer-wrapper/odometer-wrapper.jsx"),Ye=a("./site-modules/shared/components/spinner/spinner.jsx");a("./site-modules/shared/components/calculator/monthly-payment/monthly-payment.scss");const He="-";function Ze(e){let t=e.price,a=e.disclaimerSymbol,s=e.priceClasses,i=e.monthsClasses,n=e.type,r=e.initialLoading,l=e.allowNegative,o=e.creativeId;Object(f.useEffect)(()=>{r||n!==oe.g||t!==oe.db||"price-checker-payment-calculator"!==o||Z.a.fireTrackAction({event_type:V.b.EVENT_TYPE_ACTION_COMPLETED,event_data:{subaction_name:"lease_payment_error",action_category:V.b.SYSTEM_ACTION_CATEGORY,value:He,creative_id:o}})},[r,n,t,o]);const c=t>0||l&&Number.isFinite(parseInt(t,10))?E.a.createElement(f.Fragment,null,E.a.createElement($e.OdometerWrapper,{value:t,classNames:_()("monthly-payment-value d-inline-block",s),duration:200}),E.a.createElement("span",{className:i},"/mo",a?E.a.createElement("sup",null,a):"")):E.a.createElement("span",{className:"d-inline-block pb-0_25 text-uppercase"},n===oe.g?He:Be.f);return r?E.a.createElement(Ye.a,null):c}Ze.propTypes={disclaimerSymbol:y.a.string,monthsClasses:y.a.string,price:y.a.oneOfType([y.a.string,y.a.number]),priceClasses:y.a.string,type:y.a.string,initialLoading:y.a.bool,allowNegative:y.a.bool,creativeId:y.a.string},Ze.defaultProps={disclaimerSymbol:"",monthsClasses:"",price:0,priceClasses:"",type:"",initialLoading:!1,allowNegative:!1,creativeId:""};a("./site-modules/shared/components/calculator/price-item/price-item.scss");function Ge(e){let t=e.price,a=e.calculatorType,s=e.infoType,i=e.wrapperClasses,n=e.priceClasses,r=e.monthsClasses,l=e.tooltipId,o=e.title,c=e.priceAnimation,d=e.details;const p=oe.ub[s];return E.a.createElement(S.a,{className:_()("price-item align-items-center mb-0_5",i)},E.a.createElement(I.a,{xs:8,lg:9,className:"pr-0 pr-md-0_5"},o," ",E.a.createElement(ze.a,{id:`${a}${l}`,className:"tooltip-text",item:p})),E.a.createElement(I.a,{xs:4,lg:3,className:_()("pl-0 text-right",n)},c?E.a.createElement(Ze,{price:t,disclaimerSymbol:"*",monthsClasses:r}):t),!!d&&E.a.createElement(I.a,{xs:12},E.a.createElement("div",{className:"small text-gray"},d)))}Ge.propTypes={calculatorType:y.a.string.isRequired,price:y.a.oneOfType([y.a.string,y.a.number]).isRequired,infoType:y.a.string.isRequired,wrapperClasses:y.a.string,monthsClasses:y.a.string,priceClasses:y.a.string,tooltipId:y.a.string.isRequired,title:y.a.string.isRequired,priceAnimation:y.a.bool,details:y.a.string},Ge.defaultProps={wrapperClasses:"",priceClasses:"",monthsClasses:"",priceAnimation:!1,details:""};var We=a("../node_modules/reactstrap/lib/Label.js"),Qe=a.n(We),Ke=a("../node_modules/reactstrap/lib/Input.js"),Xe=a.n(Ke),Je=a("./site-modules/shared/constants/key-codes.js");class et extends f.Component{constructor(){super(...arguments),this.state={value:"",previousTaxesAndFeesZipCode:""},this.setFallbackZipCode=(()=>{this.setState({value:this.props.taxesAndFeesZipCode})}),this.handleChange=(e=>{let t=e.target.value;this.setState({value:t})}),this.handleZipCodeChange=(e=>{this.props.setZipToStorage(e).catch(()=>{this.setFallbackZipCode()})}),this.handleEnterPress=(e=>{e.keyCode===Je.a?this.callUpdate():e.keyCode===Je.b&&this.setFallbackZipCode()}),this.callUpdate=(()=>{const e=this.props.onValidate,t=this.state.value;e&&e(t)?this.handleZipCodeChange(t):this.setFallbackZipCode()})}static getDerivedStateFromProps(e,t){return t.previousTaxesAndFeesZipCode!==e.taxesAndFeesZipCode?{value:e.taxesAndFeesZipCode,previousTaxesAndFeesZipCode:e.taxesAndFeesZipCode}:null}render(){const e=this.props,t=e.label,a=e.wrapperClasses,i=e.labelClasses,n=e.inputClasses,r=e.inputSize,l=e.calculatorType,o=e.isLabelHidden,c=`${l}-zip`;return E.a.createElement("div",{className:a},t&&!o&&E.a.createElement(Qe.a,{for:c,className:i},t),E.a.createElement(Xe.a,Object(s.a)({id:c,bsSize:r,type:"number",value:this.state.value,onKeyDown:this.handleEnterPress,onBlur:this.callUpdate,onChange:this.handleChange,className:n,"data-tracking-id":"taxes_and_fees_zip_input"},t&&o?{"aria-label":t}:{})))}}et.propTypes={onValidate:y.a.func,label:y.a.string,wrapperClasses:y.a.string,labelClasses:y.a.string,inputClasses:y.a.string,inputSize:y.a.string,taxesAndFeesZipCode:y.a.string,setZipToStorage:y.a.func.isRequired,calculatorType:y.a.string.isRequired,isLabelHidden:y.a.bool},et.defaultProps={onValidate:null,label:"",wrapperClasses:"",labelClasses:"",inputClasses:"",inputSize:"sm",taxesAndFeesZipCode:"",isLabelHidden:!1};var tt=a("./site-modules/shared/components/form-validation/validation.js"),at=a("./site-modules/shared/utils/calculator/taxes-and-fees-helper.js"),st=a("./site-modules/shared/components/car-buying/odometer-payment-value/odometer-payment-value.jsx"),it=a("./site-modules/shared/components/calculator/taxes-and-fees/taxes-and-fees-utils.jsx");a("./site-modules/shared/components/calculator/taxes-and-fees/taxes-and-fees.scss");function nt(e){let t=e.calculatorType,a=e.payments,s=a.monthlyWithTaxes,i=a.totalTaxesAndFees,n=a.taxes,r=a.fees,l=a.type,o=e.taxesAndFeesZipCode,c=e.setZipToStorage,d=e.appliedTradeIn,p=e.tradeInValidationErrorMsg;if(Fe()(s))return null;const m="number"==typeof i,u=t===oe.g,h=u?oe.P:oe.O,g=!u||!De()(n),b=`Payment with ${g?"Taxes and ":""}Fees`,v=g?"paymentWithTaxesAndFees":"paymentWithFees";return E.a.createElement("div",{className:"taxes-and-fees"},E.a.createElement(Ge,{price:m?Object(Ue.a)(i,2,2):at.a,details:m?"":at.b,calculatorType:t,infoType:g?"taxesAndFees":"fees",tooltipId:"TaxesAndFees",title:`Estimated ${g?"Taxes and ":""}Fees`,wrapperClasses:"pt-0_5 mb-1"}),m&&E.a.createElement(et,{onValidate:tt.a.validateZip,taxesAndFeesZipCode:o,label:"For ZIP Code",inputClasses:"zip-input size-16 px-1 text-right",wrapperClasses:"d-flex justify-content-between align-items-center pos-r location-icon",labelClasses:"mb-0",setZipToStorage:c,calculatorType:t}),m&&E.a.createElement(qe.a,{minHeight:"0px",textClosed:"Show Details",textOpen:"Hide Details",justify:"justify-content-start",btnTextClasses:"text-capitalize font-weight-normal text-primary-darker",btnContainerClasses:"",btnArrowClasses:"small",showBtnBelow:!0,isBtnLink:!0},E.a.createElement("div",{className:"mt-1_5"},Object(it.a)(t,n,oe.vb,l,!0)),E.a.createElement("div",{className:"mt-1_5"},Object(it.a)(t,r,h,l))),!!d&&E.a.createElement(f.Fragment,null,E.a.createElement("hr",{className:"my-1_5"}),E.a.createElement("div",{className:"d-flex align-items-baseline flex-nowrap justify-content-between no-gutters vehicle-param text-gray-darker body mt-1 mt-md-1_5"},E.a.createElement("div",null,E.a.createElement("span",null,"Applied Trade-In Value:")),E.a.createElement("div",{className:"text-right applied-trade-in font-weight-bold"},E.a.createElement(st.a,{value:d}))),E.a.createElement("div",{className:"disclaimer text-gray-darker mt-0_5"},p)),E.a.createElement("hr",{className:"mt-1_5 mb-2"}),E.a.createElement(Ge,{price:m?s:at.a,calculatorType:t,infoType:v,tooltipId:"PaymentWithTaxesAndFees",title:b,priceClasses:"font-weight-bold",monthsClasses:"font-weight-bold",priceAnimation:m}))}nt.propTypes={calculatorType:y.a.string.isRequired,payments:y.a.shape({monthlyWithTaxes:y.a.number,totalTaxesAndFees:y.a.number,taxes:y.a.shape({}),fees:y.a.objectOf(y.a.oneOfType([y.a.arrayOf(y.a.object),y.a.number])),type:y.a.string}),taxesAndFeesZipCode:y.a.string,setZipToStorage:y.a.func,appliedTradeIn:y.a.number,tradeInValidationErrorMsg:y.a.string},nt.defaultProps={payments:{monthlyWithTaxes:0,totalTaxesAndFees:0,taxes:{},fees:{}},taxesAndFeesZipCode:"",setZipToStorage:null,appliedTradeIn:0,tradeInValidationErrorMsg:""};var rt=a("../node_modules/dateformat/lib/dateformat.js"),lt=a.n(rt);const ot={[oe.g]:"Excludes sales tax, title, registration, security deposit, and other fees. Actual monthly\npayments will vary. Does not represent a financing offer or guarantee of credit.",[oe.h]:"Excludes sales tax, title, registration and other fees. Actual monthly payments will vary.\nDoes not represent a financing offer or guarantee of credit."},ct={[oe.g]:(e,t,a,s)=>{let i=ot[oe.g];return e&&t&&(i=`${Object(Ue.a)(t)} total due at lease signing includes down payment, first month payment, and ${Object(Ue.a)(a)} security deposit. Total cost to lessee is ${Object(Ue.a)(e)} over the lease term. ${s?"The payment shown includes estimated sales tax, title, registration and other fees.":"Except as otherwise expressly provided, excludes sales tax, title, registration and other fees."} Lessee is responsible for vehicle maintenance, insurance, repairs and charges for excess wear and tear. Actual monthly payments will vary. Not all lessees may qualify; higher lease rates apply for lessees with lower credit ratings.`),i},[oe.h]:()=>"Except as otherwise expressly provided, excludes sales tax, title, registration and other fees. Actual monthly payments will vary. Does not represent a financing offer or guarantee of credit."};function dt(e){let t=e.noPadding,a=e.footnoteSymbol,s=e.size,i=e.openedForm,n=e.leasePromiseEndDate,r=e.isTaxesAndFeesAvailable,l=e.payments;const o=l.totalLeaseCost,c=l.dueAtSigning,d=l.securityDeposit,p=void 0===d?0:d;return E.a.createElement("p",{className:_()("text-gray pt-0_5",s,{"px-1":!t})},a&&E.a.createElement("sup",{className:_()(s)},a," "),function(e){let t=e.openedForm,a=e.totalLeaseCost,s=e.dueAtSigning,i=e.securityDeposit,n=e.leasePromiseEndDate,r=e.isTaxesIncluded,l=e.useExtendedText;const o=n?lt()(new Date(n),"m/d/yyyy"):"";return l?`${ct[t](a,s,i,r)}${o&&` Payment estimate based on lease programs in effect through ${o}.`}`:`${ot[t]}${o&&` Payment estimate based on programs through ${o}.`}`}({openedForm:i,totalLeaseCost:o,dueAtSigning:c,securityDeposit:p,leasePromiseEndDate:n,useExtendedText:r}))}dt.propTypes={noPadding:y.a.bool,leasePromiseEndDate:y.a.number,openedForm:y.a.string,footnoteSymbol:y.a.string,size:y.a.string,isTaxesAndFeesAvailable:y.a.bool,payments:y.a.shape({totalLeaseCost:y.a.number,dueAtSigning:y.a.number,securityDeposit:y.a.number})},dt.defaultProps={noPadding:!1,leasePromiseEndDate:null,openedForm:"",footnoteSymbol:"*",size:"disclaimer",isTaxesAndFeesAvailable:!0,payments:{}};var pt=a("./site-modules/shared/components/report-smth-wrong-link/report-smth-wrong-link.jsx"),mt=a("./site-modules/shared/utils/string.js"),ut=a("../node_modules/reactstrap/lib/Button.js"),ht=a.n(ut);function gt(e){let t=e.appraisalMMYLabel,a=e.onClick;return E.a.createElement(ht.a,{onClick:a,color:"link",className:"d-inline-block medium text-primary-darker form-link p-0","data-tracking-id":"select_appraise","data-test":"what-is-my-car-worth"},Object(K.h)(t))}gt.propTypes={appraisalMMYLabel:y.a.string,onClick:y.a.func.isRequired},gt.defaultProps={appraisalMMYLabel:""};var bt=a("./site-modules/shared/components/car-buying/trade-in/trade-in-popover.jsx");a("./site-modules/shared/components/calculator/loan-calculator-form/loan-calculator-form.scss");const ft=["numberOfMonths","downPayment","tradeIn","monthlyWithTaxes","totalTaxesAndFees","taxes","fees","customVehiclePrice"];class Et extends f.Component{constructor(){var e;e=super(...arguments),this.state={tradeInValidationErrorMsg:"",appliedTradeInMessage:"",tradeInValue:0,amountLimit:0,appliedTradeIn:0},this.isTradeInUpdated=!1,this.handleInputChange=(async e=>{const t=this.props.useBestPaymentService,a=Object(X.a)(e),s=a.value,i=a.name;let n={};if(t||i!==oe.d||(n={[oe.o]:null}),i===oe.yb){this.isTradeInUpdated=!0;const e=await this.calculateLimits(s);this.handleUpdateTradeIn(e,s,!0)}else this.props.onChange({value:s,name:i,additionalValue:n})}),this.calculateLimits=(e=>{const t=this.props,a=t.vehiclePrice,s=t.isUsed,i=t.styleId,n=t.taxesAndFeesZipCode,r=t.pageName,l=t.venomVersion,o=t.msrp;return Object(K.a)({msrp:o,salesPrice:a,isPurchase:!0,isUsed:s,styleId:i,zipCode:n,tradeIn:e,pageName:r,venomVersion:l})}),this.handleUpdateTradeIn=function(t,a){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=e.props.isUsed?Me.a.USED:Me.a.NEW,n=Object(K.i)(m()(t,"limitCriteria",{}),i).tradeInValidationError,r=Object(K.d)(t,oe.ab)||a,l=a<0?oe.fb:"";s?e.setState({tradeInValue:a,amountLimit:r,tradeInValidationErrorMsg:n?`${n} ${l}`:""},()=>{e.isTradeInUpdated=!1,n||(e.updateAppliedTradeIn(),e.props.onChange({value:a,name:oe.yb}))}):e.setState({tradeInValue:a,tradeInValidationErrorMsg:"",appliedTradeIn:r,appliedTradeInMessage:`${n} ${l}`},()=>{e.isTradeInUpdated=!1})},this.handleApplyTradeIn=(()=>{const e=this.state,t=e.tradeInValue,a=e.amountLimit,s=e.tradeInValidationErrorMsg;this.setState({tradeInValidationErrorMsg:"",appliedTradeIn:a,appliedTradeInMessage:s}),this.props.onChange({value:t,name:oe.yb})}),this.updateAppliedTradeIn=(()=>{const e=this.state.amountLimit;this.setState({appliedTradeIn:e,appliedTradeInMessage:e<0?oe.fb:""})}),this.handleKeyPress=(e=>{Object(X.b)(e)&&e.currentTarget.blur()}),this.handleCreditScoreChange=(e=>{const t=m()(e,"currentTarget.value",oe.l);this.props.onCreditScoreChange&&this.props.onCreditScoreChange(le.d.CHECKBOX);const a={value:oe.q[t].value,name:oe.o,additionalValue:{[oe.d]:null}};this.props.onChange(a)}),this.handleCreditScoreEnterPress=(e=>{Object(X.b)(e)&&this.handleCreditScoreChange(e)})}shouldComponentUpdate(e,t){const a=this.props,s=a.payments,i=a.limitMessages,n=a.appliedIncentives,r=a.taxesAndFeesZipCode,l=a.baseCreditScore,o=a.useBestPaymentService,c=a.internalDrawerConfig,d=this.state,p=d.tradeInValue,m=d.tradeInValidationErrorMsg,u=o?ft:[...ft,"apr"],h=B()(e.payments,u),g=B()(s,u);return!(Y()(h,g)&&Y()(e.limitMessages,i)&&Y()(e.appliedIncentives,n)&&Y()(e.internalDrawerConfig,c)&&e.taxesAndFeesZipCode===r&&e.baseCreditScore===l&&t.tradeInValue===p&&t.tradeInValidationErrorMsg===m)}async componentDidUpdate(){const e=this.props.payments,t=this.state.tradeInValue,a=m()(e,oe.yb);if(a!==t&&!this.isTradeInUpdated){this.isTradeInUpdated=!0;const e=this.calculateLimits(a);this.handleUpdateTradeIn(e,a)}return null}render(){const e=this.props,t=e.vehicle,a=e.vehiclePrice,i=e.payments,n=e.onTradeInClick,r=e.limitMessages,l=e.appliedIncentives,o=e.taxesAndFeesZipCode,c=e.setZipToStorage,d=e.styleId,p=e.isNonTMVDealer,m=e.baseCreditScore,u=e.appraisalMMYLabel,h=e.limitCriteria,g=e.useBestPaymentService,b=e.appliedPrimayLoanIncentives,f=e.onChange,v=e.drawerOffer,y=e.internalDrawerConfig,C=e.vehiclePriceProps,S=e.paymentInputProps,T=e.radioGroupProps,I=e.hideTaxesFeesSection,N=this.state,_=N.tradeInValidationErrorMsg,O=N.appliedTradeIn,P=N.appliedTradeInMessage,A=i.apr,V=i.numberOfMonths,x=i.downPayment,k=i.tradeIn,w=i.type,R=i.vin,M=i.customVehiclePrice,j=p?[]:l,D=Object(K.g)({payments:i,taxesAndFeesZipCode:o,calculatorType:oe.h,type:w,incentives:j,creditTier:oe.k.find(e=>e.name===m)||{name:m}});return E.a.createElement(Pe.a,{className:"loan-calculator-form p-0_75",id:"loan-calc",noValidate:!0},E.a.createElement(Ve.a,{className:"mb-1_5"},E.a.createElement(Re.a,Object(s.a)({vin:R,vehicle:t,price:a,vehicleType:w,calculatorType:oe.h,appliedIncentives:j,isNonTMVDealer:p,payments:i,tradeIn:O,limitCriteria:h,appliedPrimayLoanIncentives:b,useBestPaymentPrimaryIncentives:g,onChange:f,customVehiclePrice:M,drawerOffer:v,internalDrawerConfig:y,paymentInputProps:S},C))),E.a.createElement(Ve.a,{className:"mb-1_5"},E.a.createElement(ke.a,Object(s.a)({trackingId:"select_loan_payment_term",onKeyPress:this.handleKeyPress,onClick:this.handleInputChange,values:oe.bb,name:oe.eb,title:oe.cb.TERM_TITLE,selected:V,selectedValuePostfix:"months"},T))),E.a.createElement(Ve.a,{className:"mb-1_5 pos-r trade-in-input"},E.a.createElement(xe.a,Object(s.a)({name:"tradeIn",label:oe.cb.TRADE_IN_TITLE,appraisalMMYLabel:u,trackingId:"select_trade_in_value",key:k,value:Object(mt.c)(k),tooltip:oe.wb.TRADE_IN,onKeyPress:this.handleKeyPress,onBlur:this.handleInputChange,paymentInputClassNames:_?"is-invalid":"",inputMode:null,isCurrency:!0,inputType:""},S),E.a.createElement(gt,{appraisalMMYLabel:u,onClick:n})),_&&E.a.createElement(bt.a,{tradeInValidationError:_,onApplyTradeIn:this.handleApplyTradeIn,calculator:oe.i})),E.a.createElement(Ve.a,{className:"mb-1_25"},E.a.createElement(xe.a,Object(s.a)({name:"downPayment",label:oe.cb.DOWN_PAYMENT_TITLE,trackingId:"select_loan_down_payment",key:x,value:Object(mt.c)(x),tooltip:oe.wb.DOWN_PAYMENT,onKeyPress:this.handleKeyPress,onBlur:this.handleInputChange,limitMessage:r[oe.Z],isCurrency:!0,disallowNegative:!0,inputType:""},S))),E.a.createElement(Ve.a,{className:"mb-1_5"},E.a.createElement(we.a,{onClick:this.handleCreditScoreChange,onKeyPress:this.handleCreditScoreEnterPress,id:"creditScore",titleClasses:"mr-0_25",title:oe.cb.CREDIT_SCORE_TITLE,tooltip:oe.wb.CREDIT_SCORE,selected:m,values:oe.k})),!g&&E.a.createElement(Ve.a,{className:"mb-0_75"},E.a.createElement(xe.a,Object(s.a)({name:oe.d,label:oe.cb.ANNUAL_RATE_TITLE,trackingId:"select_apr",key:A,value:A,isPercentage:!0,tooltip:oe.wb.APR,onKeyPress:this.handleKeyPress,onBlur:this.handleInputChange},S))),!I&&E.a.createElement(Ve.a,{className:"mb-0_75"},E.a.createElement(nt,{calculatorType:oe.h,payments:i,taxesAndFeesZipCode:o,setZipToStorage:c,appliedTradeIn:O,tradeInValidationErrorMsg:P})),E.a.createElement(dt,{openedForm:oe.h,isTaxesAndFeesAvailable:!!d,noPadding:!0}),E.a.createElement(pt.a,{paramsData:D,linkClassName:"align-middle text-decoration-none-hover text-primary-darker",iconClassName:"icon-notification2 mr-0_5 text-gray-darker",trackingId:"payment_feedback",trackingValue:"payment feedback",title:"Payment feedback",form:"payment-feedback"}))}}Et.propTypes={vehiclePrice:y.a.number.isRequired,vehicle:A.b.InventoryVin,payments:y.a.shape({apr:y.a.oneOfType([y.a.number,y.a.string]),numberOfMonths:y.a.oneOfType([y.a.number,y.a.string]),tradeIn:y.a.oneOfType([y.a.number,y.a.string]),downPayment:y.a.oneOfType([y.a.number,y.a.string]),type:y.a.string,monthly:y.a.number,monthlyWithTaxes:y.a.number,totalTaxesAndFees:y.a.number,taxes:y.a.objectOf(y.a.number),fees:y.a.objectOf(y.a.oneOfType([y.a.arrayOf(y.a.object),y.a.number])),customVehiclePrice:y.a.oneOfType([y.a.number,y.a.string])}),onChange:y.a.func,onCreditScoreChange:y.a.func,baseCreditScore:y.a.string,onTradeInClick:y.a.func,limitMessages:y.a.shape({}),appliedIncentives:y.a.arrayOf(y.a.oneOfType([P.b.Incentive,A.b.Incentive])),taxesAndFeesZipCode:y.a.string,setZipToStorage:y.a.func,styleId:y.a.string,isNonTMVDealer:y.a.bool,appraisalMMYLabel:y.a.string,limitCriteria:y.a.shape({}),useBestPaymentService:y.a.bool,appliedPrimayLoanIncentives:y.a.arrayOf(y.a.shape({id:y.a.number})),isUsed:y.a.bool,venomVersion:y.a.string,pageName:y.a.string,drawerOffer:pe.a,internalDrawerConfig:y.a.shape({onToggle:y.a.func,portalSelector:y.a.string,openedDrawer:y.a.string}),vehiclePriceProps:y.a.shape({customLabel:y.a.string,customTooltip:y.a.func,hideDescription:y.a.bool,isReadOnly:y.a.bool}),paymentInputProps:y.a.shape({}),radioGroupProps:y.a.shape({}),hideTaxesFeesSection:y.a.bool},Et.defaultProps={payments:{},vehicle:{},onChange:null,onCreditScoreChange:null,baseCreditScore:"",onTradeInClick:null,limitMessages:{},taxesAndFeesZipCode:"",setZipToStorage:null,appliedIncentives:[],styleId:null,isNonTMVDealer:!1,appraisalMMYLabel:"",limitCriteria:{},useBestPaymentService:!1,appliedPrimayLoanIncentives:[],isUsed:!1,venomVersion:"",pageName:"",drawerOffer:null,internalDrawerConfig:null,vehiclePriceProps:null,paymentInputProps:null,radioGroupProps:null,hideTaxesFeesSection:!1};var vt=a("../node_modules/lodash/xorWith.js"),yt=a.n(vt),Ct=a("../node_modules/lodash/result.js"),St=a.n(Ct),Tt=a("./site-modules/shared/utils/inventory/price-analysis.js"),It=a("./site-modules/shared/utils/car-buying/monthly-payment-calculator-call.js"),Nt=a("./site-modules/shared/utils/car-buying/incentives-service.js"),_t=a("./data/models/visitor.js");const Ot=["numberOfMonths","annualMileage"];class Pt extends f.Component{constructor(e){super(e),this.getSharedSelections=(()=>{const e=this.props.payments,t=o()(e.tradeIn)?e.tradeIn:this.tradeInFromStorage,a=o()(t)?t:oe.I,s=o()(e.downPayment)?e.downPayment:this.downPaymentFromStorage;return{tradeIn:a,downPayment:o()(s)?s:oe.A,customVehiclePrice:o()(e.customVehiclePrice)?e.customVehiclePrice:""}}),this.getLeaseOffers=(async()=>{const e=this.props,t=e.dealerMapping,a=e.vehicle,s=e.pageName,i=e.venomVersion,n=e.visitorId,r=e.setModelValue,l=e.storedIncentives;if(t)try{const e=a.dealerInfo.address.zip,t=a.vehicleInfo.styleInfo.styleId,o=a.vin;if(!t)return void this.showError("styleId is missing",!1);const c=m()(l,"lease",[]);let d=c?c.filter(e=>{let t=e.conditionCategory;return t&&0!==t.length}):[];const p=m()(l,"primaryLease",[]);let u=c;if(this.isInitialLoading){u=await Object(Nt.a)({styleId:t,zip:e,vin:o},{visitorId:n,pageName:s,venomVersion:i});const a=m()(u,"incentives",[]),l=a?a.filter(e=>!e.conditionCategory):[],p=a?a.filter(e=>e.conditionCategory):[],h=c?[...l,...d]:[...l];r(re.b.SELECTED_PRIMARY_LEASE_INCENTIVES({vin:o}),re.a,{vin:o,incentives:l}),r(re.b.CONDITIONAL_LEASE_INCENTIVES({vin:o}),re.a,{vin:o,incentives:p}),this.leaseOffers=await this.getOffers(h)}else d=u?u.filter(e=>{let t=e.conditionCategory;return t&&0!==t.length}):[],this.leaseOffers=await this.getOffers([...p,...d]),this.calculateOffer();if(!this.leaseOffers)return;this.defaultLeaseOffer=Object(It.e)(this.leaseOffers),this.config=Object(te.d)(this.leaseOffers,{isPurchase:!1})}catch(e){this.showError(e,!0)}}),this.setZip=(e=>(this.setState(()=>({customZipCode:e})),this.props.setZip(e))),this.getPayments=(async()=>{const e=this.props,t=e.vehicle,a=e.pageName,s=e.venomVersion,n=e.visitorId,r=e.isNonTMVDealer,l=e.storedIncentives,o=this.state.customZipCode,c=this.getSharedSelections(),d=c.downPayment,p=c.tradeIn,m=c.customVehiclePrice,u={digitalRetailOffers:this.leaseOffers,selectedMileage:this.getSelectedAnnualMileage(),selectedTerm:this.getSelectedNumberOfMonth(),selectedDownPayment:d,selectedTradeIn:p,vehicle:t,zipCode:o,incentives:l},h=await Promise.all([Object(It.h)(Object(i.a)({},u,{customVehiclePrice:m}),{visitorId:n,pageName:a,venomVersion:s,isPurchase:!1,isNonTMVDealer:r})||{},Object(It.h)(Object(i.a)({},u),{visitorId:n,pageName:a,venomVersion:s,isPurchase:!1,isNonTMVDealer:r})||{}]),g=Object(w.a)(h,2);return[g[0],g[1]]}),this.isInitialLoading=!0,this.calculateOffer=(async e=>{const t=this.props,a=t.vehicle,s=t.onSelectionUpdate,n=t.onMonthlyPaymentUpdate,r=t.pageName,l=t.venomVersion,o=t.visitorId,c=t.isNonTMVDealer,d=t.storedIncentives,p=t.setModelValue,u=t.vin,h=t.usePaymentWithTaxesAndFeesForTabs,g=this.state.customZipCode;if(this.leaseOffers){s({lease:{}});try{const t=this.getSharedSelections(),b=t.downPayment,f=t.tradeIn,E=t.customVehiclePrice,v=E?await this.getPayments():await Object(It.h)({digitalRetailOffers:this.leaseOffers,selectedMileage:this.getSelectedAnnualMileage(),selectedTerm:this.getSelectedNumberOfMonth(),selectedDownPayment:b,selectedTradeIn:f,vehicle:a,zipCode:g,incentives:d},{visitorId:o,pageName:r,venomVersion:l,isPurchase:!1,isNonTMVDealer:c})||{},y=Object(K.f)(v);this.setEligibleConditionalIncentives(y);const C=m()(a,"prices"),S=C.tmv,T=C.displayPrice,I=y.paymentWithoutTaxes.baseMonthlyPayment,N=y.paymentWithTaxes.monthlyPayment,_=y.dueAtSigning,O=y.securityDeposit,P=y.term,A=y.annualMileage,V=y.priceCost,x=y.incentives,w=y.limitCriteria,R=Object(k.a)(y,["paymentWithoutTaxes","paymentWithTaxes","dueAtSigning","securityDeposit","term","annualMileage","priceCost","incentives","limitCriteria"]);this.isInitialLoading&&(p(re.b.SELECTED_LEASE_INCENTIVES({vin:u}),re.a,{vin:u,incentives:x}),this.setState({checkedLeaseIncentives:x})),await p(re.b.TOTAL_MONTHLY_PAYMENT({vin:u}),re.a,N);const M=m()(y,"paymentWithTaxes.capitalizedFees",{}),j=m()(y,"paymentWithTaxes.capitalizedTaxes",{}),D=M.combinedFees,L=j.combinedSalesTax,F=S||T,U=this.state.limitCriteria,q=m()(a,"type");this.limitMessages=Object(X.c)(w,q),Object(K.k)({cur:{limitCriteria:w},prev:{limitCriteria:U}},[oe.ab,oe.Z],oe.g);const z=Object(K.f)(v,!0),B=Object(i.a)({},z,{updatedDate:Date.now(),isPurchase:!1});this.setState({type:q,price:F,numberOfMonths:P,annualMileage:A,downPaymentDetails:{monthly:N,dueAtSigning:_,securityDeposit:O},monthly:I,dueAtSigning:_,securityDeposit:O,taxes:Object(i.a)({},j,{totalTaxes:L}),fees:Object(i.a)({},M,{totalFees:D}),totalTaxesAndFees:D+L,monthlyWithTaxes:N,totalLeaseCost:N*(P-1)+_,netCapCost:V,appliedLeaseIncentives:x||[],calculatedOffer:B},()=>this.fireCalculatorPaymentsChangeEvent(Object(i.a)({},R,{downPayment:b,tradeIn:f}),w)),n(h?N:I,"lease"),s({lease:{term:this.getSelectedNumberOfMonth(),downPayment:b,annualMileage:this.getSelectedAnnualMileage(),tradeIn:f,monthlyPayment:I,calculatedOffer:B,creditScore:this.state.creditScore,customVehiclePrice:E||"",widgetMonthlyPayment:m()(z,"paymentWithoutTaxes.baseMonthlyPayment"),storedSelections:this.storage.get(ce.y.LEASE_PREFERENCES)||{}}}),St()(s,"flush")}catch(t){this.showError(t,e)}}}),this.limitMessages={},this.showError=((e,t)=>{const a=this.props,s=a.onSelectionUpdate;(0,a.onMonthlyPaymentUpdate)(oe.db,"lease"),s({lease:{term:null,downPayment:null,annualMileage:null,tradeIn:null,monthlyPayment:null,creditScore:null,calculatedOffer:null,widgetMonthlyPayment:null,storedSelections:null}}),"boolean"==typeof t&&t&&Object(G.a)("error",`Get lease payments error - ${"string"==typeof e?e:e.message}`)}),this.fireCalculatorPaymentsChangeEvent=((e,t)=>{const a=this.props,s=a.payments.vin,n=a.creativeId,r=this.state,l=r.appliedLeaseIncentives,o=r.creditScore;Z.a.fireCustomEvent(de.a.CALCULATE_PAYMENT,{vin:s,type:oe.g,creativeId:n,payments:Object(i.a)({creditScore:o,term:this.getSelectedNumberOfMonth(),primaryIncentiveAmount:Object(Tt.e)(l),annualMileage:this.getSelectedAnnualMileage()},e),limitCriteria:t})}),this.changeState=(e=>{let t=e.value,a=e.name;const s=this.props.updateGetThisDealBtn;if(this.state[a]===t)return null;if(a===oe.t&&(t?this.resetAppliedIncentives(t):s(!1)),!Object(K.j)(a)){const e={[a]:t};return this.setState(()=>Object(i.a)({},e),()=>{(0,this.props.clearMMYFromStorage)(),this.storage.set(ce.y.LEASE_PREFERENCES,Object(i.a)({},this.storage.get(ce.y.LEASE_PREFERENCES),e,{isUsed:!1})),Ot.includes(a)&&this.calculateOffer()})}return this.props.onSharedInputUpdate(a,t,oe.h),null}),this.resetAppliedIncentives=(()=>{const e=this.props,t=e.vin,a=e.setModelValue,s=e.selectedLeaseIncentives,i=e.selectedLoanIncentives,n=e.updateGetThisDealBtn;if(i){const e=i.filter(e=>{return e.primary})||[];a(re.b.SELECTED_LOAN_INCENTIVES({vin:t}),re.a,{vin:t,incentives:e})}if(s){const e=s.filter(e=>{return!e.conditionCategory})||[];a(re.b.SELECTED_LEASE_INCENTIVES({vin:t}),re.a,{vin:t,incentives:e})}a(re.b.RESET_CUSTOM_VEHICLE_PRICE({vin:t}),re.a,!1),n(!0)}),this.config={termsMapping:{},mileagesMapping:{}},this.storage=new W.a("localStorage");const t=!this.props.useDefaults&&this.storage.get(ce.y.LEASE_PREFERENCES)||{},a=t.tradeIn,s=t.downPayment,n=t.creditScore,r=t.annualMileage,l=t.numberOfMonths;this.tradeInFromStorage=a,this.downPaymentFromStorage=s,this.state={price:null,downPaymentDetails:null,monthly:null,taxes:null,fees:null,totalTaxesAndFees:null,monthlyWithTaxes:null,dueAtSigning:null,totalLeaseCost:null,customZipCode:e.zipCode,limitCriteria:{},checkedLeaseIncentives:[],creditScore:n&&n>oe.q[oe.p].max?n:oe.q[oe.l].leaseValue,annualMileage:r||null,numberOfMonths:l||null}}async componentDidMount(){return this.props.vehicle&&this.props.dealerMapping?(this.leaseOffers||await this.getLeaseOffers(),this.calculateOffer(!0)):null}async componentDidUpdate(e,t){const a=this.props,s=a.resetCustomVehiclePrice,i=a.updateGetThisDealBtn,n=a.onSharedInputUpdate,r=m()(e.vehicle,"vin")&&m()(this.props.vehicle,"vin")!==m()(e.vehicle,"vin"),l=t.creditScore!==this.state.creditScore;if((r||l)&&(this.leaseOffers=null),!e.vehicle&&this.props.vehicle||!e.dealerMapping&&this.props.dealerMapping||!t.customZipCode&&this.state.customZipCode||t.customZipCode!==this.state.customZipCode||!Y()(e.styleLeaseTerms,this.props.styleLeaseTerms)||r||l)return this.leaseOffers||await this.getLeaseOffers(),this.calculateOffer(!0);const o=m()(e,"selectedLeaseIncentives"),c=!De()(yt()(this.props.selectedLeaseIncentives,o,Y.a));return e.resetCustomVehiclePrice!==s&&s&&(i(!1),n(oe.t,"")),c&&(this.isInitialLoading?(this.isInitialLoading=!1,De()(yt()(this.props.selectedLeaseIncentives,this.state.checkedLeaseIncentives,Y.a))||this.getLeaseOffers()):this.getLeaseOffers()),oe.tb.some(t=>e.payments[t]!==this.props.payments[t])?this.calculateOffer():null}async getOffers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=this.props,a=t.dealerMapping,s=t.vehicle,n=t.pageName,r=t.venomVersion,l=t.visitorId,o=t.styleLeaseTerms,c=t.payments.customSellingPrice,d=s.dealerInfo.address.zip,p=s.vehicleInfo,u=p.styleInfo.styleId,h=p.mileage,g=s.vin,b=o?{annualMileage:o}:null,f=g===A.d?b:await Object(me.b)({creditScore:this.state.creditScore,isLeaseLiteEnabled:!!m()(a,"leaseLite"),styleId:u,vin:g,zipCode:d,mileage:h,filteredIncentives:e},{visitorId:l,pageName:n,venomVersion:r,isPurchase:!1});return f&&c&&(f.annualMileage=Object.entries(f.annualMileage).reduce((e,t)=>{let a=Object(w.a)(t,2),s=a[0],n=a[1];return e[s]=n.map(e=>Object(i.a)({},e,{sellingPrice:c})),e},{})),f}getSelectedAnnualMileage(){return Number(this.config.mileagesMapping[this.state.numberOfMonths]?this.state.annualMileage:this.defaultLeaseOffer.annualMileage)}getSelectedNumberOfMonth(){return Number(this.config.termsMapping[this.state.annualMileage]?this.state.numberOfMonths:this.defaultLeaseOffer.term)}setEligibleConditionalIncentives(e){const t=this.props,a=t.storedConditionalLeaseIncentives,s=t.setModelValue,i=t.vin,n=m()(e,"incentives",[]),r=n?n.filter(e=>!e.conditionCategory):[],l=a?a.filter(e=>!Object(te.p)(r,e,!0)):[];s(re.b.CONDITIONAL_LEASE_INCENTIVES_ELIGIBLE({vin:i}),re.a,{vin:i,incentives:l})}render(){const e=this.state,t=e.numberOfMonths,a=e.annualMileage,s=e.customZipCode,n=e.appliedLeaseIncentives,r=this.getSharedSelections(),l=r.tradeIn,o=r.downPayment,c=r.customVehiclePrice,d=this.state,p=d.creditScore,m=Object(k.a)(d,["creditScore"]);return E.a.createElement("div",null,E.a.cloneElement(this.props.children,{payments:Object(i.a)({},m,{tradeIn:l,downPayment:o,customVehiclePrice:c}),onChange:this.changeState,enabledTerms:this.config.termsMapping[a],enabledMileages:this.config.mileagesMapping[t],appliedLeaseIncentives:n,creditScore:Object(K.e)(p),setZipToStorage:this.setZip,taxesAndFeesZipCode:s,limitMessages:this.limitMessages}))}}Pt.propTypes={setModelValue:y.a.func.isRequired,children:y.a.node.isRequired,dealerMapping:pe.f,onSharedInputUpdate:y.a.func,payments:y.a.shape({downPayment:y.a.oneOfType([y.a.string,y.a.number]),tradeIn:y.a.oneOfType([y.a.string,y.a.number]),customVehiclePrice:y.a.oneOfType([y.a.string,y.a.number])}).isRequired,creativeId:y.a.string.isRequired,onMonthlyPaymentUpdate:y.a.func,onSelectionUpdate:y.a.func,vehicle:A.b.InventoryVin,zipCode:y.a.string.isRequired,setZip:y.a.func,isNonTMVDealer:y.a.bool,clearMMYFromStorage:y.a.func,storedIncentives:y.a.shape({}),vin:y.a.string.isRequired,selectedLeaseIncentives:y.a.arrayOf(pe.j),selectedLoanIncentives:y.a.arrayOf(pe.j),storedConditionalLeaseIncentives:y.a.arrayOf(pe.j),updateGetThisDealBtn:y.a.func,resetCustomVehiclePrice:y.a.bool,styleLeaseTerms:y.a.objectOf(y.a.arrayOf(pe.h)),usePaymentWithTaxesAndFeesForTabs:y.a.bool,useDefaults:y.a.bool},Pt.defaultProps={vehicle:null,onMonthlyPaymentUpdate:r.a,onSharedInputUpdate:r.a,onSelectionUpdate:r.a,dealerMapping:null,setZip:r.a,isNonTMVDealer:!1,clearMMYFromStorage:r.a,storedIncentives:{},selectedLeaseIncentives:[],selectedLoanIncentives:[],storedConditionalLeaseIncentives:[],updateGetThisDealBtn:null,resetCustomVehiclePrice:!1,styleLeaseTerms:null,usePaymentWithTaxesAndFeesForTabs:!1,useDefaults:!1};const At={zipCode:Object(se.a)(re.b.STORED_ZIP_CODE,_t.c),visitorId:Object(se.a)("id",_t.c),pageName:Object(se.a)("page.name",ne.a),venomVersion:Object(se.a)("version",ie.a),storedIncentives:Object(se.a)(re.b.SELECTED_INCENTIVES,re.a),storedConditionalLeaseIncentives:Object(se.a)(re.b.CONDITIONAL_LEASE_INCENTIVES,re.a),selectedLeaseIncentives:Object(se.a)(re.b.SELECTED_LEASE_INCENTIVES,re.a),selectedLoanIncentives:Object(se.a)(re.b.SELECTED_LOAN_INCENTIVES,re.a),resetCustomVehiclePrice:Object(se.a)(e=>{let t=e.vin;return t?re.b.RESET_CUSTOM_VEHICLE_PRICE({vin:t}):null},re.a),styleLeaseTerms:Object(se.a)(e=>{let t=e.vin,a=e.vehicle;return t===A.d&&re.b.STYLE_LEASE_TERMS({styleId:m()(a,"vehicleInfo.styleInfo.styleId","")})},re.a),dealerMapping:Object(se.a)(e=>{let t=e.vin,a=e.vehicle;return t&&a&&re.b.DEALER_MAPPING({vin:t,id:m()(a,"dealerInfo.franchiseId")})},re.a)},Vt=Object(se.b)(Pt,At);a("./site-modules/shared/components/calculator/lease-calculator-form/lease-calculator-form.scss");const xt=["annualMileage","numberOfMonths","downPayment","tradeIn","monthly","monthlyWithTaxes","totalTaxesAndFees","taxes","fees","totalLeaseCost","dueAtSigning","netCapCost","downPaymentDetails","customVehiclePrice"],kt=[{label:"First Month's Payment w/ Taxes and Fees",value:"monthly",sign:"+"},{label:"Security Deposit",value:"securityDeposit",sign:"+"},{label:"Total Due At Signing",value:"dueAtSigning",sign:"="}];class wt extends f.Component{constructor(){var e;e=super(...arguments),this.state={tradeInValidationErrorMsg:"",appliedTradeInMessage:"",tradeInValue:0,amountLimit:0,appliedTradeIn:0},this.isTradeInUpdated=!1,this.handleInputChange=(async e=>{const t=Object(X.a)(e),a=t.value,s=t.name;if(s===oe.yb){this.isTradeInUpdated=!0;const e=await this.calculateLimits(a);this.handleUpdateTradeIn(e,a,!0)}else this.props.onChange({value:a,name:s})}),this.calculateLimits=(e=>{const t=this.props,a=t.msrp,s=t.taxesAndFeesZipCode,i=t.styleId,n=t.pageName,r=t.venomVersion,l=t.vehiclePrice,o=t.residual;return Object(K.a)({msrp:a,salesPrice:l,residual:o,styleId:i,zipCode:s,tradeIn:e,pageName:n,venomVersion:r})}),this.handleUpdateTradeIn=function(t,a){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=Object(K.i)(m()(t,"limitCriteria",{}),Me.a.NEW).tradeInValidationError,n=Object(K.d)(t,oe.ab)||a,r=a<0?oe.fb:"";s?e.setState({tradeInValue:a,amountLimit:n,tradeInValidationErrorMsg:i?`${i} ${r}`:""},()=>{e.isTradeInUpdated=!1,i||(e.updateAppliedTradeIn(),e.props.onChange({value:a,name:oe.yb}))}):e.setState({tradeInValue:a,tradeInValidationErrorMsg:"",appliedTradeIn:n,appliedTradeInMessage:`${i} ${r}`},()=>{e.isTradeInUpdated=!1})},this.handleApplyTradeIn=(()=>{const e=this.state,t=e.tradeInValue,a=e.amountLimit,s=e.tradeInValidationErrorMsg;this.setState({tradeInValidationErrorMsg:"",appliedTradeIn:a,appliedTradeInMessage:s}),this.props.onChange({value:t,name:oe.yb})}),this.updateAppliedTradeIn=(()=>{const e=this.state.amountLimit;this.setState({appliedTradeIn:e,appliedTradeInMessage:e<0?oe.fb:""})}),this.handleKeyPress=(e=>{Object(X.b)(e)&&e.currentTarget.blur()}),this.handleCreditScoreChange=(e=>{const t=m()(e,"currentTarget.value",oe.l),a={value:oe.q[t].leaseValue,name:oe.o};this.props.onChange(a)}),this.handleCreditScoreEnterPress=(e=>{Object(X.b)(e)&&this.handleCreditScoreChange(e)})}shouldComponentUpdate(e,t){const a=this.props,s=a.payments,i=a.limitMessages,n=a.appliedLeaseIncentives,r=a.taxesAndFeesZipCode,l=a.creditScore,o=a.internalDrawerConfig,c=this.state,d=c.tradeInValue,p=c.tradeInValidationErrorMsg,m=e.payments,u=e.limitMessages,h=e.appliedLeaseIncentives,g=e.taxesAndFeesZipCode,b=e.internalDrawerConfig,f=e.creditScore;return!(Y()(B()(m,xt),B()(s,xt))&&Y()(u,i)&&Y()(h,n)&&Y()(b,o)&&r===g&&f===l&&t.tradeInValue===d&&t.tradeInValidationErrorMsg===p)}async componentDidUpdate(){const e=this.props.payments,t=this.state.tradeInValue,a=m()(e,oe.yb);if(a!==t&&!this.isTradeInUpdated){this.isTradeInUpdated=!0;const e=await this.calculateLimits(a);this.handleUpdateTradeIn(e,a)}return null}render(){const e=this.props,t=e.payments,a=e.vehiclePrice,n=e.onTradeInClick,r=e.enabledTerms,l=e.enabledMileages,o=e.creditScore,c=e.limitMessages,p=e.appliedLeaseIncentives,m=e.taxesAndFeesZipCode,u=e.setZipToStorage,h=e.styleId,g=e.leasePromiseEndDate,b=e.isNonTMVDealer,f=e.appraisalMMYLabel,v=e.vin,y=e.vehicle,C=e.onChange,S=e.internalDrawerConfig,T=e.vehiclePriceProps,I=e.paymentInputProps,N=e.radioGroupProps,_=e.hideTaxesFeesSection,O=this.state,P=O.tradeInValidationErrorMsg,A=O.appliedTradeIn,V=O.appliedTradeInMessage,x=t.numberOfMonths,k=t.downPayment,w=t.downPaymentDetails,R=t.tradeIn,M=t.annualMileage,j=t.monthly,D=t.type,L=t.calculatedOffer,F=t.customVehiclePrice,U=d()(j),q=b?[]:p,z=Object(K.g)({payments:t,taxesAndFeesZipCode:m,calculatorType:oe.g,type:D,additionalTooltipContent:"",incentives:q,creditTier:oe.k.find(e=>{return e.name===o})||{name:o}});return E.a.createElement(Pe.a,{className:"lease-calculator-form p-0_75",id:"lease-calc",noValidate:!0},U&&E.a.createElement("p",{className:"not-available-text"},"Please contact dealer for current lease programs and payment estimates."),!!a&&!U&&E.a.createElement(Ve.a,{className:"mb-1_5"},E.a.createElement(Re.a,Object(s.a)({vin:v,vehicle:y,internalDrawerConfig:S,price:a,calculatorType:oe.g,appliedIncentives:q,additionalTooltipContent:"",isNonTMVDealer:b,calculatedOffer:L,onChange:C,customVehiclePrice:F,paymentInputProps:I},T))),E.a.createElement(Ve.a,{className:"mb-1_5"},E.a.createElement(ke.a,Object(s.a)({trackingId:"select_lease_payment_term",onClick:this.handleInputChange,onKeyPress:this.handleKeyPress,values:r||oe.V,name:oe.eb,title:oe.X.TERM_TITLE,selected:d()(x)?0:x},N))),E.a.createElement(Ve.a,{className:"mb-1_5"},E.a.createElement(ke.a,Object(s.a)({trackingId:"select_mileage",onClick:this.handleInputChange,onKeyPress:this.handleKeyPress,values:l||oe.U,name:"annualMileage",title:oe.X.ANNUAL_MILES_TITLE,selected:d()(M)?0:M,tooltip:oe.wb.ANNUAL_MILES,id:"leaseAnnualMileage"},N))),E.a.createElement(Ve.a,{className:"mb-1_5 pos-r"},E.a.createElement(xe.a,Object(s.a)({name:oe.Y,label:oe.X.TRADE_IN_TITLE,appraisalMMYLabel:f,trackingId:"select_trade_in_value",key:R,value:d()(R)?0:Object(mt.c)(R),tooltip:oe.wb.TRADE_IN,onKeyPress:this.handleKeyPress,onBlur:this.handleInputChange,inputMode:null,isCurrency:!0,paymentInputClassNames:P?"is-invalid":"",inputType:""},I),E.a.createElement(gt,{appraisalMMYLabel:f,onClick:n})),P&&E.a.createElement(bt.a,{tradeInValidationError:P,onApplyTradeIn:this.handleApplyTradeIn,calculator:oe.i})),E.a.createElement(Ve.a,{className:"mb-1_25"},E.a.createElement(xe.a,Object(s.a)({name:oe.S,label:oe.X.DOWN_PAYMENT_TITLE,trackingId:"select_lease_down_payment",key:k,value:d()(k)?0:Object(mt.c)(k),tooltip:oe.wb.DOWN_PAYMENT,onKeyPress:this.handleKeyPress,onBlur:this.handleInputChange,limitMessage:c[oe.Z],isCurrency:!0,disallowNegative:!0,inputType:""},I)),!De()(w)&&E.a.createElement("div",{className:"text-gray medium pl-0_75 pt-0_75"},kt.map(e=>{const t=e.sign,a=e.value,s=e.label;return E.a.createElement("div",{key:s},t," ",Object(Ue.a)(w[a])," ",s)}))),E.a.createElement(Ve.a,{className:"mb-0_5"},E.a.createElement(we.a,{id:"leaseCreditScore",title:oe.X.CREDIT_SCORE_TITLE,tooltip:oe.wb.CREDIT_SCORE,selected:o,values:[Object(i.a)({},oe.k[0],{disabled:!0}),...oe.k.slice(1)],onClick:this.handleCreditScoreChange,onKeyPress:this.handleCreditScoreEnterPress})),!U&&!_&&E.a.createElement(Ve.a,{className:"mb-0_75"},E.a.createElement(nt,{calculatorType:oe.g,payments:t,taxesAndFeesZipCode:m,setZipToStorage:u,appliedTradeIn:A,tradeInValidationErrorMsg:V})),E.a.createElement(dt,{openedForm:oe.g,leasePromiseEndDate:g,isTaxesAndFeesAvailable:!!h&&!_,payments:t,noPadding:!0}),E.a.createElement(pt.a,{paramsData:z,linkClassName:"align-middle text-decoration-none-hover text-primary-darker",iconClassName:"icon-notification2 mr-0_5 text-gray-darker",trackingId:"payment_feedback",trackingValue:"payment feedback",title:"Payment feedback",form:"payment-feedback"}))}}wt.propTypes={vehiclePrice:y.a.number,vehicle:A.b.InventoryVin,payments:y.a.shape({numberOfMonths:y.a.oneOfType([y.a.number,y.a.string]),tradeIn:y.a.oneOfType([y.a.number,y.a.string]),downPayment:y.a.oneOfType([y.a.number,y.a.string]),downPaymentDetails:y.a.shape({monthly:y.a.oneOfType([y.a.number,y.a.string]),dueAtSigning:y.a.oneOfType([y.a.number,y.a.string]),securityDeposit:y.a.oneOfType([y.a.number,y.a.string])}),annualMileage:y.a.oneOfType([y.a.number,y.a.string]),calculatedOffer:pe.a,customVehiclePrice:y.a.oneOfType([y.a.number,y.a.string])}),onChange:y.a.func,onTradeInClick:y.a.func,enabledTerms:y.a.arrayOf(y.a.number),enabledMileages:y.a.arrayOf(y.a.number),creditScore:y.a.string,limitMessages:y.a.shape({}),appliedLeaseIncentives:y.a.arrayOf(y.a.oneOfType([P.b.Incentive,A.b.Incentive])),taxesAndFeesZipCode:y.a.string,setZipToStorage:y.a.func,styleId:y.a.string,leasePromiseEndDate:y.a.number,isNonTMVDealer:y.a.bool,appraisalMMYLabel:y.a.string,vin:y.a.string.isRequired,msrp:y.a.number,residual:y.a.number,venomVersion:y.a.string,pageName:y.a.string,paymentInputProps:y.a.shape({}),radioGroupProps:y.a.shape({}),hideTaxesFeesSection:y.a.bool,internalDrawerConfig:y.a.shape({onToggle:y.a.func,portalSelector:y.a.string,openedDrawer:y.a.string}),vehiclePriceProps:y.a.shape({customLabel:y.a.string,customTooltip:y.a.func,hideDescription:y.a.bool,isReadOnly:y.a.bool})},wt.defaultProps={payments:{},vehicle:{},onChange:null,vehiclePrice:null,onTradeInClick:null,enabledTerms:null,enabledMileages:null,limitMessages:{},creditScore:"",taxesAndFeesZipCode:"",setZipToStorage:null,appliedLeaseIncentives:[],leasePromiseEndDate:null,styleId:null,isNonTMVDealer:!1,appraisalMMYLabel:"",msrp:0,residual:0,venomVersion:"",pageName:"",internalDrawerConfig:null,vehiclePriceProps:null,paymentInputProps:null,radioGroupProps:null,hideTaxesFeesSection:!1};a("./site-modules/shared/components/calculator/toggle-button/toggle-button.scss");function Rt(e){let t=e.activeClass,a=e.inactiveClass,s=e.trackingId,i=e.value,n=e.name,r=e.isOpen,l=e.onClick,o=e.type,c=e.initialLoading,d=e.creativeId,p=e.ignoreTabFocus;return E.a.createElement(ht.a,{"data-tracking-id":s,"data-tracking-value":i,"data-test-value":`Est. ${n}: $${Math.floor(i)}/mo*`,name:n,onClick:l,size:"responsive",className:_()("toggle-button px-1 w-100",n,{[t]:r,[`${a} inactive`]:!r}),tabIndex:p?-1:void 0},E.a.createElement("div",{className:"payments d-flex justify-content-center flex-column"},E.a.createElement("span",{className:"text-capitalize text-gray small"},"Est. ",n,":"),E.a.createElement("h3",{className:"payments-value heading-2 mb-0 text-lowercase"},E.a.createElement(Ze,{price:i,type:o,disclaimerSymbol:"*",monthsClasses:"small",priceClasses:"",initialLoading:c,creativeId:d,allowNegative:!0}))))}Rt.propTypes={trackingId:y.a.string.isRequired,value:y.a.oneOfType([y.a.string,y.a.number]).isRequired,name:y.a.string.isRequired,isOpen:y.a.bool.isRequired,onClick:y.a.func.isRequired,type:y.a.string.isRequired,activeClass:y.a.string,inactiveClass:y.a.string,initialLoading:y.a.bool,ignoreTabFocus:y.a.bool,creativeId:y.a.string},Rt.defaultProps={initialLoading:!1,ignoreTabFocus:!1,activeClass:"bg-gray-extra-light",inactiveClass:"bg-white",creativeId:""};var Mt=a("./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser-drawer.jsx"),jt=a("./site-modules/shared/components/appraisal/trade-in-appraiser/trade-in-appraiser.jsx"),Dt=a("./data/models/dealer-info.js"),Lt=a("./tracking/handler.js"),Ft=a("./engagement-handlers/index.js"),Ut=a("./engagement-handlers/calculator-engagement-handler/calculator-engagement-handler.js"),qt=a("./site-modules/shared/components/portal/portal.jsx");a("./site-modules/shared/components/calculator/payment-calculator/payment-calculator.scss");a.d(t,"a",function(){return Yt});const zt="vdp-appraisal-drawer",Bt=700,$t=["make","model","year"];Ft.a.register(Ut.a);class Yt extends f.Component{constructor(e){var t;t=super(e),this.setWrapperRef=(e=>{this.wrapper=e}),this.setShouldRecalculateValue=(e=>{let t=e.shouldRecalculate,a=t.name,s=t.value;this.setState(e=>({shouldRecalculate:Object(i.a)({},e.shouldRecalculate,{[a]:s})}))}),this.setAppraisalMMYLabel=(()=>{const e=!this.props.useDefaults&&this.storage.get(ce.y.LOAN_PREFERENCES)||{},t=e.make,a=e.model,s=e.year,i=t&&a&&s?`Your ${s} ${t} ${a}`:"";this.setState(()=>({appraisalMMYLabel:i}))}),this.setCalculatorChangeObserverState=(()=>{const e=this.state.selection,t=this.props.openedForm,a=m()(e,`${t}.monthlyPayment`),s=this[`${t}ChangeObserver`].prevMonthlyPayment;d()(a)?this[`${t}ChangeObserver`]={isChangedByUser:!1,prevMonthlyPayment:1}:a&&a!==s&&(this[`${t}ChangeObserver`]={isChangedByUser:!!s,prevMonthlyPayment:a});const i=t===oe.g?oe.h:oe.g,n=m()(e,`${i}.monthlyPayment`);!this[`${i}ChangeObserver`].prevMonthlyPayment&&n&&(this[`${i}ChangeObserver`].prevMonthlyPayment=n)}),this.clearMMYFromStorage=(()=>{const e=this.storage.get(ce.y.LOAN_PREFERENCES),t=this.storage.get(ce.y.LEASE_PREFERENCES);this.storage.set(ce.y.LOAN_PREFERENCES,h()(e,$t)),this.storage.set(ce.y.LEASE_PREFERENCES,h()(t,$t)),this.setState(()=>({appraisalMMYLabel:""}))}),this.firePrepopulateTradeInPixel=(()=>{const e=(this.storage.get(ce.y.LEASE_PREFERENCES)||{}).tradeIn;e&&e!==oe.I&&Lt.a.fireEvent("prepopulate_trade_in_value",{event_data:{value:e,action_category:"system",action_cause:"page_load","creative-id":this.props.creativeId}})}),this.updateSelection=b()(e=>this.setState(t=>({selection:Object(i.a)({},t.selection,e)}),()=>{const e=this.props.onPaymentsUpdate;if(e&&"function"==typeof e){const t=this.state.selection,a=t.loan,s=t.lease;this.setCalculatorChangeObserverState(),e({loan:Object(i.a)({},a,{isChanged:this.loanChangeObserver.isChangedByUser}),lease:Object(i.a)({},s,{isChanged:this.leaseChangeObserver.isChangedByUser})})}}),Bt),this.updateSelectionValue=function(e,a,s,n){let r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const l=!s||s===oe.g,c=!s||s===oe.h,d={},p=m()(r,[oe.c]),u=m()(r,[oe.kb]);e===oe.yb&&(d[oe.c]=o()(p)?p:a),o()(u)&&(d[oe.kb]=u),t.storage.set(ce.y.LOAN_PREFERENCES,Object(i.a)({},t.storage.get(ce.y.LOAN_PREFERENCES),d,{[e]:a,isUsed:!1})),t.storage.set(ce.y.LEASE_PREFERENCES,Object(i.a)({},t.storage.get(ce.y.LEASE_PREFERENCES),d,{[e]:a,isUsed:!1})),t.setState(t=>({selection:Object(i.a)({},t.selection,{[e]:a}),shouldRecalculate:{[oe.g]:l,[oe.h]:c}})),n?t.setAppraisalMMYLabel():t.clearMMYFromStorage()},this.toggleCalculators=(e=>{const t=e.currentTarget.getAttribute("name");if(this.props.openedForm!==t){const e=this.props.onCalculatorToggle;e&&"function"==typeof e&&e(t)}}),this.toggleAppraisalDrawer=(()=>{this.setState(e=>({isAppraisalDrawerOpen:!e.isAppraisalDrawerOpen}),()=>{const e=this.state.isAppraisalDrawerOpen,t=this.props.internalDrawerConfig;e&&Object(x.b)(V.b.ACTION_APPRAISE_VEHICLE,V.b.VIEW_APPRAISAL_FORM,this.props.creativeId,"action_start",!0,"What's my car worth?"),t&&t.onToggle(e?oe.e.APPRAISER:oe.e.CALCULATOR)})}),this.updateMonthlyPayment=((e,t)=>{this.setState(a=>({monthlyPayments:Object(i.a)({},a.monthlyPayments,{[t]:e}),initialLoading:Object(i.a)({},a.initialLoading,{[t]:!1})}))}),this.storage=new W.a("localStorage"),this.state={monthlyPayments:{[oe.g]:0,[oe.h]:0},initialLoading:{[oe.g]:!0,[oe.h]:!0},selection:{},isAppraisalDrawerOpen:!1,shouldRecalculate:{[oe.g]:!1,[oe.h]:!1},appraisalMMYLabel:""},this.loanChangeObserver={isChangedByUser:!1,prevMonthlyPayment:null},this.leaseChangeObserver={isChangedByUser:!1,prevMonthlyPayment:null}}componentDidMount(){this.setAppraisalMMYLabel(),this.firePrepopulateTradeInPixel()}componentDidUpdate(e){const t=this.props.internalDrawerConfig,a=this.state.isAppraisalDrawerOpen;Object(te.q)(e.internalDrawerConfig,t,a,oe.e.APPRAISER)&&this.toggleAppraisalDrawer()}render(){const e=this.state,t=e.monthlyPayments,a=e.selection,n=e.isAppraisalDrawerOpen,r=e.appraisalMMYLabel,l=e.initialLoading,o=this.props,c=o.disclaimerSymbol,d=o.wrapperClasses,p=o.calculationClasses,u=o.toggleBtnGroupClasses,g=o.activeClass,b=o.inactiveClass,f=o.showTabs,v=o.payments,y=o.baseCreditScore,C=o.onCreditScoreChange,T=o.sellYourCarConfig,N=o.appliedIncentives,P=o.setZipToStorage,A=o.isLoanTaxesAndFeesEnabled,V=o.isNonTMVDealer,x=o.openedForm,k=o.unselectFinancingPromotions,w=o.baseTermMonths,R=o.baseAPR,M=o.vinData,j=o.useBestPaymentService,D=o.dealerZipCode,L=o.venomVersion,F=o.pageName,U=o.updateGetThisDealBtn,q=o.internalDrawerConfig,z=o.useDefaults,B=o.vehiclePriceProps,$=o.creativeId,Y=o.paymentInputProps,H=o.radioGroupProps,Z=o.hideTaxesFeesSection,G=o.usePaymentWithTaxesAndFeesForTabs,W=v.vin,Q=v.type,X=v.leasePrice,ee=v.price,te=v.taxesAndFeesZipCode,ae=v.styleId,se=v.leasePromiseEndDate,ie=v.tmv,ne=Object(K.b)(Q),re=-1!==ne.indexOf(oe.h),le=-1!==ne.indexOf(oe.g),ce=re&&le,de=x===oe.h,pe=x===oe.g,me=1===ne.length,ue=h()(a,["lease","loan"]),he=Object(i.a)({},v,{price:X},ue),ge=m()(M,"prices.displayPrice",0),be=m()(a,"lease.calculatedOffer.residual"),fe=!Object(J.a)(m()(M,"type")),Ee={onClick:this.toggleCalculators,disclaimerSymbol:c,activeClass:g,inactiveClass:b,ignoreTabFocus:me};return E.a.createElement(O.Element,{name:oe.ib,className:_()("payment-calculator container",d),ref:this.setWrapperRef},f&&E.a.createElement(S.a,{className:u},re&&E.a.createElement(I.a,{xs:ce?"6":"12",className:"px-0"},E.a.createElement(Rt,Object(s.a)({},Ee,{name:oe.h,trackingId:de?"click_close_loan_calculator":"click_edit_loan_payment",value:t[oe.h],isOpen:de,type:oe.h,initialLoading:l[oe.h]}))),le&&E.a.createElement(I.a,{xs:ce?"6":"12",className:"px-0"},E.a.createElement(Rt,Object(s.a)({},Ee,{name:oe.g,trackingId:pe?"click_close_lease_calculator":"click_edit_lease_payment",value:t[oe.g],isOpen:pe,type:oe.g,initialLoading:l[oe.g],creativeId:$})))),E.a.createElement(S.a,{className:p},E.a.createElement(I.a,{className:"px-0"},re&&E.a.createElement("div",{className:_()({"hidden-xs-up":!de})},j?E.a.createElement(_e,{onMonthlyPaymentUpdate:this.updateMonthlyPayment,onSelectionUpdate:this.updateSelection,onSharedInputUpdate:this.updateSelectionValue,offer:v,selections:ue,isTaxesAndFeesEnabled:A,clearMMYFromStorage:this.clearMMYFromStorage,vin:W,dealerZipCode:D,updateGetThisDealBtn:U,creativeId:$,usePaymentWithTaxesAndFeesForTabs:G,useDefaults:z},E.a.createElement(Et,{vehicle:M,vehiclePrice:ee,appliedIncentives:N,onTradeInClick:this.toggleAppraisalDrawer,onCreditScoreChange:C,taxesAndFeesZipCode:te,setZipToStorage:P,styleId:ae,isNonTMVDealer:V,appraisalMMYLabel:r,msrp:ge,isUsed:fe,useBestPaymentService:j,venomVersion:L,pageName:F,internalDrawerConfig:q,vehiclePriceProps:B,paymentInputProps:Y,radioGroupProps:H,hideTaxesFeesSection:Z})):E.a.createElement(ve,{onMonthlyPaymentUpdate:this.updateMonthlyPayment,onRecalculationCall:this.setShouldRecalculateValue,onSelectionUpdate:this.updateSelection,onSharedInputUpdate:this.updateSelectionValue,baseAPR:R,baseTermMonths:w,unselectFinancingPromotions:k,baseCreditScore:y,offer:v,selections:ue,isTaxesAndFeesEnabled:A,clearMMYFromStorage:this.clearMMYFromStorage,vin:W,updateGetThisDealBtn:U,creativeId:$,usePaymentWithTaxesAndFeesForTabs:G,useDefaults:z,msrp:ge},E.a.createElement(Et,{vehicle:M,vehiclePrice:ee,appliedIncentives:N,onTradeInClick:this.toggleAppraisalDrawer,onCreditScoreChange:C,taxesAndFeesZipCode:te,setZipToStorage:P,styleId:ae,isNonTMVDealer:V,appraisalMMYLabel:r,msrp:ge,isUsed:fe,venomVersion:L,pageName:F,internalDrawerConfig:q,vehiclePriceProps:B,paymentInputProps:Y,radioGroupProps:H,hideTaxesFeesSection:Z}))),le&&E.a.createElement("div",{className:_()({"hidden-xs-up":!pe})},E.a.createElement(Vt,{onMonthlyPaymentUpdate:this.updateMonthlyPayment,onSelectionUpdate:this.updateSelection,onSharedInputUpdate:this.updateSelectionValue,vin:W,vehicle:M,payments:he,setZip:P,isNonTMVDealer:V,updateGetThisDealBtn:U,selections:ue,creativeId:$,usePaymentWithTaxesAndFeesForTabs:G,useDefaults:z},E.a.createElement(wt,{vehiclePrice:X||ie,onTradeInClick:this.toggleAppraisalDrawer,vin:W,vehicle:M,styleId:ae,leasePromiseEndDate:se,isNonTMVDealer:V,appraisalMMYLabel:r,msrp:ge,residual:be,venomVersion:L,pageName:F,internalDrawerConfig:q,vehiclePriceProps:B,paymentInputProps:Y,radioGroupProps:H,hideTaxesFeesSection:Z}))))),q?n&&E.a.createElement(qt.a,{selector:q.portalSelector},E.a.createElement(jt.TradeInAppraiser,{onDone:this.toggleAppraisalDrawer,onTradeInUpdate:this.updateSelectionValue,sellYourCarConfig:T,isPurchase:de,msrp:ge,sellingPrice:ee,residualValue:be,isUsed:fe,columnsSize:{xs:12,md:12,lg:12,xl:12}})):E.a.createElement(Mt.a,{isOpen:n,onToggle:this.toggleAppraisalDrawer,onTradeInUpdate:this.updateSelectionValue,trackingParent:zt,sellYourCarConfig:T,isPurchase:de,msrp:ge,sellingPrice:ee,residualValue:be,isUsed:fe}))}}Yt.propTypes={payments:y.a.shape({type:y.a.string.isRequired,vin:y.a.string.isRequired,taxesAndFeesZipCode:y.a.string}).isRequired,disclaimerSymbol:y.a.string,wrapperClasses:y.a.string,calculationClasses:y.a.string,toggleBtnGroupClasses:y.a.string,showTabs:y.a.bool,onPaymentsUpdate:y.a.func,onCalculatorToggle:y.a.func,baseCreditScore:y.a.string,onCreditScoreChange:y.a.func,sellYourCarConfig:Dt.e,setModelValue:y.a.func.isRequired,appliedIncentives:y.a.arrayOf(y.a.oneOfType([P.b.Incentive,A.b.Incentive])),internalDrawerConfig:y.a.shape({onToggle:y.a.func,portalSelector:y.a.string,openedDrawer:y.a.string}),vehiclePriceProps:y.a.shape({customLabel:y.a.string,customTooltip:y.a.func,hideDescription:y.a.bool,isReadOnly:y.a.bool}),setZipToStorage:y.a.func,dealerZipCode:y.a.string,isLoanTaxesAndFeesEnabled:y.a.bool,isNonTMVDealer:y.a.bool,unselectFinancingPromotions:y.a.func,baseAPR:y.a.number,baseTermMonths:y.a.number,vinData:A.b.InventoryVin,useBestPaymentService:y.a.bool,useDefaults:y.a.bool,venomVersion:y.a.string,pageName:y.a.string,updateGetThisDealBtn:y.a.func,creativeId:y.a.string,paymentInputProps:y.a.shape({}),radioGroupProps:y.a.shape({}),hideTaxesFeesSection:y.a.bool,usePaymentWithTaxesAndFeesForTabs:y.a.bool},Yt.defaultProps={disclaimerSymbol:"",wrapperClasses:"bg-gray-lightest",calculationClasses:"",toggleBtnGroupClasses:"",activeClass:"bg-gray-extra-light",inactiveClass:"bg-white",showTabs:!0,onPaymentsUpdate:null,onCalculatorToggle:null,baseCreditScore:"",onCreditScoreChange:null,vehiclePriceProps:null,sellYourCarConfig:{},appliedIncentives:[],setZipToStorage:null,internalDrawerConfig:null,dealerZipCode:"",isLoanTaxesAndFeesEnabled:!1,isNonTMVDealer:!1,useDefaults:!1,unselectFinancingPromotions:null,baseAPR:null,baseTermMonths:null,vinData:{},useBestPaymentService:!1,venomVersion:"",pageName:"",updateGetThisDealBtn:r.a,creativeId:oe.zb,paymentInputProps:null,radioGroupProps:null,hideTaxesFeesSection:!1,usePaymentWithTaxesAndFeesForTabs:!1}},"./site-modules/shared/components/calculator/radio-group/radio-group.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return b});var s=a("../node_modules/react/index.js"),i=a.n(s),n=a("../node_modules/prop-types/index.js"),r=a.n(n),l=a("../node_modules/classnames/index.js"),o=a.n(l),c=a("../node_modules/reactstrap/lib/Label.js"),d=a.n(c),p=a("../node_modules/reactstrap/lib/ButtonGroup.js"),m=a.n(p),u=a("../node_modules/reactstrap/lib/Button.js"),h=a.n(u),g=a("./site-modules/shared/components/tooltip-item/tooltip-item.jsx");a("./site-modules/shared/components/calculator/radio-group/radio-group.scss");function b(e){let t=e.onClick,a=e.onKeyPress,s=e.values,n=e.selected,r=e.trackingId,l=e.name,c=e.title,p=e.tooltip,u=e.id,b=e.className,f=e.buttonClassName,E=e.selectedValuePostfix,v=e.children;const y=Number(n)||n,C=e=>e===y;return i.a.createElement("div",{className:"radio-group"},c&&i.a.createElement(d.a,{className:"mb-1 d-flex justify-content-between"},i.a.createElement("span",null,c," ",p&&i.a.createElement(g.a,{id:u,item:p,className:"tooltip-text"})),E&&!s.includes(y)&&i.a.createElement("span",null,n," ",E)),v,i.a.createElement(m.a,{className:"d-flex justify-content-between","data-toggle":"buttons","aria-label":u||c},s.map(e=>i.a.createElement(h.a,{key:e,"data-tracking-id":r,"data-tracking-value":e,tabIndex:0,name:l,value:e,onClick:t,onKeyPress:a,size:"responsive",outline:!C(e),color:C(e)?"primary":"secondary",className:o()("radio-group-button w-100",{active:C(e)},{"bg-white text-gray-darker":!C(e)},f),"aria-label":`${c} ${e}`},i.a.createElement("span",{className:o()("font-weight-normal",b)},e)))))}b.propTypes={onClick:r.a.func.isRequired,onKeyPress:r.a.func.isRequired,values:r.a.arrayOf(r.a.oneOfType([r.a.number,r.a.string])).isRequired,selected:r.a.oneOfType([r.a.number,r.a.string]),name:r.a.string.isRequired,title:r.a.string,trackingId:r.a.string,id:r.a.string,children:r.a.node,tooltip:r.a.shape({text:r.a.string.isRequired,placement:r.a.string.isRequired}),className:r.a.string,buttonClassName:r.a.string,selectedValuePostfix:r.a.string},b.defaultProps={trackingId:"",title:"",id:"",tooltip:null,className:"",buttonClassName:null,selected:"",children:null,selectedValuePostfix:""}},"./site-modules/shared/components/calculator/taxes-and-fees/taxes-and-fees-utils.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return h});var s=a("../node_modules/lodash/isFinite.js"),i=a.n(s),n=a("../node_modules/lodash/get.js"),r=a.n(n),l=a("../node_modules/react/index.js"),o=a.n(l),c=a("../node_modules/classnames/index.js"),d=a.n(c),p=a("./site-modules/shared/utils/calculator/taxes-and-fees-helper.js"),m=a("./site-modules/shared/utils/price-utils.js"),u=a("./site-modules/shared/components/tooltip-item/tooltip-item.jsx");function h(e,t,a,s,n){const l=a.title,c=l.name,h=l.slug,g=l.isBold,b=l.notAvailableText,f=Object(p.c)(e,t,a,s,n),E=f.length;return o.a.createElement("div",{key:c},o.a.createElement("div",{className:"d-flex justify-content-between"},o.a.createElement("span",{className:d()("pb-1",{"font-weight-bold":g})},c),E?Object(m.a)(r()(t,h,0),2,2):p.a),o.a.createElement("ul",{className:"list-unstyled mb-0"},E?f.map(t=>{let a=t.name,s=t.slug,n=t.tooltip,r=t.itemValue;return o.a.createElement("li",{key:s,className:"d-flex justify-content-between"},o.a.createElement("span",{className:"pb-0_5"},a," ",n&&o.a.createElement(u.a,{id:`${e}${s}`,className:"tooltip-text",item:n}))," ",i()(r)?Object(m.a)(r,2,2):"not provided")}):o.a.createElement("li",null,b)))}},"./site-modules/shared/components/calendar/calendar.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return I});var s=a("../node_modules/lodash/isEmpty.js"),i=a.n(s),n=a("../node_modules/react/index.js"),r=a.n(n),l=a("../node_modules/prop-types/index.js"),o=a.n(l),c=a("../node_modules/classnames/index.js"),d=a.n(c),p=a("../node_modules/reactstrap/lib/Dropdown.js"),m=a.n(p),u=a("../node_modules/reactstrap/lib/DropdownMenu.js"),h=a.n(u),g=a("../node_modules/reactstrap/lib/DropdownToggle.js"),b=a.n(g),f=a("../node_modules/dateformat/lib/dateformat.js"),E=a.n(f),v=a("../node_modules/react-day-picker/DayPicker.js"),y=a.n(v),C=a("./site-modules/shared/utils/date-utils.js"),S=a("./tracking/constant.js"),T=a("./utils/event-toolbox.js");a("../node_modules/react-day-picker/lib/style.css"),a("./site-modules/shared/components/calendar/calendar.scss");class I extends n.Component{constructor(){super(...arguments),this.state={isCalendarOpen:!1},this.onChange=((e,t)=>{t.disabled||(this.props.onChange(e),this.toggleCalendar())}),this.toggleCalendar=(()=>{this.setState(e=>{let t=e.isCalendarOpen;return T.a.fireCustomEvent(t?S.b.CLOSE_CALENDAR:S.b.OPEN_CALENDAR),{isCalendarOpen:!t}})}),this.handleClick=(e=>{e.preventDefault()})}render(){const e=this.props,t=e.selectedDate,a=e.disabledDays,s=e.deliveryDateClassName,n=this.state.isCalendarOpen,l=Object(C.c)();return r.a.createElement(m.a,{className:"calendar-dropdown",isOpen:n,toggle:this.toggleCalendar,onClick:this.handleClick},r.a.createElement(b.a,{className:"pos-r p-0 m-0 w-100 bg-white text-left font-weight-normal"},r.a.createElement("div",{className:d()("w-100 text-gray-darker form-control",s)},E()(t,"mm/dd/yyyy (ddd.)")),r.a.createElement("span",{className:"delivery-time-icon icon-calendar4 p-0_75 bg-primary text-white"})),r.a.createElement(h.a,{right:!0,onClick:this.handleClick},r.a.createElement(y.a,{onDayClick:this.onChange,selectedDays:t,month:t,initialMonth:t,disabledDays:i()(a)?{before:l}:a})))}}I.propTypes={onChange:o.a.func.isRequired,selectedDate:o.a.instanceOf(Date).isRequired,disabledDays:o.a.oneOfType([o.a.object,o.a.array]),deliveryDateClassName:o.a.string},I.defaultProps={disabledDays:{},deliveryDateClassName:"display-5"}},"./site-modules/shared/components/car-buying/trade-in/trade-in-popover.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return g});var s=a("../node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),i=a("../node_modules/lodash/noop.js"),n=a.n(i),r=a("../node_modules/react/index.js"),l=a.n(r),o=a("../node_modules/prop-types/index.js"),c=a.n(o),d=a("../node_modules/classnames/index.js"),p=a.n(d),m=a("../node_modules/reactstrap/lib/Button.js"),u=a.n(m),h=a("./site-modules/shared/constants/calculator/calculator.js");a("./site-modules/shared/components/car-buying/trade-in/trade-in-popover.scss");function g(e){let t=e.tradeInValidationError,a=e.calculator,i=e.onApplyTradeIn;const n=Object(r.useRef)(),o=Object(r.useState)(!1),c=Object(s.a)(o,2),d=c[0],m=c[1],g=()=>{d&&i(),m(!d)};Object(r.useEffect)(()=>{t&&g()},[t]);const b=l.a.createElement(r.Fragment,null,l.a.createElement("span",null,t),l.a.createElement(u.a,{color:"link",onClick:g,className:"applied-link text-underline font-weight-bold d-block mt-0_5 text-primary-darker p-0 text-capitalize body"},"Got it!"));return l.a.createElement("div",{className:p()("trade-in-popover-wrapper pos-r",{"vdp-calculator":a===h.i})},l.a.createElement("i",{id:"trade-in-popover",className:p()("icon icon-notification2 d-block text-warning",{"h3 mr-0_5":a===h.f,h5:a===h.i})}),d&&l.a.createElement(r.Fragment,null,l.a.createElement("div",{className:p()("popover-body bg-white rounded py-1_5",{"px-1":a===h.f,"px-1_25":a===h.i}),ref:n},b),l.a.createElement("span",{className:"arrow"})))}g.propTypes={tradeInValidationError:c.a.string,onApplyTradeIn:c.a.func,calculator:c.a.string},g.defaultProps={tradeInValidationError:"",onApplyTradeIn:n.a,calculator:h.f}},"./site-modules/shared/components/carousel/carousel.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return A});var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/@babel/runtime/helpers/esm/objectSpread.js"),n=a("../node_modules/lodash/get.js"),r=a.n(n),l=a("../node_modules/react/index.js"),o=a.n(l),c=a("../node_modules/prop-types/index.js"),d=a.n(c),p=a("../node_modules/react-slick/lib/index.js"),m=a.n(p),u=a("../node_modules/classnames/index.js"),h=a.n(u),g=a("../node_modules/reactstrap/lib/Row.js"),b=a.n(g),f=a("../node_modules/reactstrap/lib/Col.js"),E=a.n(f),v=a("../node_modules/react-router/esm/react-router.js"),y=a("./utils/location.js"),C=(a("../node_modules/slick-carousel/slick/slick.css"),a("../node_modules/slick-carousel/slick/slick-theme.css"),a("./utils/event-toolbox.js")),S=a("./engagement-handlers/index.js"),T=a("./engagement-handlers/carousel-engagement-handler/carousel-engagement-handler.js"),I=(a("./site-modules/shared/components/carousel/carousel.scss"),a("./site-modules/shared/components/carousel/events.js"));S.a.register(T.a);const N=e=>o.a.createElement("div",{className:"left carousel-control"},o.a.createElement("button",{"aria-label":"previous slide",className:h()("icon-prev",e.className),onClick:e.onClick}));N.propTypes={onClick:d.a.func,className:d.a.string},N.defaultProps={onClick:null,className:""};const _=e=>o.a.createElement("div",{className:"right carousel-control"},o.a.createElement("button",{"aria-label":"next slide",className:h()("icon-next",e.className),onClick:e.onClick}));_.propTypes={onClick:d.a.func,className:d.a.string},_.defaultProps={onClick:null,className:""};const O={HORIZONTAL:{PREV:"right",NEXT:"left"},VERTICAL:{PREV:"down",NEXT:"up"}};function P(e){let t=e.direction,a=void 0===t?"":t,s=e.props,i=e.slider,n=e.element,l=e.nextSlide,o=e.actionCause,c=void 0===o?"":o;const d=r()(s,"data-carousel-photo-type",""),p=s.vertical,m=s.infinite,u=(i&&i.innerSlider&&i.innerSlider.state).slideCount,h=s.contentType,g=r()(i,"innerSlider.state.currentSlide",0),b=s.contentDetails||h,f=s.customEventData||{},E=s.noAdsRefresh;C.a.fireCustomEvent(I.a.SWIPE,{target:n,data:{currentSlide:g,nextSlide:l,total:u,vertical:p,infinite:m,contentType:h,contentDetails:b,customEventData:f,direction:a,photoType:d,actionCause:c,noAdsRefresh:E}})}class A extends l.Component{constructor(e){super(e),this.onPrevClick=(()=>{this.onSwipe({direction:this.props.vertical?O.VERTICAL.PREV:O.HORIZONTAL.PREV})}),this.onNextClick=(()=>{this.onSwipe({direction:this.props.vertical?O.VERTICAL.NEXT:O.HORIZONTAL.NEXT})}),this.onBeforeChange=((e,t)=>{this.props.beforeChange&&this.props.beforeChange(e,t)}),this.onAfterChange=(e=>{this.props.afterChange&&this.props.afterChange(e)}),this.onSwipe=(e=>{let t=e.direction,a=void 0===t?"":t,s=e.actionCause,i=void 0===s?"":s;const n=this.props.vertical,r=this.props.infinite,l=this.slider&&this.slider.innerSlider&&this.slider.innerSlider.state,o=l.slideCount,c=function(e,t,a,s,i){const n=e+(s&&a===O.VERTICAL.NEXT||!s&&a===O.HORIZONTAL.NEXT?1:-1),r=t-1;return n<0?i?r:0:n>r?i?0:r:n}(l.currentSlide,o,a,n,r);P({props:this.props,slider:this.slider,element:this.element,direction:a,nextSlide:c,actionCause:i}),this.props.swipeEvent&&this.props.swipeEvent(c)}),this.forceDisableAutoplayOptions=(e=>{let t;const a=[];return e&&(t=Object.assign({},Object(i.a)({},e),{autoplay:!1})).responsive&&(t.responsive.forEach(e=>{a.push(Object(i.a)({},e,{settings:Object.assign({},Object(i.a)({},e.settings),{autoplay:!1})}))}),t.responsive=a),t}),this.next=(()=>{this.slider.slickNext()}),this.prev=(()=>{this.slider.slickPrev()}),this.goto=(e=>{P({props:this.props,slider:this.slider,element:this.element,nextSlide:e}),this.slider.slickGoTo(e)}),this.setSliderRefs=(e=>{this.slider=e,this.element=e&&e.innerSlider&&e.innerSlider.list&&e.innerSlider.list.parentElement})}componentDidMount(){if(this.props.arrows&&this.element){const e=this.element.querySelector(".left.carousel-control"),t=this.element.querySelector(".right.carousel-control");e&&t&&(e.addEventListener("click",this.onPrevClick,!1),t.addEventListener("click",this.onNextClick,!1))}this.slider&&this.props.currentSlideIndex&&this.slider.slickGoTo(this.props.currentSlideIndex)}componentWillUnmount(){if(this.props.arrows&&this.element){const e=this.element.querySelector(".left.carousel-control"),t=this.element.querySelector(".right.carousel-control");e&&t&&(e.removeEventListener("click",this.onPrevClick,!1),t.removeEventListener("click",this.onNextClick,!1))}}renderSlider(){const e=(t=this.props.pageCounter)?!0===t||"xs"===t?"page-counter":`page-counter-${t}`:"";var t;const a=l.Children.count(this.props.children)>1,n=1===this.props.slidesToShow||!this.props.slidesToShow,r=h()("slick-carousel",{"show-one":n},{fluid:this.props.fluid},e,this.props.className),c=Object(i.a)({},this.props,{dots:this.props.dots||!!e,beforeChange:this.onBeforeChange,afterChange:this.onAfterChange,swipeEvent:this.onSwipe,arrows:this.props.arrows&&a,autoplay:this.props.autoplay&&a,draggable:this.props.draggable&&a,swipe:this.props.swipe&&a,className:r}),d=this.context&&this.context.location&&"off"===Object(y.a)(this.context.location)["carousel-autoplay"]?this.forceDisableAutoplayOptions(c):c;return o.a.createElement(m.a,Object(s.a)({ref:this.setSliderRefs},d),this.props.children)}render(){const e=this.props.fluid;return o.a.createElement(b.a,{className:"no-gutters"},o.a.createElement(E.a,{xs:{size:e?12:10,offset:e?0:1}},this.renderSlider()))}}A.contextType=v.e,A.propTypes={className:d.a.string,fluid:d.a.bool,vertical:d.a.bool,infinite:d.a.bool,contentType:d.a.string,contentDetails:d.a.string,customEventData:d.a.shape({}),beforeChange:d.a.func,afterChange:d.a.func,swipeEvent:d.a.func,children:d.a.node,arrows:d.a.bool,pageCounter:d.a.oneOfType([d.a.bool,d.a.oneOf(["xs","sm","md","lg","xl"])]),dots:d.a.bool,dotsClass:d.a.string,autoplay:d.a.bool,draggable:d.a.bool,swipe:d.a.bool,adaptiveHeight:d.a.bool,currentSlideIndex:d.a.number,noAdsRefresh:d.a.bool},A.defaultProps={className:"",fluid:!0,vertical:!1,infinite:!0,contentType:"content",contentDetails:"",customEventData:null,beforeChange:null,afterChange:null,swipeEvent:null,nextArrow:o.a.createElement(_,null),prevArrow:o.a.createElement(N,null),children:null,arrows:!0,pageCounter:!1,dots:!1,dotsClass:"slick-dots",autoplay:!1,draggable:!0,swipe:!0,adaptiveHeight:!1,currentSlideIndex:0,noAdsRefresh:!1}},"./site-modules/shared/components/carousel/events.js":function(e,t,a){"use strict";a.d(t,"a",function(){return s});const s={SWIPE:"carousel.swipe"}},"./site-modules/shared/components/color-feature-list-smart/color-feature-list-smart.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return p});var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),n=a("../node_modules/react/index.js"),r=a.n(n),l=a("../node_modules/prop-types/index.js"),o=a.n(l),c=a("../node_modules/lodash/get.js"),d=a.n(c);function p(e,t){class a extends n.Component{constructor(){super(...arguments),this.onClick=(e=>{const a=d()(e.target.closest(`.${t}-item`),"title",null);a&&this.props.updateHOCState(a)})}render(){const t=this.props,a=t.title,l=(t.updateHOCState,Object(i.a)(t,["title","updateHOCState"]));return r.a.createElement(n.Fragment,null,a&&r.a.createElement("h4",{className:"medium text-center"},a),r.a.createElement(e,Object(s.a)({},l,{onClick:this.onClick})))}}a.propTypes={listItems:o.a.arrayOf(o.a.oneOfType([o.a.shape({name:o.a.string,count:o.a.number,properties:o.a.shape({rgb:o.a.string}),price:o.a.shape({baseMSRP:o.a.number})}),o.a.shape({name:o.a.string,value:o.a.string,count:o.a.number})])).isRequired,updateHOCState:o.a.func,title:o.a.string},a.defaultProps={updateHOCState:()=>{},title:""};const l=e.displayName||e.name||"Component";return a.displayName=`withSmartListHandlers(${l})`,a}},"./site-modules/shared/components/logos/carmax-logo.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return h});var s=a("../node_modules/lodash/get.js"),i=a.n(s),n=a("../node_modules/react/index.js"),r=a.n(n),l=a("../node_modules/prop-types/index.js"),o=a.n(l),c=a("../node_modules/react-redux/es/index.js"),d=a("./utils/image-helpers.js"),p=a("./site-modules/shared/components/image/image.jsx"),m=a("./site-modules/shared/components/experiment/index.jsx");function u(e){let t=e.themeTypeOverride,a=e.className;return r.a.createElement("picture",null,r.a.createElement(m.a,{name:"ads-5469-dark-theme",showDefault:!0},r.a.createElement(m.c,{name:"ctrl",isDefault:!0}),r.a.createElement(m.c,{name:"chal"},"light"!==t&&r.a.createElement("source",{srcSet:Object(d.k)("img/eva/partners/carmax-white.svg",void 0,d.d.STATIC)}))),r.a.createElement(p.a,{imageId:"img/eva/partners/carmax-logo.svg",source:d.d.STATIC,alt:"CarMax logo",className:a}))}u.propTypes={themeTypeOverride:o.a.string,className:o.a.string},u.defaultProps={themeTypeOverride:null,className:"partner-logo"};const h=Object(c.c)(e=>({themeTypeOverride:i()(e,"visitor.themeTypeOverride")}))(u)},"./site-modules/shared/components/logos/edmunds-logo-text.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return g});var s=a("../node_modules/lodash/get.js"),i=a.n(s),n=a("./utils/image-helpers.js"),r=a("../node_modules/react/index.js"),l=a.n(r),o=a("../node_modules/prop-types/index.js"),c=a.n(o),d=a("./images/logo-white.svg"),p=a.n(d),m=a("../node_modules/react-redux/es/index.js"),u=a("./site-modules/shared/components/experiment/index.jsx");function h(e){const t=e.themeTypeOverride,a=e.className;return l.a.createElement("picture",null,l.a.createElement(u.a,{name:"ads-5469-dark-theme",showDefault:!0},l.a.createElement(u.c,{name:"ctrl",isDefault:!0}),l.a.createElement(u.c,{name:"chal"},"light"!==t&&l.a.createElement("source",{srcSet:p.a}))),l.a.createElement("img",{src:Object(n.q)("/images/logos/edmunds-logo-and-text-226x36-trans.png"),alt:"edmunds logo and edmunds",className:a}))}h.propTypes={themeTypeOverride:c.a.string,className:c.a.string},h.defaultProps={themeTypeOverride:null,className:""};const g=Object(m.c)(e=>({themeTypeOverride:i()(e.visitor,"themeTypeOverride")}))(h)},"./site-modules/shared/components/odometer-wrapper/odometer-wrapper.jsx":function(e,t,a){"use strict";a.r(t),a.d(t,"OdometerWrapper",function(){return m});var s=a("../node_modules/@babel/runtime/helpers/esm/objectSpread.js"),i=a("../node_modules/lodash/noop.js"),n=a.n(i),r=a("../node_modules/react/index.js"),l=a.n(r),o=a("../node_modules/prop-types/index.js"),c=a.n(o),d=a("../node_modules/odometer/odometer.js"),p=a.n(d);a("../node_modules/odometer/themes/odometer-theme-default.css");class m extends r.PureComponent{constructor(){super(...arguments),this.node=l.a.createRef()}componentDidMount(){this.odometer=new p.a(Object(s.a)({el:this.node.current},this.props)),this.props.onDidMount(this.odometer)}componentDidUpdate(){const e=this.props.value;this.odometer.update(e)}render(){return l.a.createElement("div",{className:this.props.classNames,ref:this.node})}}m.propTypes={duration:c.a.number,format:c.a.string,selector:c.a.string,theme:c.a.string,value:c.a.oneOfType([c.a.string,c.a.number]).isRequired,classNames:c.a.string,onDidMount:c.a.func},m.defaultProps={duration:2e3,format:"(,ddd)",selector:".odometer",theme:"default",classNames:"",onDidMount:n.a}},"./site-modules/shared/components/radio-list/radio-list-item.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return b});var s=a("../node_modules/@babel/runtime/helpers/esm/extends.js"),i=a("../node_modules/react/index.js"),n=a.n(i),r=a("../node_modules/prop-types/index.js"),l=a.n(r),o=a("../node_modules/classnames/index.js"),c=a.n(o),d=a("../node_modules/reactstrap/lib/Label.js"),p=a.n(d),m=a("../node_modules/reactstrap/lib/Input.js"),u=a.n(m),h=a("../node_modules/reactstrap/lib/FormGroup.js"),g=a.n(h);function b(e){let t=e.listItem,a=t.title,i=t.text,r=t.trackingId,l=t.trackingValue,o=t.id,d=t.customAttrs,m=t.hideValue,h=e.name,b=e.onChange,f=e.formGroupClassName,E=e.labelContainerClassName,v=e.checkmarkClassName,y=e.labelClassName,C=e.labelCheckedClassName,S=e.textClassName,T=e.checked;return n.a.createElement(g.a,Object(s.a)({className:c()(f),check:!0},d),n.a.createElement(p.a,{className:c()(E,{[C]:T}),check:!0},n.a.createElement(u.a,{className:"radio-input",type:"radio",value:a,name:h,checked:T,onChange:b,"data-tracking-id":r,"data-tracking-value":l}),n.a.createElement("span",{className:c()("checkmark",v)}),!m&&n.a.createElement("div",{id:o,className:c()(y)},a),n.a.createElement("div",{className:c()(S)},i)))}b.propTypes={listItem:l.a.shape({title:l.a.string,text:l.a.oneOfType([l.a.string,l.a.node]),trackingId:l.a.string,trackingValue:l.a.oneOfType([l.a.string,l.a.number]),id:l.a.oneOfType([l.a.string,l.a.number]),customAttrs:l.a.shape({}),hideValue:l.a.bool}).isRequired,name:l.a.string.isRequired,onChange:l.a.func.isRequired,formGroupClassName:l.a.string,labelContainerClassName:l.a.string,labelClassName:l.a.string,labelCheckedClassName:l.a.string,textClassName:l.a.string,checkmarkClassName:l.a.string,checked:l.a.bool},b.defaultProps={formGroupClassName:null,labelContainerClassName:null,labelClassName:null,labelCheckedClassName:"label-checked",textClassName:null,checkmarkClassName:null,checked:!1}},"./site-modules/shared/components/time-selector/time-selector.jsx":function(e,t,a){"use strict";a.d(t,"a",function(){return v});var s=a("../node_modules/lodash/get.js"),i=a.n(s),n=a("../node_modules/react/index.js"),r=a.n(n),l=a("../node_modules/classnames/index.js"),o=a.n(l),c=a("../node_modules/reactstrap/lib/Dropdown.js"),d=a.n(c),p=a("../node_modules/reactstrap/lib/DropdownMenu.js"),m=a.n(p),u=a("../node_modules/reactstrap/lib/DropdownToggle.js"),h=a.n(u),g=a("../node_modules/prop-types/index.js"),b=a.n(g),f=a("./tracking/constant.js"),E=a("./utils/event-toolbox.js");a("./site-modules/shared/components/time-selector/time-selector.scss");class v extends n.Component{constructor(){super(...arguments),this.state={isIntervalSelectorVisible:!1},this.toggleIntervalSelector=(()=>{this.setState(e=>{let t=e.isIntervalSelectorVisible;return E.a.fireCustomEvent(t?f.b.CLOSE_TIME_SLOTS:f.b.OPEN_TIME_SLOTS),{isIntervalSelectorVisible:!t}})}),this.closeIntervalSelector=(()=>{E.a.fireCustomEvent(f.b.CLOSE_TIME_SLOTS),this.setState({isIntervalSelectorVisible:!1})}),this.selectInterval=(e=>{const t=i()(e,"target.dataset.name",""),a=i()(e,"target.dataset.value","");this.props.onChange(t,a),this.closeIntervalSelector()}),this.handleClick=(e=>{e.preventDefault()})}render(){const e=this.state.isIntervalSelectorVisible,t=this.props,a=t.deliveryTime,s=t.timeIntervals,i=t.deliveryTimeClassName;return r.a.createElement(d.a,{isOpen:e,toggle:this.toggleIntervalSelector,onClick:this.handleClick},r.a.createElement(h.a,{className:"delivery-time-toggle text-left font-weight-normal p-0 mt-0_25 mt-md-0 pos-r w-100 bg-white"},r.a.createElement("div",{className:o()("delivery-time-picker w-100 text-gray-darker form-control",i)},a),r.a.createElement("span",{className:"delivery-time-icon medium icon-clock p-0_75 bg-primary text-white"})),r.a.createElement(m.a,{className:"delivery-toggle-menu",right:!0},r.a.createElement(y,{selectInterval:this.selectInterval,activeItem:a,timeIntervals:s})))}}function y(e){let t=e.selectInterval,a=e.timeIntervals,s=e.activeItem;return r.a.createElement("div",{className:"delivery-time-selector px-1_5 px-md-0_5"},a.map(e=>{let a=e.title,i=e.value;const n=i===s?"active":"";return r.a.createElement("div",{role:"button",tabIndex:0,onClick:t,"data-value":i,"data-name":"time",className:`delivery-time-option pos-r px-1 py-0_5 mb-0_5 p-md-0_25 ${n}`,key:i},a)}))}v.propTypes={deliveryTime:b.a.string,onChange:b.a.func.isRequired,timeIntervals:b.a.arrayOf(b.a.shape({end:b.a.number,start:b.a.number,title:b.a.string,value:b.a.string})),deliveryTimeClassName:b.a.string},v.defaultProps={timeIntervals:[],deliveryTime:"",deliveryTimeClassName:"display-5"},y.propTypes={selectInterval:b.a.func.isRequired,timeIntervals:b.a.arrayOf(b.a.shape({title:b.a.string,value:b.a.string,start:b.a.number,end:b.a.number})),activeItem:b.a.string.isRequired},y.defaultProps={timeIntervals:[]}},"./site-modules/shared/utils/inventory-utils/build-filter-pixel-value.js":function(e,t,a){"use strict";a.d(t,"a",function(){return i});const s="~";function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return`${e}${s}${t||a}${s}${a}`}},"./site-modules/shared/utils/location.js":function(e,t,a){"use strict";a.d(t,"a",function(){return r}),a.d(t,"b",function(){return l});var s=a("./data/api/api-client.js"),i=a("./utils/metrics-header.js"),n=a("./constants/location.js");function r(e,t){let a=t.pageName,n=t.venomVersion;return s.c.fetchJson(`/zip/v2/${e}`,{headers:Object(i.a)("getLocationByZipCode",a,n)})}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=e.userSet,a=e.zipCode;return!1===t&&a===n.a.zipCode}}}]);
//# sourceMappingURL=34.chunk.99258f787db60e3496d5.js.map